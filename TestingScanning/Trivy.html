<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-Testing-Scanning/Container-Scanning/trivy" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.8.1">
<title data-rh="true">Trivy | Infinite Operations</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://vibhuvioio.com/docs/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://vibhuvioio.com/docs/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://vibhuvioio.com/docs/TestingScanning/Trivy"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Trivy | Infinite Operations"><meta data-rh="true" name="description" content="Trivy is a comprehensive security scanner for containers, filesystems, and infrastructure as code. Learn how to integrate Trivy into your CI/CD pipeline for automated vulnerability scanning."><meta data-rh="true" property="og:description" content="Trivy is a comprehensive security scanner for containers, filesystems, and infrastructure as code. Learn how to integrate Trivy into your CI/CD pipeline for automated vulnerability scanning."><meta data-rh="true" name="keywords" content="Trivy,container scanning,vulnerability scanner,Docker security,IaC scanning,DevSecOps,security automation,CVE scanning,Kubernetes security,infrastructure scanning"><link data-rh="true" rel="icon" href="/docs/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://vibhuvioio.com/docs/TestingScanning/Trivy"><link data-rh="true" rel="alternate" href="https://vibhuvioio.com/docs/TestingScanning/Trivy" hreflang="en"><link data-rh="true" rel="alternate" href="https://vibhuvioio.com/docs/TestingScanning/Trivy" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Testing & Scanning","item":"https://vibhuvioio.com/docs/category/testing--scanning"},{"@type":"ListItem","position":2,"name":"Container Scanning","item":"https://vibhuvioio.com/docs/category/container-scanning"},{"@type":"ListItem","position":3,"name":"Trivy","item":"https://vibhuvioio.com/docs/TestingScanning/Trivy"}]}</script><link rel="alternate" type="application/rss+xml" href="/docs/blog/rss.xml" title="Infinite Operations RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/docs/blog/atom.xml" title="Infinite Operations Atom Feed"><link rel="stylesheet" href="/docs/assets/css/styles.41acb0d9.css">
<script src="/docs/assets/js/runtime~main.8ca05a73.js" defer="defer"></script>
<script src="/docs/assets/js/main.f136e6db.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg xmlns="http://www.w3.org/2000/svg" style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t="light";var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",e||t),document.documentElement.setAttribute("data-theme-choice",e||t)}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><link rel="preload" as="image" href="/docs/img/logo.svg"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/docs/"><div class="navbar__logo"><img src="/docs/img/logo.svg" alt="Ops" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/docs/img/logo.svg" alt="Ops" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">Ops</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/category/infrastructure--kubernetes">Docs</a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="system mode" aria-label="Switch between dark and light mode (currently system mode)"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/category/infrastructure--kubernetes">Infrastructure &amp; Kubernetes</a><button aria-label="Expand sidebar category &#x27;Infrastructure &amp; Kubernetes&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/category/k8s-cluster">K8s Cluster</a><button aria-label="Expand sidebar category &#x27;K8s Cluster&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/category/databases">Databases</a><button aria-label="Expand sidebar category &#x27;Databases&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/category/cicd">CI/CD</a><button aria-label="Expand sidebar category &#x27;CI/CD&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" href="/docs/category/testing--scanning">Testing &amp; Scanning</a><button aria-label="Collapse sidebar category &#x27;Testing &amp; Scanning&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/docs/category/sast-static-analysis">SAST (Static Analysis)</a><button aria-label="Expand sidebar category &#x27;SAST (Static Analysis)&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/docs/category/sca-software-composition-analysis">SCA (Software Composition Analysis)</a><button aria-label="Expand sidebar category &#x27;SCA (Software Composition Analysis)&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" tabindex="0" href="/docs/category/container-scanning">Container Scanning</a><button aria-label="Collapse sidebar category &#x27;Container Scanning&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/TestingScanning/Trivy">Trivy</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/docs/category/dast">DAST</a><button aria-label="Expand sidebar category &#x27;DAST&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/category/build--ml-tools">Build &amp; ML Tools</a><button aria-label="Expand sidebar category &#x27;Build &amp; ML Tools&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/category/observability--monitoring">Observability &amp; Monitoring</a><button aria-label="Expand sidebar category &#x27;Observability &amp; Monitoring&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/category/data-processing">Data-Processing</a><button aria-label="Expand sidebar category &#x27;Data-Processing&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/category/security">Security</a><button aria-label="Expand sidebar category &#x27;Security&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/category/elasticsearch-operation">Elasticsearch Operation</a><button aria-label="Expand sidebar category &#x27;Elasticsearch Operation&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/category/minio">Minio</a><button aria-label="Expand sidebar category &#x27;Minio&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/category/vector-databases">Vector Databases</a><button aria-label="Expand sidebar category &#x27;Vector Databases&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/category/container-orchestration">Container-Orchestration</a><button aria-label="Expand sidebar category &#x27;Container-Orchestration&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/category/cert-manager">Cert Manager</a><button aria-label="Expand sidebar category &#x27;Cert Manager&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/category/ingress-nginx">Ingress Nginx</a><button aria-label="Expand sidebar category &#x27;Ingress Nginx&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/intro">Infra Intro</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/CreateMongoSecurityKey">mongo</a></div></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/docs/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><a class="breadcrumbs__link" href="/docs/category/testing--scanning"><span>Testing &amp; Scanning</span></a></li><li class="breadcrumbs__item"><a class="breadcrumbs__link" href="/docs/category/container-scanning"><span>Container Scanning</span></a></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">Trivy</span></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>ğŸ›¡ï¸ Trivy Container &amp; Infrastructure Security Scanner</h1></header>
<p><strong>Trivy</strong> is a comprehensive <strong>security scanner</strong> that detects <strong>vulnerabilities</strong> in <strong>containers</strong>, <strong>filesystems</strong>, and <strong>infrastructure as code</strong>. Perfect for <strong>DevSecOps</strong> workflows with support for <strong>Docker images</strong>, <strong>Kubernetes manifests</strong>, <strong>Terraform</strong>, and more.</p>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="-prerequisites">ğŸ§° Prerequisites<a href="#-prerequisites" class="hash-link" aria-label="Direct link to ğŸ§° Prerequisites" title="Direct link to ğŸ§° Prerequisites">â€‹</a></h2>
<p>Make sure you have the following:</p>
<ul>
<li><strong>Docker</strong> installed for container scanning</li>
<li><strong>Git</strong> for repository scanning</li>
<li><strong>Kubernetes</strong> (optional, for K8s scanning)</li>
<li><strong>Terraform</strong> (optional, for IaC scanning)</li>
<li><strong>CI/CD pipeline</strong> for automation</li>
</ul>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="-step-1-install-trivy">ğŸ”§ Step 1: Install Trivy<a href="#-step-1-install-trivy" class="hash-link" aria-label="Direct link to ğŸ”§ Step 1: Install Trivy" title="Direct link to ğŸ”§ Step 1: Install Trivy">â€‹</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="option-1-install-via-package-manager">Option 1: Install via Package Manager<a href="#option-1-install-via-package-manager" class="hash-link" aria-label="Direct link to Option 1: Install via Package Manager" title="Direct link to Option 1: Install via Package Manager">â€‹</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># Ubuntu/Debian</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sudo apt-get update</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sudo apt-get install wget apt-transport-https gnupg lsb-release</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">wget -qO - https://aquasecurity.github.io/trivy-repo/deb/public.key | sudo apt-key add -</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">echo &quot;deb https://aquasecurity.github.io/trivy-repo/deb $(lsb_release -sc) main&quot; | sudo tee -a /etc/apt/sources.list.d/trivy.list</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sudo apt-get update</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sudo apt-get install trivy</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># CentOS/RHEL/Fedora</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sudo vim /etc/yum.repos.d/trivy.repo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Add:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># [trivy]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># name=Trivy repository</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># baseurl=https://aquasecurity.github.io/trivy-repo/rpm/releases/$basearch/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># gpgcheck=0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># enabled=1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sudo yum -y update</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sudo yum -y install trivy</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># macOS</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">brew install trivy</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="option-2-download-binary">Option 2: Download Binary<a href="#option-2-download-binary" class="hash-link" aria-label="Direct link to Option 2: Download Binary" title="Direct link to Option 2: Download Binary">â€‹</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># Download latest release</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">curl -sfL https://raw.githubusercontent.com/aquasecurity/trivy/main/contrib/install.sh | sh -s -- -b /usr/local/bin</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Verify installation</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">trivy --version</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="option-3-use-docker">Option 3: Use Docker<a href="#option-3-use-docker" class="hash-link" aria-label="Direct link to Option 3: Use Docker" title="Direct link to Option 3: Use Docker">â€‹</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># Create alias for Docker-based usage</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">alias trivy=&#x27;docker run --rm -v /var/run/docker.sock:/var/run/docker.sock -v $HOME/Library/Caches:/root/.cache/ aquasec/trivy&#x27;</span><br></span></code></pre></div></div>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="ï¸-step-2-basic-container-scanning">ğŸ—ï¸ Step 2: Basic Container Scanning<a href="#ï¸-step-2-basic-container-scanning" class="hash-link" aria-label="Direct link to ğŸ—ï¸ Step 2: Basic Container Scanning" title="Direct link to ğŸ—ï¸ Step 2: Basic Container Scanning">â€‹</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="scan-docker-images">Scan Docker Images<a href="#scan-docker-images" class="hash-link" aria-label="Direct link to Scan Docker Images" title="Direct link to Scan Docker Images">â€‹</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># Scan a public image</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">trivy image nginx:latest</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Scan with specific severity levels</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">trivy image --severity HIGH,CRITICAL nginx:latest</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Scan and output to JSON</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">trivy image --format json --output nginx-scan.json nginx:latest</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Scan local Docker image</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">docker build -t myapp:latest .</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">trivy image myapp:latest</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Scan with exit code on vulnerabilities</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">trivy image --exit-code 1 --severity HIGH,CRITICAL myapp:latest</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="sample-output-analysis">Sample Output Analysis<a href="#sample-output-analysis" class="hash-link" aria-label="Direct link to Sample Output Analysis" title="Direct link to Sample Output Analysis">â€‹</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># Example Trivy output</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">nginx:latest (debian 11.6)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">==========================</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Total: 145 (UNKNOWN: 0, LOW: 109, MEDIUM: 24, HIGH: 11, CRITICAL: 1)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">â”‚        Library          â”‚ Vulnerability  â”‚ Severity â”‚ Installed Version â”‚ Fixed Version â”‚                         Title                           â”‚</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">â”‚ apt                     â”‚ CVE-2011-3374  â”‚ LOW      â”‚ 2.2.4             â”‚               â”‚ It was found that apt-key in apt, all versions, do not â”‚</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">â”‚                         â”‚                â”‚          â”‚                   â”‚               â”‚ correctly...                                            â”‚</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">â”‚ bash                    â”‚ CVE-2022-3715  â”‚ HIGH     â”‚ 5.1-2+deb11u1     â”‚               â”‚ bash: a heap-buffer-overflow in valid_parameter_transform â”‚</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">â”‚ openssl                 â”‚ CVE-2023-0286  â”‚ CRITICAL â”‚ 1.1.1n-0+deb11u4  â”‚ 1.1.1n-0+deb11u5 â”‚ openssl: X.400 address type confusion in X.509 GeneralName â”‚</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span><br></span></code></pre></div></div>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="ï¸-step-3-advanced-scanning-options">â–¶ï¸ Step 3: Advanced Scanning Options<a href="#ï¸-step-3-advanced-scanning-options" class="hash-link" aria-label="Direct link to â–¶ï¸ Step 3: Advanced Scanning Options" title="Direct link to â–¶ï¸ Step 3: Advanced Scanning Options">â€‹</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="filesystem-scanning">Filesystem Scanning<a href="#filesystem-scanning" class="hash-link" aria-label="Direct link to Filesystem Scanning" title="Direct link to Filesystem Scanning">â€‹</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># Scan current directory</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">trivy fs .</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Scan specific directory with custom patterns</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">trivy fs --skip-dirs node_modules,vendor --skip-files &quot;*.test.js&quot; ./src</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Scan for secrets and misconfigurations</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">trivy fs --scanners vuln,secret,config .</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Generate detailed report</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">trivy fs --format table --output filesystem-report.txt .</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="repository-scanning">Repository Scanning<a href="#repository-scanning" class="hash-link" aria-label="Direct link to Repository Scanning" title="Direct link to Repository Scanning">â€‹</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># Scan remote Git repository</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">trivy repo https://github.com/your-org/your-repo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Scan specific branch or commit</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">trivy repo --branch develop https://github.com/your-org/your-repo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">trivy repo --commit abc123 https://github.com/your-org/your-repo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Scan with authentication</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">trivy repo --username your-username --password your-token https://github.com/private-org/private-repo</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="infrastructure-as-code-scanning">Infrastructure as Code Scanning<a href="#infrastructure-as-code-scanning" class="hash-link" aria-label="Direct link to Infrastructure as Code Scanning" title="Direct link to Infrastructure as Code Scanning">â€‹</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># Scan Terraform files</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">trivy config terraform/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Scan Kubernetes manifests</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">trivy config k8s/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Scan Docker Compose files</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">trivy config docker-compose.yml</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Scan CloudFormation templates</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">trivy config cloudformation/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Custom policy scanning</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">trivy config --policy custom-policies/ infrastructure/</span><br></span></code></pre></div></div>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="-step-4-cicd-integration">ğŸ“Š Step 4: CI/CD Integration<a href="#-step-4-cicd-integration" class="hash-link" aria-label="Direct link to ğŸ“Š Step 4: CI/CD Integration" title="Direct link to ğŸ“Š Step 4: CI/CD Integration">â€‹</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="github-actions-integration">GitHub Actions Integration<a href="#github-actions-integration" class="hash-link" aria-label="Direct link to GitHub Actions Integration" title="Direct link to GitHub Actions Integration">â€‹</a></h3>
<p><code>Create .github/workflows/trivy-scan.yml:</code></p>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Trivy Security Scan</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">on</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">push</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">branches</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"> main</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> develop </span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">pull_request</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">branches</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"> main </span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">schedule</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">cron</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;0 2 * * 1&#x27;</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># Weekly scan</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">jobs</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">trivy-scan</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Trivy Security Scan</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">runs-on</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> ubuntu</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">latest</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">permissions</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">contents</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> read</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">security-events</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> write</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">steps</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Checkout code</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">uses</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> actions/checkout@v4</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Build Docker image</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">run</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">|</span><span class="token scalar string" style="color:#e3116c"></span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">          docker build -t ${{ github.repository }}:${{ github.sha }} .</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Run Trivy vulnerability scanner</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">uses</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> aquasecurity/trivy</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">action@master</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">with</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">image-ref</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;${{ github.repository }}:${{ github.sha }}&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">format</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;sarif&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">output</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;trivy-results.sarif&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">severity</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;CRITICAL,HIGH&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Upload Trivy scan results to GitHub Security tab</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">uses</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> github/codeql</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">action/upload</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">sarif@v2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">if</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> always()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">with</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">sarif_file</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;trivy-results.sarif&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Run Trivy filesystem scan</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">uses</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> aquasecurity/trivy</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">action@master</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">with</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">scan-type</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;fs&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">scan-ref</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;.&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">format</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;table&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">output</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;trivy-fs-results.txt&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Run Trivy config scan</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">uses</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> aquasecurity/trivy</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">action@master</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">with</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">scan-type</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;config&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">scan-ref</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;.&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">format</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;table&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">output</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;trivy-config-results.txt&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Upload scan results</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">uses</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> actions/upload</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">artifact@v4</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">if</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> always()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">with</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> trivy</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">scan</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">results</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">path</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">|</span><span class="token scalar string" style="color:#e3116c"></span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">            trivy-results.sarif</span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">            trivy-fs-results.txt</span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">            trivy-config-results.txt</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Fail on high/critical vulnerabilities</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">uses</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> aquasecurity/trivy</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">action@master</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">with</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">image-ref</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;${{ github.repository }}:${{ github.sha }}&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">format</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;table&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">exit-code</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;1&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">severity</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;CRITICAL,HIGH&#x27;</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="jenkins-integration">Jenkins Integration<a href="#jenkins-integration" class="hash-link" aria-label="Direct link to Jenkins Integration" title="Direct link to Jenkins Integration">â€‹</a></h3>
<p><code>Add to Jenkinsfile:</code></p>
<div class="language-groovy codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-groovy codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">pipeline {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    agent any</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    environment {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        IMAGE_NAME = &quot;${env.JOB_NAME}:${env.BUILD_NUMBER}&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        TRIVY_CACHE_DIR = &quot;/tmp/trivy-cache&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    stages {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        stage(&#x27;Build&#x27;) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            steps {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                script {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    docker.build(IMAGE_NAME)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        stage(&#x27;Trivy Scan&#x27;) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            parallel {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                stage(&#x27;Container Scan&#x27;) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    steps {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        script {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                            sh &quot;&quot;&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                mkdir -p ${TRIVY_CACHE_DIR}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                trivy image --cache-dir ${TRIVY_CACHE_DIR} \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                    --format json \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                    --output trivy-container-report.json \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                    --severity HIGH,CRITICAL \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                    ${IMAGE_NAME}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                            &quot;&quot;&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                stage(&#x27;Filesystem Scan&#x27;) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    steps {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        sh &quot;&quot;&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                            trivy fs --cache-dir ${TRIVY_CACHE_DIR} \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                --format json \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                --output trivy-fs-report.json \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                --severity HIGH,CRITICAL \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                .</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        &quot;&quot;&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                stage(&#x27;Config Scan&#x27;) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    steps {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        sh &quot;&quot;&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                            trivy config --cache-dir ${TRIVY_CACHE_DIR} \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                --format json \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                --output trivy-config-report.json \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                .</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        &quot;&quot;&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        stage(&#x27;Process Results&#x27;) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            steps {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                script {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    // Parse JSON results and fail if critical vulnerabilities found</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    def containerReport = readJSON file: &#x27;trivy-container-report.json&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    def fsReport = readJSON file: &#x27;trivy-fs-report.json&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    def criticalVulns = 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    def highVulns = 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    // Count vulnerabilities</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    containerReport.Results?.each { result -&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        result.Vulnerabilities?.each { vuln -&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                            if (vuln.Severity == &#x27;CRITICAL&#x27;) criticalVulns++</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                            if (vuln.Severity == &#x27;HIGH&#x27;) highVulns++</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    echo &quot;Found ${criticalVulns} critical and ${highVulns} high severity vulnerabilities&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    // Fail build if critical vulnerabilities found</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    if (criticalVulns &gt; 0) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        error(&quot;Build failed due to ${criticalVulns} critical vulnerabilities&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    post {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        always {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            archiveArtifacts artifacts: &#x27;trivy-*.json&#x27;, allowEmptyArchive: true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            publishHTML([</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                allowMissing: false,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                alwaysLinkToLastBuild: true,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                keepAll: true,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                reportDir: &#x27;.&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                reportFiles: &#x27;trivy-*.json&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                reportName: &#x27;Trivy Security Report&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            ])</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        failure {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            emailext(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                subject: &quot;Security Scan Failed: ${env.JOB_NAME} - ${env.BUILD_NUMBER}&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                body: &quot;&quot;&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    Security scan failed for ${env.JOB_NAME} build ${env.BUILD_NUMBER}.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    Please check the Trivy security report for details:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    ${env.BUILD_URL}Trivy_Security_Report/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                &quot;&quot;&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                to: &quot;${env.CHANGE_AUTHOR_EMAIL}, security@company.com&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            )</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="gitlab-ci-integration">GitLab CI Integration<a href="#gitlab-ci-integration" class="hash-link" aria-label="Direct link to GitLab CI Integration" title="Direct link to GitLab CI Integration">â€‹</a></h3>
<p><code>Add to .gitlab-ci.yml:</code></p>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">stages</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> build</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> security</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">scan</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> deploy</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">variables</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">DOCKER_DRIVER</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> overlay2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">DOCKER_TLS_CERTDIR</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;/certs&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">IMAGE_TAG</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> $CI_REGISTRY_IMAGE</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">$CI_COMMIT_SHA</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">build</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">stage</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> build</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">image</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> docker</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">latest</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">services</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> docker</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">dind</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">script</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> docker build </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">t $IMAGE_TAG .</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> docker push $IMAGE_TAG</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">trivy-container-scan</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">stage</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> security</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">scan</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">image</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> aquasec/trivy</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">latest</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">script</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> trivy image </span><span class="token punctuation" style="color:#393A34">-</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">format template </span><span class="token punctuation" style="color:#393A34">-</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">template &quot;@contrib/gitlab.tpl&quot; </span><span class="token punctuation" style="color:#393A34">-</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">output gl</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">container</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">scanning</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">report.json $IMAGE_TAG</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">artifacts</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">reports</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">container_scanning</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> gl</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">container</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">scanning</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">report.json</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">dependencies</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> build</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">trivy-fs-scan</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">stage</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> security</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">scan</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">image</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> aquasec/trivy</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">latest</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">script</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> trivy fs </span><span class="token punctuation" style="color:#393A34">-</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">format template </span><span class="token punctuation" style="color:#393A34">-</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">template &quot;@contrib/gitlab</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">sast.tpl&quot; </span><span class="token punctuation" style="color:#393A34">-</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">output gl</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">sast</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">report.json .</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">artifacts</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">reports</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">sast</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> gl</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">sast</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">report.json</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">trivy-iac-scan</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">stage</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> security</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">scan</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">image</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> aquasec/trivy</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">latest</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">script</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> trivy config </span><span class="token punctuation" style="color:#393A34">-</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">format template </span><span class="token punctuation" style="color:#393A34">-</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">template &quot;@contrib/gitlab.tpl&quot; </span><span class="token punctuation" style="color:#393A34">-</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">output gl</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">iac</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">report.json .</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">artifacts</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">reports</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">container_scanning</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> gl</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">iac</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">report.json</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">allow_failure</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean important" style="color:#36acaa">true</span><br></span></code></pre></div></div>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="-step-5-custom-policies-and-rules">ğŸ”§ Step 5: Custom Policies and Rules<a href="#-step-5-custom-policies-and-rules" class="hash-link" aria-label="Direct link to ğŸ”§ Step 5: Custom Policies and Rules" title="Direct link to ğŸ”§ Step 5: Custom Policies and Rules">â€‹</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="create-custom-policies">Create Custom Policies<a href="#create-custom-policies" class="hash-link" aria-label="Direct link to Create Custom Policies" title="Direct link to Create Custom Policies">â€‹</a></h3>
<p><code>Create custom-policies/dockerfile.rego:</code></p>
<div class="language-rego codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-rego codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># METADATA</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># title: &quot;Custom Dockerfile Security Policy&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># description: &quot;Custom rules for Dockerfile security&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># scope: package</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># schemas:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># - input: schema[&quot;dockerfile&quot;]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># custom:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#   id: CUSTOM-001</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#   avd_id: CUSTOM-001</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#   severity: HIGH</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#   short_code: no-root-user</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#   recommended_action: &quot;Use non-root user&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">package dockerfile.custom.no_root_user</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import rego.v1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">deny contains res if {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    input.Stages[_].Commands[_].Cmd == &quot;user&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    input.Stages[_].Commands[_].Value[_] == &quot;root&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    res := {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;msg&quot;: &quot;Container should not run as root user&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;startline&quot;: input.Stages[_].Commands[_].StartLine,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;endline&quot;: input.Stages[_].Commands[_].EndLine,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre></div></div>
<p><code>Create custom-policies/kubernetes.rego:</code></p>
<div class="language-rego codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-rego codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># METADATA</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># title: &quot;Custom Kubernetes Security Policy&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># description: &quot;Custom rules for Kubernetes security&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># scope: package</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># schemas:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># - input: schema[&quot;kubernetes&quot;]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># custom:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#   id: CUSTOM-K8S-001</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#   avd_id: CUSTOM-K8S-001</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#   severity: MEDIUM</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#   short_code: require-resource-limits</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#   recommended_action: &quot;Set resource limits&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">package kubernetes.custom.resource_limits</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import rego.v1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">deny contains res if {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    input.kind == &quot;Deployment&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    container := input.spec.template.spec.containers[_]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    not container.resources.limits</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    res := {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;msg&quot;: sprintf(&quot;Container &#x27;%s&#x27; should have resource limits defined&quot;, [container.name]),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="use-custom-policies">Use Custom Policies<a href="#use-custom-policies" class="hash-link" aria-label="Direct link to Use Custom Policies" title="Direct link to Use Custom Policies">â€‹</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># Scan with custom policies</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">trivy config --policy custom-policies/ .</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Combine built-in and custom policies</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">trivy config --policy custom-policies/ --policy @builtin .</span><br></span></code></pre></div></div>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="-step-6-advanced-reporting-and-analysis">ğŸ“Š Step 6: Advanced Reporting and Analysis<a href="#-step-6-advanced-reporting-and-analysis" class="hash-link" aria-label="Direct link to ğŸ“Š Step 6: Advanced Reporting and Analysis" title="Direct link to ğŸ“Š Step 6: Advanced Reporting and Analysis">â€‹</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="generate-comprehensive-reports">Generate Comprehensive Reports<a href="#generate-comprehensive-reports" class="hash-link" aria-label="Direct link to Generate Comprehensive Reports" title="Direct link to Generate Comprehensive Reports">â€‹</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">#!/bin/bash</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># comprehensive-scan.sh</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">PROJECT_NAME=&quot;myapp&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">IMAGE_NAME=&quot;myapp:latest&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">REPORT_DIR=&quot;security-reports&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">DATE=$(date +%Y%m%d_%H%M%S)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mkdir -p $REPORT_DIR</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">echo &quot;ğŸ” Starting comprehensive security scan for $PROJECT_NAME...&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Container vulnerability scan</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">echo &quot;ğŸ“¦ Scanning container image...&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">trivy image --format json --output $REPORT_DIR/container-vulns-$DATE.json $IMAGE_NAME</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">trivy image --format table --output $REPORT_DIR/container-vulns-$DATE.txt $IMAGE_NAME</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Filesystem scan</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">echo &quot;ğŸ“ Scanning filesystem...&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">trivy fs --format json --output $REPORT_DIR/fs-vulns-$DATE.json .</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">trivy fs --format table --output $REPORT_DIR/fs-vulns-$DATE.txt .</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Configuration scan</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">echo &quot;âš™ï¸ Scanning configurations...&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">trivy config --format json --output $REPORT_DIR/config-issues-$DATE.json .</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">trivy config --format table --output $REPORT_DIR/config-issues-$DATE.txt .</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Secret scan</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">echo &quot;ğŸ” Scanning for secrets...&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">trivy fs --scanners secret --format json --output $REPORT_DIR/secrets-$DATE.json .</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">trivy fs --scanners secret --format table --output $REPORT_DIR/secrets-$DATE.txt .</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Generate summary report</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">echo &quot;ğŸ“Š Generating summary report...&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">python3 generate_summary.py $REPORT_DIR $DATE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">echo &quot;âœ… Scan complete! Reports saved in $REPORT_DIR/&quot;</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="python-report-generator">Python Report Generator<a href="#python-report-generator" class="hash-link" aria-label="Direct link to Python Report Generator" title="Direct link to Python Report Generator">â€‹</a></h3>
<p><code>Create generate_summary.py:</code></p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">#!/usr/bin/env python3</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> json</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> sys</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> os</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> datetime </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> datetime</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">analyze_trivy_report</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">report_path</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token triple-quoted-string string" style="color:#e3116c">&quot;&quot;&quot;Analyze Trivy JSON report and extract key metrics&quot;&quot;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">not</span><span class="token plain"> os</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">path</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">exists</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">report_path</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token string" style="color:#e3116c">&quot;error&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string-interpolation string" style="color:#e3116c">f&quot;Report not found: </span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">report_path</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">&quot;</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">with</span><span class="token plain"> </span><span class="token builtin">open</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">report_path</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;r&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> f</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        data </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> json</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">load</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">f</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    vulnerabilities </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token string" style="color:#e3116c">&#x27;CRITICAL&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token string" style="color:#e3116c">&#x27;HIGH&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token string" style="color:#e3116c">&#x27;MEDIUM&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token string" style="color:#e3116c">&#x27;LOW&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token string" style="color:#e3116c">&#x27;UNKNOWN&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    total_vulns </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    packages_affected </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token builtin">set</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># Process results</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> result </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> data</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">get</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;Results&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> vuln </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> result</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">get</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;Vulnerabilities&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            severity </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> vuln</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">get</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;Severity&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;UNKNOWN&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            vulnerabilities</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">severity</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            total_vulns </span><span class="token operator" style="color:#393A34">+=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            packages_affected</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">add</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">vuln</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">get</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;PkgName&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;unknown&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token string" style="color:#e3116c">&#x27;total_vulnerabilities&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> total_vulns</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token string" style="color:#e3116c">&#x27;by_severity&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> vulnerabilities</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token string" style="color:#e3116c">&#x27;packages_affected&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token builtin">len</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">packages_affected</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token string" style="color:#e3116c">&#x27;critical_and_high&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> vulnerabilities</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;CRITICAL&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> vulnerabilities</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;HIGH&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">generate_summary_report</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">report_dir</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> date_suffix</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token triple-quoted-string string" style="color:#e3116c">&quot;&quot;&quot;Generate comprehensive summary report&quot;&quot;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># Analyze different scan types</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    container_report </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> analyze_trivy_report</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string-interpolation string" style="color:#e3116c">f&quot;</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">report_dir</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">/container-vulns-</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">date_suffix</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">.json&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    fs_report </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> analyze_trivy_report</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string-interpolation string" style="color:#e3116c">f&quot;</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">report_dir</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">/fs-vulns-</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">date_suffix</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">.json&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    config_report </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> analyze_trivy_report</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string-interpolation string" style="color:#e3116c">f&quot;</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">report_dir</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">/config-issues-</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">date_suffix</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">.json&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># Generate HTML report</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    html_content </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string-interpolation string" style="color:#e3116c">f&quot;&quot;&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token string-interpolation string" style="color:#e3116c">    &lt;!DOCTYPE html&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token string-interpolation string" style="color:#e3116c">    &lt;html&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token string-interpolation string" style="color:#e3116c">    &lt;head&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token string-interpolation string" style="color:#e3116c">        &lt;title&gt;Security Scan Summary - </span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">datetime</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">.</span><span class="token string-interpolation interpolation">now</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">(</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">)</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">.</span><span class="token string-interpolation interpolation">strftime</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">(</span><span class="token string-interpolation interpolation string" style="color:#e3116c">&#x27;%Y-%m-%d %H:%M:%S&#x27;</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">)</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">&lt;/title&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token string-interpolation string" style="color:#e3116c">        &lt;style&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token string-interpolation string" style="color:#e3116c">            body {{ font-family: Arial, sans-serif; margin: 20px; }}</span><br></span><span class="token-line" style="color:#393A34"><span class="token string-interpolation string" style="color:#e3116c">            .header {{ background-color: #f0f0f0; padding: 20px; border-radius: 5px; }}</span><br></span><span class="token-line" style="color:#393A34"><span class="token string-interpolation string" style="color:#e3116c">            .section {{ margin: 20px 0; padding: 15px; border: 1px solid #ddd; border-radius: 5px; }}</span><br></span><span class="token-line" style="color:#393A34"><span class="token string-interpolation string" style="color:#e3116c">            .critical {{ color: #d32f2f; font-weight: bold; }}</span><br></span><span class="token-line" style="color:#393A34"><span class="token string-interpolation string" style="color:#e3116c">            .high {{ color: #f57c00; font-weight: bold; }}</span><br></span><span class="token-line" style="color:#393A34"><span class="token string-interpolation string" style="color:#e3116c">            .medium {{ color: #fbc02d; font-weight: bold; }}</span><br></span><span class="token-line" style="color:#393A34"><span class="token string-interpolation string" style="color:#e3116c">            .low {{ color: #388e3c; }}</span><br></span><span class="token-line" style="color:#393A34"><span class="token string-interpolation string" style="color:#e3116c">            .metric {{ display: inline-block; margin: 10px; padding: 10px; background-color: #f5f5f5; border-radius: 3px; }}</span><br></span><span class="token-line" style="color:#393A34"><span class="token string-interpolation string" style="color:#e3116c">        &lt;/style&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token string-interpolation string" style="color:#e3116c">    &lt;/head&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token string-interpolation string" style="color:#e3116c">    &lt;body&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token string-interpolation string" style="color:#e3116c">        &lt;div class=&quot;header&quot;&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token string-interpolation string" style="color:#e3116c">            &lt;h1&gt;ğŸ›¡ï¸ Security Scan Summary&lt;/h1&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token string-interpolation string" style="color:#e3116c">            &lt;p&gt;Generated on: </span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">datetime</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">.</span><span class="token string-interpolation interpolation">now</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">(</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">)</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">.</span><span class="token string-interpolation interpolation">strftime</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">(</span><span class="token string-interpolation interpolation string" style="color:#e3116c">&#x27;%Y-%m-%d %H:%M:%S&#x27;</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">)</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">&lt;/p&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token string-interpolation string" style="color:#e3116c">        &lt;/div&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token string-interpolation string" style="color:#e3116c">        </span><br></span><span class="token-line" style="color:#393A34"><span class="token string-interpolation string" style="color:#e3116c">        &lt;div class=&quot;section&quot;&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token string-interpolation string" style="color:#e3116c">            &lt;h2&gt;ğŸ“¦ Container Image Scan&lt;/h2&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token string-interpolation string" style="color:#e3116c">            &lt;div class=&quot;metric&quot;&gt;Total Vulnerabilities: &lt;strong&gt;</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">container_report</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">.</span><span class="token string-interpolation interpolation">get</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">(</span><span class="token string-interpolation interpolation string" style="color:#e3116c">&#x27;total_vulnerabilities&#x27;</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">,</span><span class="token string-interpolation interpolation"> </span><span class="token string-interpolation interpolation number" style="color:#36acaa">0</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">)</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">&lt;/strong&gt;&lt;/div&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token string-interpolation string" style="color:#e3116c">            &lt;div class=&quot;metric critical&quot;&gt;Critical: {container_report.get(&#x27;by_severity&#x27;, {}).get(&#x27;CRITICAL&#x27;, 0)}&lt;/div&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token string-interpolation string" style="color:#e3116c">            &lt;div class=&quot;metric high&quot;&gt;High: {container_report.get(&#x27;by_severity&#x27;, {}).get(&#x27;HIGH&#x27;, 0)}&lt;/div&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token string-interpolation string" style="color:#e3116c">            &lt;div class=&quot;metric medium&quot;&gt;Medium: {container_report.get(&#x27;by_severity&#x27;, {}).get(&#x27;MEDIUM&#x27;, 0)}&lt;/div&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token string-interpolation string" style="color:#e3116c">            &lt;div class=&quot;metric low&quot;&gt;Low: {container_report.get(&#x27;by_severity&#x27;, {}).get(&#x27;LOW&#x27;, 0)}&lt;/div&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token string-interpolation string" style="color:#e3116c">            &lt;div class=&quot;metric&quot;&gt;Packages Affected: </span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">container_report</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">.</span><span class="token string-interpolation interpolation">get</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">(</span><span class="token string-interpolation interpolation string" style="color:#e3116c">&#x27;packages_affected&#x27;</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">,</span><span class="token string-interpolation interpolation"> </span><span class="token string-interpolation interpolation number" style="color:#36acaa">0</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">)</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">&lt;/div&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token string-interpolation string" style="color:#e3116c">        &lt;/div&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token string-interpolation string" style="color:#e3116c">        </span><br></span><span class="token-line" style="color:#393A34"><span class="token string-interpolation string" style="color:#e3116c">        &lt;div class=&quot;section&quot;&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token string-interpolation string" style="color:#e3116c">            &lt;h2&gt;ğŸ“ Filesystem Scan&lt;/h2&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token string-interpolation string" style="color:#e3116c">            &lt;div class=&quot;metric&quot;&gt;Total Vulnerabilities: &lt;strong&gt;</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">fs_report</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">.</span><span class="token string-interpolation interpolation">get</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">(</span><span class="token string-interpolation interpolation string" style="color:#e3116c">&#x27;total_vulnerabilities&#x27;</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">,</span><span class="token string-interpolation interpolation"> </span><span class="token string-interpolation interpolation number" style="color:#36acaa">0</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">)</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">&lt;/strong&gt;&lt;/div&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token string-interpolation string" style="color:#e3116c">            &lt;div class=&quot;metric critical&quot;&gt;Critical: {fs_report.get(&#x27;by_severity&#x27;, {}).get(&#x27;CRITICAL&#x27;, 0)}&lt;/div&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token string-interpolation string" style="color:#e3116c">            &lt;div class=&quot;metric high&quot;&gt;High: {fs_report.get(&#x27;by_severity&#x27;, {}).get(&#x27;HIGH&#x27;, 0)}&lt;/div&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token string-interpolation string" style="color:#e3116c">            &lt;div class=&quot;metric medium&quot;&gt;Medium: {fs_report.get(&#x27;by_severity&#x27;, {}).get(&#x27;MEDIUM&#x27;, 0)}&lt;/div&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token string-interpolation string" style="color:#e3116c">            &lt;div class=&quot;metric low&quot;&gt;Low: {fs_report.get(&#x27;by_severity&#x27;, {}).get(&#x27;LOW&#x27;, 0)}&lt;/div&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token string-interpolation string" style="color:#e3116c">        &lt;/div&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token string-interpolation string" style="color:#e3116c">        </span><br></span><span class="token-line" style="color:#393A34"><span class="token string-interpolation string" style="color:#e3116c">        &lt;div class=&quot;section&quot;&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token string-interpolation string" style="color:#e3116c">            &lt;h2&gt;âš™ï¸ Configuration Issues&lt;/h2&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token string-interpolation string" style="color:#e3116c">            &lt;div class=&quot;metric&quot;&gt;Total Issues: &lt;strong&gt;</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">config_report</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">.</span><span class="token string-interpolation interpolation">get</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">(</span><span class="token string-interpolation interpolation string" style="color:#e3116c">&#x27;total_vulnerabilities&#x27;</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">,</span><span class="token string-interpolation interpolation"> </span><span class="token string-interpolation interpolation number" style="color:#36acaa">0</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">)</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">&lt;/strong&gt;&lt;/div&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token string-interpolation string" style="color:#e3116c">            &lt;div class=&quot;metric critical&quot;&gt;Critical: {config_report.get(&#x27;by_severity&#x27;, {}).get(&#x27;CRITICAL&#x27;, 0)}&lt;/div&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token string-interpolation string" style="color:#e3116c">            &lt;div class=&quot;metric high&quot;&gt;High: {config_report.get(&#x27;by_severity&#x27;, {}).get(&#x27;HIGH&#x27;, 0)}&lt;/div&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token string-interpolation string" style="color:#e3116c">            &lt;div class=&quot;metric medium&quot;&gt;Medium: {config_report.get(&#x27;by_severity&#x27;, {}).get(&#x27;MEDIUM&#x27;, 0)}&lt;/div&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token string-interpolation string" style="color:#e3116c">        &lt;/div&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token string-interpolation string" style="color:#e3116c">        </span><br></span><span class="token-line" style="color:#393A34"><span class="token string-interpolation string" style="color:#e3116c">        &lt;div class=&quot;section&quot;&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token string-interpolation string" style="color:#e3116c">            &lt;h2&gt;ğŸ¯ Risk Assessment&lt;/h2&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token string-interpolation string" style="color:#e3116c">            &lt;p&gt;&lt;strong&gt;Overall Risk Level:&lt;/strong&gt; </span><br></span><span class="token-line" style="color:#393A34"><span class="token string-interpolation string" style="color:#e3116c">            </span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation string" style="color:#e3116c">&quot;ğŸ”´ HIGH RISK&quot;</span><span class="token string-interpolation interpolation"> </span><span class="token string-interpolation interpolation keyword" style="color:#00009f">if</span><span class="token string-interpolation interpolation"> </span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">(</span><span class="token string-interpolation interpolation">container_report</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">.</span><span class="token string-interpolation interpolation">get</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">(</span><span class="token string-interpolation interpolation string" style="color:#e3116c">&#x27;critical_and_high&#x27;</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">,</span><span class="token string-interpolation interpolation"> </span><span class="token string-interpolation interpolation number" style="color:#36acaa">0</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">)</span><span class="token string-interpolation interpolation"> </span><span class="token string-interpolation interpolation operator" style="color:#393A34">+</span><span class="token string-interpolation interpolation"> fs_report</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">.</span><span class="token string-interpolation interpolation">get</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">(</span><span class="token string-interpolation interpolation string" style="color:#e3116c">&#x27;critical_and_high&#x27;</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">,</span><span class="token string-interpolation interpolation"> </span><span class="token string-interpolation interpolation number" style="color:#36acaa">0</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">)</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">)</span><span class="token string-interpolation interpolation"> </span><span class="token string-interpolation interpolation operator" style="color:#393A34">&gt;</span><span class="token string-interpolation interpolation"> </span><span class="token string-interpolation interpolation number" style="color:#36acaa">10</span><span class="token string-interpolation interpolation"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token string-interpolation interpolation">             </span><span class="token string-interpolation interpolation keyword" style="color:#00009f">else</span><span class="token string-interpolation interpolation"> </span><span class="token string-interpolation interpolation string" style="color:#e3116c">&quot;ğŸŸ¡ MEDIUM RISK&quot;</span><span class="token string-interpolation interpolation"> </span><span class="token string-interpolation interpolation keyword" style="color:#00009f">if</span><span class="token string-interpolation interpolation"> </span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">(</span><span class="token string-interpolation interpolation">container_report</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">.</span><span class="token string-interpolation interpolation">get</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">(</span><span class="token string-interpolation interpolation string" style="color:#e3116c">&#x27;critical_and_high&#x27;</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">,</span><span class="token string-interpolation interpolation"> </span><span class="token string-interpolation interpolation number" style="color:#36acaa">0</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">)</span><span class="token string-interpolation interpolation"> </span><span class="token string-interpolation interpolation operator" style="color:#393A34">+</span><span class="token string-interpolation interpolation"> fs_report</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">.</span><span class="token string-interpolation interpolation">get</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">(</span><span class="token string-interpolation interpolation string" style="color:#e3116c">&#x27;critical_and_high&#x27;</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">,</span><span class="token string-interpolation interpolation"> </span><span class="token string-interpolation interpolation number" style="color:#36acaa">0</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">)</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">)</span><span class="token string-interpolation interpolation"> </span><span class="token string-interpolation interpolation operator" style="color:#393A34">&gt;</span><span class="token string-interpolation interpolation"> </span><span class="token string-interpolation interpolation number" style="color:#36acaa">5</span><span class="token string-interpolation interpolation"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token string-interpolation interpolation">             </span><span class="token string-interpolation interpolation keyword" style="color:#00009f">else</span><span class="token string-interpolation interpolation"> </span><span class="token string-interpolation interpolation string" style="color:#e3116c">&quot;ğŸŸ¢ LOW RISK&quot;</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c"></span><br></span><span class="token-line" style="color:#393A34"><span class="token string-interpolation string" style="color:#e3116c">            &lt;/p&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token string-interpolation string" style="color:#e3116c">            </span><br></span><span class="token-line" style="color:#393A34"><span class="token string-interpolation string" style="color:#e3116c">            &lt;h3&gt;ğŸ“‹ Recommendations:&lt;/h3&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token string-interpolation string" style="color:#e3116c">            &lt;ul&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token string-interpolation string" style="color:#e3116c">                {&quot;&lt;li&gt;ğŸš¨ Immediate action required: Fix critical vulnerabilities&lt;/li&gt;&quot; if container_report.get(&#x27;by_severity&#x27;, {}).get(&#x27;CRITICAL&#x27;, 0) &gt; 0 else &quot;&quot;}</span><br></span><span class="token-line" style="color:#393A34"><span class="token string-interpolation string" style="color:#e3116c">                </span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation string" style="color:#e3116c">&quot;&lt;li&gt;âš ï¸ Update base image to address container vulnerabilities&lt;/li&gt;&quot;</span><span class="token string-interpolation interpolation"> </span><span class="token string-interpolation interpolation keyword" style="color:#00009f">if</span><span class="token string-interpolation interpolation"> container_report</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">.</span><span class="token string-interpolation interpolation">get</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">(</span><span class="token string-interpolation interpolation string" style="color:#e3116c">&#x27;total_vulnerabilities&#x27;</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">,</span><span class="token string-interpolation interpolation"> </span><span class="token string-interpolation interpolation number" style="color:#36acaa">0</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">)</span><span class="token string-interpolation interpolation"> </span><span class="token string-interpolation interpolation operator" style="color:#393A34">&gt;</span><span class="token string-interpolation interpolation"> </span><span class="token string-interpolation interpolation number" style="color:#36acaa">0</span><span class="token string-interpolation interpolation"> </span><span class="token string-interpolation interpolation keyword" style="color:#00009f">else</span><span class="token string-interpolation interpolation"> </span><span class="token string-interpolation interpolation string" style="color:#e3116c">&quot;&quot;</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c"></span><br></span><span class="token-line" style="color:#393A34"><span class="token string-interpolation string" style="color:#e3116c">                </span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation string" style="color:#e3116c">&quot;&lt;li&gt;ğŸ”§ Review and fix configuration issues&lt;/li&gt;&quot;</span><span class="token string-interpolation interpolation"> </span><span class="token string-interpolation interpolation keyword" style="color:#00009f">if</span><span class="token string-interpolation interpolation"> config_report</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">.</span><span class="token string-interpolation interpolation">get</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">(</span><span class="token string-interpolation interpolation string" style="color:#e3116c">&#x27;total_vulnerabilities&#x27;</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">,</span><span class="token string-interpolation interpolation"> </span><span class="token string-interpolation interpolation number" style="color:#36acaa">0</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">)</span><span class="token string-interpolation interpolation"> </span><span class="token string-interpolation interpolation operator" style="color:#393A34">&gt;</span><span class="token string-interpolation interpolation"> </span><span class="token string-interpolation interpolation number" style="color:#36acaa">0</span><span class="token string-interpolation interpolation"> </span><span class="token string-interpolation interpolation keyword" style="color:#00009f">else</span><span class="token string-interpolation interpolation"> </span><span class="token string-interpolation interpolation string" style="color:#e3116c">&quot;&quot;</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c"></span><br></span><span class="token-line" style="color:#393A34"><span class="token string-interpolation string" style="color:#e3116c">                &lt;li&gt;ğŸ“… Schedule regular security scans&lt;/li&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token string-interpolation string" style="color:#e3116c">                &lt;li&gt;ğŸ”„ Integrate security scanning into CI/CD pipeline&lt;/li&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token string-interpolation string" style="color:#e3116c">            &lt;/ul&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token string-interpolation string" style="color:#e3116c">        &lt;/div&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token string-interpolation string" style="color:#e3116c">    &lt;/body&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token string-interpolation string" style="color:#e3116c">    &lt;/html&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token string-interpolation string" style="color:#e3116c">    &quot;&quot;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># Save HTML report</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">with</span><span class="token plain"> </span><span class="token builtin">open</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string-interpolation string" style="color:#e3116c">f&quot;</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">report_dir</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">/security-summary-</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">date_suffix</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">.html&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;w&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> f</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        f</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">write</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">html_content</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string-interpolation string" style="color:#e3116c">f&quot;ğŸ“Š Summary report generated: </span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">report_dir</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">/security-summary-</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">date_suffix</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">.html&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> __name__ </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;__main__&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token builtin">len</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">sys</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">argv</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">!=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">3</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;Usage: python3 generate_summary.py &lt;report_dir&gt; &lt;date_suffix&gt;&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        sys</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">exit</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    report_dir </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> sys</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">argv</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    date_suffix </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> sys</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">argv</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    generate_summary_report</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">report_dir</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> date_suffix</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre></div></div>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="-step-7-kubernetes-security-scanning">ğŸ” Step 7: Kubernetes Security Scanning<a href="#-step-7-kubernetes-security-scanning" class="hash-link" aria-label="Direct link to ğŸ” Step 7: Kubernetes Security Scanning" title="Direct link to ğŸ” Step 7: Kubernetes Security Scanning">â€‹</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="scan-running-kubernetes-cluster">Scan Running Kubernetes Cluster<a href="#scan-running-kubernetes-cluster" class="hash-link" aria-label="Direct link to Scan Running Kubernetes Cluster" title="Direct link to Scan Running Kubernetes Cluster">â€‹</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># Install trivy-operator for continuous scanning</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kubectl apply -f https://raw.githubusercontent.com/aquasecurity/trivy-operator/main/deploy/static/trivy-operator.yaml</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Scan specific namespace</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">trivy k8s --report summary namespace/default</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Scan entire cluster</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">trivy k8s --report all cluster</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Scan specific workload</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">trivy k8s deployment/myapp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Generate detailed report</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">trivy k8s --format json --output k8s-security-report.json cluster</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="kubernetes-manifest-scanning">Kubernetes Manifest Scanning<a href="#kubernetes-manifest-scanning" class="hash-link" aria-label="Direct link to Kubernetes Manifest Scanning" title="Direct link to Kubernetes Manifest Scanning">â€‹</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># Scan Kubernetes YAML files</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">trivy config k8s/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Scan with specific policies</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">trivy config --policy k8s-security-policies/ k8s/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Check for CIS Kubernetes Benchmark compliance</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">trivy k8s --compliance k8s-cis cluster</span><br></span></code></pre></div></div>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="ï¸-step-8-security-best-practices">ğŸ›¡ï¸ Step 8: Security Best Practices<a href="#ï¸-step-8-security-best-practices" class="hash-link" aria-label="Direct link to ğŸ›¡ï¸ Step 8: Security Best Practices" title="Direct link to ğŸ›¡ï¸ Step 8: Security Best Practices">â€‹</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="dockerfile-security-scanning">Dockerfile Security Scanning<a href="#dockerfile-security-scanning" class="hash-link" aria-label="Direct link to Dockerfile Security Scanning" title="Direct link to Dockerfile Security Scanning">â€‹</a></h3>
<p><code>Create secure Dockerfile:</code></p>
<div class="language-dockerfile codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-dockerfile codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># Use specific version tags</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">FROM node:18.17.0-alpine3.18</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Create non-root user</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">RUN addgroup -g 1001 -S nodejs &amp;&amp; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    adduser -S nextjs -u 1001</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Set working directory</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">WORKDIR /app</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Copy package files</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">COPY package*.json ./</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Install dependencies</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">RUN npm ci --only=production &amp;&amp; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    npm cache clean --force</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Copy application code</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">COPY --chown=nextjs:nodejs . .</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Switch to non-root user</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">USER nextjs</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Expose port</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">EXPOSE 3000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Health check</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">HEALTHCHECK --interval=30s --timeout=3s --start-period=5s --retries=3 \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    CMD curl -f http://localhost:3000/health || exit 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Start application</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CMD [&quot;npm&quot;, &quot;start&quot;]</span><br></span></code></pre></div></div>
<p><code>Scan Dockerfile:</code></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># Scan Dockerfile for security issues</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">trivy config Dockerfile</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Scan with custom policies</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">trivy config --policy dockerfile-policies/ Dockerfile</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="ignore-files-and-suppressions">Ignore Files and Suppressions<a href="#ignore-files-and-suppressions" class="hash-link" aria-label="Direct link to Ignore Files and Suppressions" title="Direct link to Ignore Files and Suppressions">â€‹</a></h3>
<p><code>Create .trivyignore file:</code></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># Ignore specific CVEs</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CVE-2021-12345</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CVE-2021-67890</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Ignore by package</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">npm:lodash</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Ignore by file path</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">**/test/**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">**/node_modules/**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Ignore by severity</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">LOW</span><br></span></code></pre></div></div>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="-step-9-monitoring-and-alerting">ğŸ“ˆ Step 9: Monitoring and Alerting<a href="#-step-9-monitoring-and-alerting" class="hash-link" aria-label="Direct link to ğŸ“ˆ Step 9: Monitoring and Alerting" title="Direct link to ğŸ“ˆ Step 9: Monitoring and Alerting">â€‹</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="automated-vulnerability-monitoring">Automated Vulnerability Monitoring<a href="#automated-vulnerability-monitoring" class="hash-link" aria-label="Direct link to Automated Vulnerability Monitoring" title="Direct link to Automated Vulnerability Monitoring">â€‹</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">#!/bin/bash</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># vulnerability-monitor.sh</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">SLACK_WEBHOOK=&quot;https://hooks.slack.com/services/YOUR/SLACK/WEBHOOK&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">IMAGE_NAME=&quot;myapp:latest&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">THRESHOLD_CRITICAL=0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">THRESHOLD_HIGH=5</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Run scan</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">trivy image --format json --output scan-results.json $IMAGE_NAME</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Parse results</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CRITICAL=$(jq &#x27;[.Results[]?.Vulnerabilities[]? | select(.Severity==&quot;CRITICAL&quot;)] | length&#x27; scan-results.json)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">HIGH=$(jq &#x27;[.Results[]?.Vulnerabilities[]? | select(.Severity==&quot;HIGH&quot;)] | length&#x27; scan-results.json)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Check thresholds and alert</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">if [ &quot;$CRITICAL&quot; -gt &quot;$THRESHOLD_CRITICAL&quot; ] || [ &quot;$HIGH&quot; -gt &quot;$THRESHOLD_HIGH&quot; ]; then</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    MESSAGE=&quot;ğŸš¨ Security Alert: $IMAGE_NAME has $CRITICAL critical and $HIGH high severity vulnerabilities&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    curl -X POST -H &#x27;Content-type: application/json&#x27; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        --data &quot;{\&quot;text\&quot;:\&quot;$MESSAGE\&quot;}&quot; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        $SLACK_WEBHOOK</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    echo &quot;Alert sent: $MESSAGE&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">else</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    echo &quot;âœ… Security scan passed: $CRITICAL critical, $HIGH high vulnerabilities&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">fi</span><br></span></code></pre></div></div>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="-common-use-cases">ğŸ“‹ Common Use Cases<a href="#-common-use-cases" class="hash-link" aria-label="Direct link to ğŸ“‹ Common Use Cases" title="Direct link to ğŸ“‹ Common Use Cases">â€‹</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="1-container-security-pipeline">1. <strong>Container Security Pipeline</strong><a href="#1-container-security-pipeline" class="hash-link" aria-label="Direct link to 1-container-security-pipeline" title="Direct link to 1-container-security-pipeline">â€‹</a></h3>
<ul>
<li>Automated image scanning before deployment</li>
<li>Vulnerability tracking and remediation</li>
<li>Compliance reporting</li>
<li>Security gate enforcement</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="2-infrastructure-security">2. <strong>Infrastructure Security</strong><a href="#2-infrastructure-security" class="hash-link" aria-label="Direct link to 2-infrastructure-security" title="Direct link to 2-infrastructure-security">â€‹</a></h3>
<ul>
<li>IaC security validation</li>
<li>Kubernetes security posture</li>
<li>Configuration drift detection</li>
<li>Policy compliance checking</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="3-developer-security">3. <strong>Developer Security</strong><a href="#3-developer-security" class="hash-link" aria-label="Direct link to 3-developer-security" title="Direct link to 3-developer-security">â€‹</a></h3>
<ul>
<li>IDE integration for early detection</li>
<li>Pre-commit security checks</li>
<li>Security training and awareness</li>
<li>Vulnerability remediation guidance</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="4-enterprise-security">4. <strong>Enterprise Security</strong><a href="#4-enterprise-security" class="hash-link" aria-label="Direct link to 4-enterprise-security" title="Direct link to 4-enterprise-security">â€‹</a></h3>
<ul>
<li>Centralized vulnerability management</li>
<li>Risk assessment and reporting</li>
<li>Compliance automation</li>
<li>Security metrics and KPIs</li>
</ul>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="-what-youll-achieve">âœ… What You&#x27;ll Achieve<a href="#-what-youll-achieve" class="hash-link" aria-label="Direct link to âœ… What You&#x27;ll Achieve" title="Direct link to âœ… What You&#x27;ll Achieve">â€‹</a></h2>
<p>After following this guide, you&#x27;ll have:</p>
<ol>
<li><strong>ğŸ” Comprehensive Scanning</strong> - Container, filesystem, and IaC vulnerability detection</li>
<li><strong>ğŸ”„ CI/CD Integration</strong> - Automated security scanning in your development pipeline</li>
<li><strong>ğŸ“Š Detailed Reporting</strong> - Comprehensive security reports and metrics</li>
<li><strong>ğŸ›¡ï¸ Policy Enforcement</strong> - Custom security policies and compliance checking</li>
<li><strong>âš¡ Real-time Monitoring</strong> - Continuous security monitoring and alerting</li>
<li><strong>ğŸ¯ Risk Management</strong> - Prioritized vulnerability remediation and risk assessment</li>
</ol>
<p>âœ… <strong>Trivy is now configured and ready to secure your containers and infrastructure!</strong></p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/Testing-Scanning/Container-Scanning/trivy.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/category/container-scanning"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Container Scanning</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/category/dast"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">DAST</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#-prerequisites" class="table-of-contents__link toc-highlight">ğŸ§° Prerequisites</a></li><li><a href="#-step-1-install-trivy" class="table-of-contents__link toc-highlight">ğŸ”§ Step 1: Install Trivy</a><ul><li><a href="#option-1-install-via-package-manager" class="table-of-contents__link toc-highlight">Option 1: Install via Package Manager</a></li><li><a href="#option-2-download-binary" class="table-of-contents__link toc-highlight">Option 2: Download Binary</a></li><li><a href="#option-3-use-docker" class="table-of-contents__link toc-highlight">Option 3: Use Docker</a></li></ul></li><li><a href="#ï¸-step-2-basic-container-scanning" class="table-of-contents__link toc-highlight">ğŸ—ï¸ Step 2: Basic Container Scanning</a><ul><li><a href="#scan-docker-images" class="table-of-contents__link toc-highlight">Scan Docker Images</a></li><li><a href="#sample-output-analysis" class="table-of-contents__link toc-highlight">Sample Output Analysis</a></li></ul></li><li><a href="#ï¸-step-3-advanced-scanning-options" class="table-of-contents__link toc-highlight">â–¶ï¸ Step 3: Advanced Scanning Options</a><ul><li><a href="#filesystem-scanning" class="table-of-contents__link toc-highlight">Filesystem Scanning</a></li><li><a href="#repository-scanning" class="table-of-contents__link toc-highlight">Repository Scanning</a></li><li><a href="#infrastructure-as-code-scanning" class="table-of-contents__link toc-highlight">Infrastructure as Code Scanning</a></li></ul></li><li><a href="#-step-4-cicd-integration" class="table-of-contents__link toc-highlight">ğŸ“Š Step 4: CI/CD Integration</a><ul><li><a href="#github-actions-integration" class="table-of-contents__link toc-highlight">GitHub Actions Integration</a></li><li><a href="#jenkins-integration" class="table-of-contents__link toc-highlight">Jenkins Integration</a></li><li><a href="#gitlab-ci-integration" class="table-of-contents__link toc-highlight">GitLab CI Integration</a></li></ul></li><li><a href="#-step-5-custom-policies-and-rules" class="table-of-contents__link toc-highlight">ğŸ”§ Step 5: Custom Policies and Rules</a><ul><li><a href="#create-custom-policies" class="table-of-contents__link toc-highlight">Create Custom Policies</a></li><li><a href="#use-custom-policies" class="table-of-contents__link toc-highlight">Use Custom Policies</a></li></ul></li><li><a href="#-step-6-advanced-reporting-and-analysis" class="table-of-contents__link toc-highlight">ğŸ“Š Step 6: Advanced Reporting and Analysis</a><ul><li><a href="#generate-comprehensive-reports" class="table-of-contents__link toc-highlight">Generate Comprehensive Reports</a></li><li><a href="#python-report-generator" class="table-of-contents__link toc-highlight">Python Report Generator</a></li></ul></li><li><a href="#-step-7-kubernetes-security-scanning" class="table-of-contents__link toc-highlight">ğŸ” Step 7: Kubernetes Security Scanning</a><ul><li><a href="#scan-running-kubernetes-cluster" class="table-of-contents__link toc-highlight">Scan Running Kubernetes Cluster</a></li><li><a href="#kubernetes-manifest-scanning" class="table-of-contents__link toc-highlight">Kubernetes Manifest Scanning</a></li></ul></li><li><a href="#ï¸-step-8-security-best-practices" class="table-of-contents__link toc-highlight">ğŸ›¡ï¸ Step 8: Security Best Practices</a><ul><li><a href="#dockerfile-security-scanning" class="table-of-contents__link toc-highlight">Dockerfile Security Scanning</a></li><li><a href="#ignore-files-and-suppressions" class="table-of-contents__link toc-highlight">Ignore Files and Suppressions</a></li></ul></li><li><a href="#-step-9-monitoring-and-alerting" class="table-of-contents__link toc-highlight">ğŸ“ˆ Step 9: Monitoring and Alerting</a><ul><li><a href="#automated-vulnerability-monitoring" class="table-of-contents__link toc-highlight">Automated Vulnerability Monitoring</a></li></ul></li><li><a href="#-common-use-cases" class="table-of-contents__link toc-highlight">ğŸ“‹ Common Use Cases</a><ul><li><a href="#1-container-security-pipeline" class="table-of-contents__link toc-highlight">1. <strong>Container Security Pipeline</strong></a></li><li><a href="#2-infrastructure-security" class="table-of-contents__link toc-highlight">2. <strong>Infrastructure Security</strong></a></li><li><a href="#3-developer-security" class="table-of-contents__link toc-highlight">3. <strong>Developer Security</strong></a></li><li><a href="#4-enterprise-security" class="table-of-contents__link toc-highlight">4. <strong>Enterprise Security</strong></a></li></ul></li><li><a href="#-what-youll-achieve" class="table-of-contents__link toc-highlight">âœ… What You&#39;ll Achieve</a></li></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2026 </div></div></div></footer></div>
</body>
</html>