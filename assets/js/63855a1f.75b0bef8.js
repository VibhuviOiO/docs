"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[3728],{3858:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>a,default:()=>d,frontMatter:()=>i,metadata:()=>r,toc:()=>c});const r=JSON.parse('{"id":"Observability/prometheus","title":"Prometheus","description":"Prometheus is a monitoring and alerting toolkit for collecting and querying metrics. Learn how to set up Prometheus with Docker for system monitoring.","source":"@site/docs/Observability/prometheus.md","sourceDirName":"Observability","slug":"/Observability/Prometheus","permalink":"/docs/docs/Observability/Prometheus","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/Observability/prometheus.md","tags":[],"version":"current","sidebarPosition":1,"frontMatter":{"sidebar_position":1,"title":"Prometheus","description":"Prometheus is a monitoring and alerting toolkit for collecting and querying metrics. Learn how to set up Prometheus with Docker for system monitoring.","slug":"/Observability/Prometheus","keywords":["Prometheus","monitoring","metrics","alerting","time-series database","observability"]},"sidebar":"tutorialSidebar","previous":{"title":"Observability & Monitoring","permalink":"/docs/docs/category/observability--monitoring"},"next":{"title":"Grafana","permalink":"/docs/docs/Observability/Grafana"}}');var s=n(4848),o=n(8453);const i={sidebar_position:1,title:"Prometheus",description:"Prometheus is a monitoring and alerting toolkit for collecting and querying metrics. Learn how to set up Prometheus with Docker for system monitoring.",slug:"/Observability/Prometheus",keywords:["Prometheus","monitoring","metrics","alerting","time-series database","observability"]},a="\ud83d\udcca Prometheus Monitoring & Alerting",l={},c=[{value:"\ud83d\udd27 Docker Setup",id:"-docker-setup",level:2},{value:"\u25b6\ufe0f Sample Queries",id:"\ufe0f-sample-queries",level:2},{value:"\ud83d\udcca Application Metrics",id:"-application-metrics",level:2},{value:"\ud83d\udea8 Alerting Rules",id:"-alerting-rules",level:2}];function m(e){const t={a:"a",code:"code",h1:"h1",h2:"h2",header:"header",hr:"hr",p:"p",pre:"pre",strong:"strong",...(0,o.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(t.header,{children:(0,s.jsx)(t.h1,{id:"-prometheus-monitoring--alerting",children:"\ud83d\udcca Prometheus Monitoring & Alerting"})}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"Prometheus"})," is a ",(0,s.jsx)(t.strong,{children:"monitoring"})," and ",(0,s.jsx)(t.strong,{children:"alerting toolkit"})," for collecting and querying ",(0,s.jsx)(t.strong,{children:"metrics"})," with ",(0,s.jsx)(t.strong,{children:"time-series database"})," and ",(0,s.jsx)(t.strong,{children:"PromQL"})," query language."]}),"\n",(0,s.jsx)(t.hr,{}),"\n",(0,s.jsx)(t.h2,{id:"-docker-setup",children:"\ud83d\udd27 Docker Setup"}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.code,{children:"Create docker-compose.yml:"})}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-yaml",children:"version: '3.8'\nservices:\n  prometheus:\n    image: prom/prometheus:latest\n    container_name: prometheus\n    ports:\n      - \"9090:9090\"\n    volumes:\n      - ./prometheus.yml:/etc/prometheus/prometheus.yml\n      - prometheus-data:/prometheus\n    command:\n      - '--config.file=/etc/prometheus/prometheus.yml'\n      - '--storage.tsdb.path=/prometheus'\n      - '--web.console.libraries=/etc/prometheus/console_libraries'\n      - '--web.console.templates=/etc/prometheus/consoles'\n\n  node-exporter:\n    image: prom/node-exporter:latest\n    container_name: node-exporter\n    ports:\n      - \"9100:9100\"\n\nvolumes:\n  prometheus-data:\n"})}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.code,{children:"Create prometheus.yml:"})}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-yaml",children:"global:\n  scrape_interval: 15s\n  evaluation_interval: 15s\n\nscrape_configs:\n  - job_name: 'prometheus'\n    static_configs:\n      - targets: ['localhost:9090']\n\n  - job_name: 'node-exporter'\n    static_configs:\n      - targets: ['node-exporter:9100']\n\n  - job_name: 'my-app'\n    static_configs:\n      - targets: ['app:8080']\n    metrics_path: '/metrics'\n    scrape_interval: 30s\n"})}),"\n",(0,s.jsx)(t.h2,{id:"\ufe0f-sample-queries",children:"\u25b6\ufe0f Sample Queries"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-bash",children:'# Access Prometheus UI at http://localhost:9090\n\n# CPU usage\n100 - (avg by (instance) (rate(node_cpu_seconds_total{mode="idle"}[5m])) * 100)\n\n# Memory usage\n(1 - (node_memory_MemAvailable_bytes / node_memory_MemTotal_bytes)) * 100\n\n# Disk usage\n100 - ((node_filesystem_avail_bytes * 100) / node_filesystem_size_bytes)\n\n# HTTP request rate\nrate(http_requests_total[5m])\n\n# 95th percentile response time\nhistogram_quantile(0.95, rate(http_request_duration_seconds_bucket[5m]))\n'})}),"\n",(0,s.jsx)(t.h2,{id:"-application-metrics",children:"\ud83d\udcca Application Metrics"}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.code,{children:"Python Flask example:"})}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-python",children:"from flask import Flask\nfrom prometheus_client import Counter, Histogram, generate_latest, CONTENT_TYPE_LATEST\nimport time\n\napp = Flask(__name__)\n\n# Metrics\nREQUEST_COUNT = Counter('http_requests_total', 'Total HTTP requests', ['method', 'endpoint'])\nREQUEST_LATENCY = Histogram('http_request_duration_seconds', 'HTTP request latency')\n\n@app.before_request\ndef before_request():\n    request.start_time = time.time()\n\n@app.after_request\ndef after_request(response):\n    REQUEST_COUNT.labels(method=request.method, endpoint=request.endpoint).inc()\n    REQUEST_LATENCY.observe(time.time() - request.start_time)\n    return response\n\n@app.route('/metrics')\ndef metrics():\n    return generate_latest(), 200, {'Content-Type': CONTENT_TYPE_LATEST}\n\n@app.route('/')\ndef hello():\n    return 'Hello World!'\n"})}),"\n",(0,s.jsx)(t.h2,{id:"-alerting-rules",children:"\ud83d\udea8 Alerting Rules"}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.code,{children:"Create alert.rules.yml:"})}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-yaml",children:'groups:\n  - name: example\n    rules:\n      - alert: HighCPUUsage\n        expr: 100 - (avg by (instance) (rate(node_cpu_seconds_total{mode="idle"}[5m])) * 100) > 80\n        for: 5m\n        labels:\n          severity: warning\n        annotations:\n          summary: "High CPU usage detected"\n          description: "CPU usage is above 80% for more than 5 minutes"\n\n      - alert: HighMemoryUsage\n        expr: (1 - (node_memory_MemAvailable_bytes / node_memory_MemTotal_bytes)) * 100 > 90\n        for: 2m\n        labels:\n          severity: critical\n        annotations:\n          summary: "High memory usage detected"\n          description: "Memory usage is above 90%"\n'})}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"Reference:"})," ",(0,s.jsx)(t.a,{href:"https://prometheus.io/docs/",children:"Prometheus Documentation"})]})]})}function d(e={}){const{wrapper:t}={...(0,o.R)(),...e.components};return t?(0,s.jsx)(t,{...e,children:(0,s.jsx)(m,{...e})}):m(e)}},8453:(e,t,n)=>{n.d(t,{R:()=>i,x:()=>a});var r=n(6540);const s={},o=r.createContext(s);function i(e){const t=r.useContext(o);return r.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function a(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:i(e.components),r.createElement(o.Provider,{value:t},e.children)}}}]);