"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[9716],{587:(n,e,t)=>{t.r(e),t.d(e,{assets:()=>c,contentTitle:()=>o,default:()=>d,frontMatter:()=>i,metadata:()=>a,toc:()=>p});const a=JSON.parse('{"id":"Testing-Scanning/DAST/owasp-zap","title":"OWASP ZAP","description":"OWASP ZAP (Zed Attack Proxy) is a free, open-source web application security scanner. Learn how to dockerize and run OWASP ZAP for dynamic security testing.","source":"@site/docs/Testing-Scanning/DAST/owasp-zap.md","sourceDirName":"Testing-Scanning/DAST","slug":"/Testing-Scanning/OWASP-ZAP","permalink":"/docs/Testing-Scanning/OWASP-ZAP","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/Testing-Scanning/DAST/owasp-zap.md","tags":[],"version":"current","sidebarPosition":1,"frontMatter":{"sidebar_position":1,"title":"OWASP ZAP","description":"OWASP ZAP (Zed Attack Proxy) is a free, open-source web application security scanner. Learn how to dockerize and run OWASP ZAP for dynamic security testing.","slug":"/Testing-Scanning/OWASP-ZAP","keywords":["OWASP ZAP","dynamic security testing","DAST","web application security","penetration testing","security scanning","vulnerability assessment","automated security testing","web security","OWASP"]},"sidebar":"tutorialSidebar","previous":{"title":"DAST","permalink":"/docs/category/dast"},"next":{"title":"Burp Suite","permalink":"/docs/Testing-Scanning/BurpSuite"}}');var s=t(4848),r=t(8453);const i={sidebar_position:1,title:"OWASP ZAP",description:"OWASP ZAP (Zed Attack Proxy) is a free, open-source web application security scanner. Learn how to dockerize and run OWASP ZAP for dynamic security testing.",slug:"/Testing-Scanning/OWASP-ZAP",keywords:["OWASP ZAP","dynamic security testing","DAST","web application security","penetration testing","security scanning","vulnerability assessment","automated security testing","web security","OWASP"]},o="\ud83d\udee1\ufe0f OWASP ZAP - Dynamic Application Security Testing",c={},p=[{value:"Set Up OWASP ZAP with Docker",id:"set-up-owasp-zap-with-docker",level:2},{value:"Command Line Usage",id:"command-line-usage",level:2},{value:"Basic Scanning",id:"basic-scanning",level:3},{value:"API Scanning",id:"api-scanning",level:3},{value:"Automated Scanning Scripts",id:"automated-scanning-scripts",level:2},{value:"Python Integration",id:"python-integration",level:3},{value:"CI/CD Integration",id:"cicd-integration",level:2},{value:"GitHub Actions Integration",id:"github-actions-integration",level:3},{value:"Jenkins Pipeline",id:"jenkins-pipeline",level:3},{value:"Advanced Configuration",id:"advanced-configuration",level:2},{value:"Custom ZAP Configuration",id:"custom-zap-configuration",level:3},{value:"ZAP Automation Framework",id:"zap-automation-framework",level:3},{value:"Security Testing Best Practices",id:"security-testing-best-practices",level:2},{value:"Comprehensive Scan Strategy",id:"comprehensive-scan-strategy",level:3},{value:"Common Use Cases",id:"common-use-cases",level:2}];function l(n){const e={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.R)(),...n.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(e.header,{children:(0,s.jsx)(e.h1,{id:"\ufe0f-owasp-zap---dynamic-application-security-testing",children:"\ud83d\udee1\ufe0f OWASP ZAP - Dynamic Application Security Testing"})}),"\n",(0,s.jsxs)(e.p,{children:[(0,s.jsx)(e.strong,{children:"OWASP ZAP"})," (Zed Attack Proxy) is one of the world's most popular ",(0,s.jsx)(e.strong,{children:"free security tools"})," and is actively maintained by hundreds of international volunteers. It helps you automatically find security vulnerabilities in your web applications while developing and testing."]}),"\n",(0,s.jsx)(e.hr,{}),"\n",(0,s.jsx)(e.h2,{id:"set-up-owasp-zap-with-docker",children:"Set Up OWASP ZAP with Docker"}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.code,{children:"Create a file named docker-compose.yml"})}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-yaml",children:'version: \'3.8\'\n\nservices:\n  zap:\n    image: owasp/zap2docker-stable:latest\n    container_name: owasp-zap\n    restart: unless-stopped\n    ports:\n      - "8080:8080"\n      - "8090:8090"\n    volumes:\n      - zap-data:/zap/wrk\n      - ./reports:/zap/wrk/reports\n      - ./scripts:/zap/wrk/scripts\n    environment:\n      - ZAP_PORT=8080\n    command: zap-webswing.sh\n    networks:\n      - zap-network\n\n  # Target application for testing\n  target-app:\n    image: webgoat/goatandwolf:latest\n    container_name: target-app\n    ports:\n      - "8081:8080"\n    networks:\n      - zap-network\n\nvolumes:\n  zap-data:\n\nnetworks:\n  zap-network:\n    driver: bridge\n'})}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.code,{children:"Start OWASP ZAP:"})}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-bash",children:"docker compose up -d\n"})}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.code,{children:"Access ZAP Web Interface:"})}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-bash",children:'# Open browser to http://localhost:8090\necho "ZAP Web Interface: http://localhost:8090"\n'})}),"\n",(0,s.jsx)(e.hr,{}),"\n",(0,s.jsx)(e.h2,{id:"command-line-usage",children:"Command Line Usage"}),"\n",(0,s.jsx)(e.h3,{id:"basic-scanning",children:"Basic Scanning"}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.code,{children:"Quick baseline scan:"})}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-bash",children:"docker run --rm -v $(pwd)/reports:/zap/wrk \\\n  owasp/zap2docker-stable:latest \\\n  zap-baseline.py -t https://example.com -r baseline-report.html\n"})}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.code,{children:"Full scan with authentication:"})}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-bash",children:"docker run --rm -v $(pwd)/reports:/zap/wrk \\\n  owasp/zap2docker-stable:latest \\\n  zap-full-scan.py -t https://example.com \\\n  -r full-scan-report.html \\\n  -a -j -x xml-report.xml\n"})}),"\n",(0,s.jsx)(e.h3,{id:"api-scanning",children:"API Scanning"}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.code,{children:"Scan REST API with OpenAPI spec:"})}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-bash",children:"docker run --rm -v $(pwd)/reports:/zap/wrk \\\n  -v $(pwd)/api-spec.json:/zap/wrk/api-spec.json \\\n  owasp/zap2docker-stable:latest \\\n  zap-api-scan.py -t https://api.example.com \\\n  -f openapi -r api-scan-report.html \\\n  -d /zap/wrk/api-spec.json\n"})}),"\n",(0,s.jsx)(e.hr,{}),"\n",(0,s.jsx)(e.h2,{id:"automated-scanning-scripts",children:"Automated Scanning Scripts"}),"\n",(0,s.jsx)(e.h3,{id:"python-integration",children:"Python Integration"}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.code,{children:"Create zap_scanner.py:"})}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-python",children:'#!/usr/bin/env python3\nimport time\nimport requests\nfrom zapv2 import ZAPv2\n\nclass ZAPScanner:\n    def __init__(self, proxy_host=\'localhost\', proxy_port=8080):\n        self.zap = ZAPv2(proxies={\n            \'http\': f\'http://{proxy_host}:{proxy_port}\',\n            \'https\': f\'http://{proxy_host}:{proxy_port}\'\n        })\n        \n    def start_scan(self, target_url):\n        """Start a comprehensive security scan"""\n        print(f"Starting scan for: {target_url}")\n        \n        # Spider the target\n        print("Starting spider...")\n        scan_id = self.zap.spider.scan(target_url)\n        \n        # Wait for spider to complete\n        while int(self.zap.spider.status(scan_id)) < 100:\n            print(f"Spider progress: {self.zap.spider.status(scan_id)}%")\n            time.sleep(2)\n        \n        print("Spider completed")\n        \n        # Start active scan\n        print("Starting active scan...")\n        scan_id = self.zap.ascan.scan(target_url)\n        \n        # Wait for active scan to complete\n        while int(self.zap.ascan.status(scan_id)) < 100:\n            print(f"Active scan progress: {self.zap.ascan.status(scan_id)}%")\n            time.sleep(5)\n        \n        print("Active scan completed")\n        \n    def get_alerts(self, risk_level=\'High\'):\n        """Get security alerts"""\n        alerts = self.zap.core.alerts()\n        high_risk_alerts = [alert for alert in alerts if alert[\'risk\'] == risk_level]\n        return high_risk_alerts\n    \n    def generate_report(self, format=\'HTML\'):\n        """Generate security report"""\n        if format.upper() == \'HTML\':\n            return self.zap.core.htmlreport()\n        elif format.upper() == \'XML\':\n            return self.zap.core.xmlreport()\n        elif format.upper() == \'JSON\':\n            return self.zap.core.jsonreport()\n    \n    def save_report(self, report_content, filename):\n        """Save report to file"""\n        with open(filename, \'w\') as f:\n            f.write(report_content)\n        print(f"Report saved to: {filename}")\n\n# Usage example\nif __name__ == "__main__":\n    scanner = ZAPScanner()\n    target = "http://target-app:8080"\n    \n    # Start comprehensive scan\n    scanner.start_scan(target)\n    \n    # Get high-risk alerts\n    alerts = scanner.get_alerts(\'High\')\n    print(f"Found {len(alerts)} high-risk vulnerabilities")\n    \n    # Generate and save reports\n    html_report = scanner.generate_report(\'HTML\')\n    scanner.save_report(html_report, \'security-report.html\')\n    \n    json_report = scanner.generate_report(\'JSON\')\n    scanner.save_report(json_report, \'security-report.json\')\n'})}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.code,{children:"Run the scanner:"})}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-bash",children:"pip install python-owasp-zap-v2.4\npython zap_scanner.py\n"})}),"\n",(0,s.jsx)(e.hr,{}),"\n",(0,s.jsx)(e.h2,{id:"cicd-integration",children:"CI/CD Integration"}),"\n",(0,s.jsx)(e.h3,{id:"github-actions-integration",children:"GitHub Actions Integration"}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.code,{children:"Create .github/workflows/security-scan.yml:"})}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-yaml",children:'name: Security Scan with OWASP ZAP\n\non:\n  push:\n    branches: [ main, develop ]\n  pull_request:\n    branches: [ main ]\n\njobs:\n  security-scan:\n    runs-on: ubuntu-latest\n    \n    services:\n      zap:\n        image: owasp/zap2docker-stable:latest\n        ports:\n          - 8080:8080\n        options: >-\n          --health-cmd "curl -f http://localhost:8080 || exit 1"\n          --health-interval 30s\n          --health-timeout 10s\n          --health-retries 5\n    \n    steps:\n    - uses: actions/checkout@v3\n    \n    - name: Build and start application\n      run: |\n        docker build -t test-app .\n        docker run -d -p 3000:3000 --name test-app test-app\n        sleep 30\n    \n    - name: Run ZAP Baseline Scan\n      run: |\n        docker run --rm --network host \\\n          -v ${{ github.workspace }}/reports:/zap/wrk \\\n          owasp/zap2docker-stable:latest \\\n          zap-baseline.py -t http://localhost:3000 \\\n          -r baseline-report.html \\\n          -x baseline-report.xml\n    \n    - name: Run ZAP Full Scan\n      if: github.event_name == \'push\' && github.ref == \'refs/heads/main\'\n      run: |\n        docker run --rm --network host \\\n          -v ${{ github.workspace }}/reports:/zap/wrk \\\n          owasp/zap2docker-stable:latest \\\n          zap-full-scan.py -t http://localhost:3000 \\\n          -r full-scan-report.html \\\n          -x full-scan-report.xml\n    \n    - name: Upload ZAP Reports\n      uses: actions/upload-artifact@v3\n      if: always()\n      with:\n        name: zap-reports\n        path: reports/\n    \n    - name: Parse ZAP Results\n      run: |\n        if [ -f "reports/baseline-report.xml" ]; then\n          HIGH_ALERTS=$(grep -c \'riskcode="3"\' reports/baseline-report.xml || echo "0")\n          MEDIUM_ALERTS=$(grep -c \'riskcode="2"\' reports/baseline-report.xml || echo "0")\n          \n          echo "High Risk Alerts: $HIGH_ALERTS"\n          echo "Medium Risk Alerts: $MEDIUM_ALERTS"\n          \n          if [ "$HIGH_ALERTS" -gt "0" ]; then\n            echo "\u274c High risk vulnerabilities found!"\n            exit 1\n          fi\n        fi\n'})}),"\n",(0,s.jsx)(e.h3,{id:"jenkins-pipeline",children:"Jenkins Pipeline"}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.code,{children:"Create Jenkinsfile:"})}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-groovy",children:"pipeline {\n    agent any\n    \n    environment {\n        ZAP_PORT = '8080'\n        TARGET_URL = 'http://localhost:3000'\n    }\n    \n    stages {\n        stage('Build Application') {\n            steps {\n                script {\n                    sh 'docker build -t test-app .'\n                    sh 'docker run -d -p 3000:3000 --name test-app test-app'\n                    sleep(30)\n                }\n            }\n        }\n        \n        stage('Start ZAP') {\n            steps {\n                script {\n                    sh '''\n                        docker run -d --name zap \\\n                            -p 8080:8080 \\\n                            -v $(pwd)/reports:/zap/wrk \\\n                            owasp/zap2docker-stable:latest \\\n                            zap.sh -daemon -host 0.0.0.0 -port 8080\n                    '''\n                    sleep(30)\n                }\n            }\n        }\n        \n        stage('Security Scan') {\n            parallel {\n                stage('Baseline Scan') {\n                    steps {\n                        sh '''\n                            docker exec zap zap-baseline.py \\\n                                -t ${TARGET_URL} \\\n                                -r baseline-report.html \\\n                                -x baseline-report.xml\n                        '''\n                    }\n                }\n                \n                stage('API Scan') {\n                    when {\n                        fileExists 'api-spec.json'\n                    }\n                    steps {\n                        sh '''\n                            docker cp api-spec.json zap:/zap/wrk/\n                            docker exec zap zap-api-scan.py \\\n                                -t ${TARGET_URL} \\\n                                -f openapi \\\n                                -r api-scan-report.html \\\n                                -d /zap/wrk/api-spec.json\n                        '''\n                    }\n                }\n            }\n        }\n        \n        stage('Generate Reports') {\n            steps {\n                sh 'docker cp zap:/zap/wrk/reports ./reports'\n                \n                publishHTML([\n                    allowMissing: false,\n                    alwaysLinkToLastBuild: true,\n                    keepAll: true,\n                    reportDir: 'reports',\n                    reportFiles: '*.html',\n                    reportName: 'ZAP Security Report'\n                ])\n            }\n        }\n    }\n    \n    post {\n        always {\n            sh 'docker stop test-app zap || true'\n            sh 'docker rm test-app zap || true'\n        }\n        \n        failure {\n            emailext (\n                subject: \"Security Scan Failed: ${env.JOB_NAME} - ${env.BUILD_NUMBER}\",\n                body: \"Security vulnerabilities found. Check the ZAP report for details.\",\n                to: \"${env.CHANGE_AUTHOR_EMAIL}\"\n            )\n        }\n    }\n}\n"})}),"\n",(0,s.jsx)(e.hr,{}),"\n",(0,s.jsx)(e.h2,{id:"advanced-configuration",children:"Advanced Configuration"}),"\n",(0,s.jsx)(e.h3,{id:"custom-zap-configuration",children:"Custom ZAP Configuration"}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.code,{children:"Create zap-config.xml:"})}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-xml",children:'<?xml version="1.0" encoding="UTF-8" standalone="no"?>\n<configuration>\n    <scanner>\n        <level>MEDIUM</level>\n        <strength>MEDIUM</strength>\n    </scanner>\n    \n    <spider>\n        <maxDepth>5</maxDepth>\n        <maxChildren>10</maxChildren>\n        <acceptCookies>true</acceptCookies>\n        <handleParameters>true</handleParameters>\n    </spider>\n    \n    <authentication>\n        <type>form</type>\n        <loginUrl>http://localhost:3000/login</loginUrl>\n        <usernameField>username</usernameField>\n        <passwordField>password</passwordField>\n        <username>testuser</username>\n        <password>testpass</password>\n    </authentication>\n    \n    <session>\n        <management>cookie</management>\n    </session>\n</configuration>\n'})}),"\n",(0,s.jsx)(e.h3,{id:"zap-automation-framework",children:"ZAP Automation Framework"}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.code,{children:"Create automation.yaml:"})}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-yaml",children:'env:\n  contexts:\n    - name: "test-context"\n      urls:\n        - "http://localhost:3000"\n      includePaths:\n        - "http://localhost:3000/.*"\n      excludePaths:\n        - "http://localhost:3000/logout"\n        - "http://localhost:3000/admin/.*"\n\njobs:\n  - type: spider\n    parameters:\n      context: "test-context"\n      maxDuration: 10\n      maxDepth: 5\n      \n  - type: activeScan\n    parameters:\n      context: "test-context"\n      maxDuration: 20\n      \n  - type: report\n    parameters:\n      template: "traditional-html"\n      reportDir: "/zap/wrk/reports"\n      reportFile: "automation-report.html"\n'})}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.code,{children:"Run with automation framework:"})}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-bash",children:"docker run --rm -v $(pwd)/reports:/zap/wrk/reports \\\n  -v $(pwd)/automation.yaml:/zap/wrk/automation.yaml \\\n  owasp/zap2docker-stable:latest \\\n  zap.sh -cmd -autorun /zap/wrk/automation.yaml\n"})}),"\n",(0,s.jsx)(e.hr,{}),"\n",(0,s.jsx)(e.h2,{id:"security-testing-best-practices",children:"Security Testing Best Practices"}),"\n",(0,s.jsx)(e.h3,{id:"comprehensive-scan-strategy",children:"Comprehensive Scan Strategy"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-bash",children:'#!/bin/bash\n# comprehensive-scan.sh\n\nTARGET_URL="$1"\nREPORT_DIR="./reports"\n\nif [ -z "$TARGET_URL" ]; then\n    echo "Usage: $0 <target-url>"\n    exit 1\nfi\n\nmkdir -p $REPORT_DIR\n\necho "Starting comprehensive security scan for: $TARGET_URL"\n\n# 1. Quick baseline scan\necho "Running baseline scan..."\ndocker run --rm -v $(pwd)/reports:/zap/wrk \\\n  owasp/zap2docker-stable:latest \\\n  zap-baseline.py -t $TARGET_URL \\\n  -r baseline-report.html \\\n  -x baseline-report.xml\n\n# 2. Full active scan\necho "Running full active scan..."\ndocker run --rm -v $(pwd)/reports:/zap/wrk \\\n  owasp/zap2docker-stable:latest \\\n  zap-full-scan.py -t $TARGET_URL \\\n  -r full-scan-report.html \\\n  -x full-scan-report.xml\n\n# 3. API scan if OpenAPI spec exists\nif [ -f "api-spec.json" ]; then\n    echo "Running API scan..."\n    docker run --rm -v $(pwd)/reports:/zap/wrk \\\n      -v $(pwd)/api-spec.json:/zap/wrk/api-spec.json \\\n      owasp/zap2docker-stable:latest \\\n      zap-api-scan.py -t $TARGET_URL \\\n      -f openapi -r api-scan-report.html \\\n      -d /zap/wrk/api-spec.json\nfi\n\necho "Scan completed. Reports available in: $REPORT_DIR"\n'})}),"\n",(0,s.jsx)(e.hr,{}),"\n",(0,s.jsx)(e.h2,{id:"common-use-cases",children:"Common Use Cases"}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.strong,{children:"Web Application Security Testing"}),": Comprehensive vulnerability assessment"]}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.strong,{children:"API Security Testing"}),": REST and GraphQL API security validation"]}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.strong,{children:"CI/CD Integration"}),": Automated security testing in development pipelines"]}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.strong,{children:"Penetration Testing"}),": Manual security testing with proxy capabilities"]}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.strong,{children:"Compliance Testing"}),": OWASP Top 10 and security standard compliance"]}),"\n"]}),"\n",(0,s.jsx)(e.p,{children:"\u2705 OWASP ZAP is now configured for comprehensive dynamic security testing!"})]})}function d(n={}){const{wrapper:e}={...(0,r.R)(),...n.components};return e?(0,s.jsx)(e,{...n,children:(0,s.jsx)(l,{...n})}):l(n)}},8453:(n,e,t)=>{t.d(e,{R:()=>i,x:()=>o});var a=t(6540);const s={},r=a.createContext(s);function i(n){const e=a.useContext(r);return a.useMemo((function(){return"function"==typeof n?n(e):{...e,...n}}),[e,n])}function o(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(s):n.components||s:i(n.components),a.createElement(r.Provider,{value:e},n.children)}}}]);