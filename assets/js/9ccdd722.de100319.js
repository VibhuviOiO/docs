"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[3533],{8453:(e,n,s)=>{s.d(n,{R:()=>a,x:()=>o});var t=s(6540);const i={},r=t.createContext(i);function a(e){const n=t.useContext(r);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:a(e.components),t.createElement(r.Provider,{value:n},e.children)}},9408:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>l,contentTitle:()=>o,default:()=>p,frontMatter:()=>a,metadata:()=>t,toc:()=>c});const t=JSON.parse('{"id":"CI-CD/CI/azure-devops","title":"Azure DevOps","description":"Azure DevOps is Microsoft\'s comprehensive DevOps platform providing CI/CD pipelines, repositories, and project management. Learn how to set up Azure DevOps pipelines with Docker.","source":"@site/docs/CI-CD/CI/azure-devops.md","sourceDirName":"CI-CD/CI","slug":"/CI-CD/AzureDevOps","permalink":"/docs/CI-CD/AzureDevOps","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/CI-CD/CI/azure-devops.md","tags":[],"version":"current","sidebarPosition":4,"frontMatter":{"sidebar_position":4,"title":"Azure DevOps","description":"Azure DevOps is Microsoft\'s comprehensive DevOps platform providing CI/CD pipelines, repositories, and project management. Learn how to set up Azure DevOps pipelines with Docker.","slug":"/CI-CD/AzureDevOps","keywords":["Azure DevOps","Microsoft DevOps","CI/CD pipeline","Azure Pipelines","DevOps automation","continuous integration","continuous deployment","YAML pipelines","build automation","release management"]},"sidebar":"tutorialSidebar","previous":{"title":"GitLab CI/CD","permalink":"/docs/CICD/GitLabCI"},"next":{"title":"CircleCI","permalink":"/docs/CI-CD/CircleCI"}}');var i=s(4848),r=s(8453);const a={sidebar_position:4,title:"Azure DevOps",description:"Azure DevOps is Microsoft's comprehensive DevOps platform providing CI/CD pipelines, repositories, and project management. Learn how to set up Azure DevOps pipelines with Docker.",slug:"/CI-CD/AzureDevOps",keywords:["Azure DevOps","Microsoft DevOps","CI/CD pipeline","Azure Pipelines","DevOps automation","continuous integration","continuous deployment","YAML pipelines","build automation","release management"]},o="\u2601\ufe0f Azure DevOps - Microsoft's Complete DevOps Platform",l={},c=[{value:"Set Up Azure DevOps with Docker",id:"set-up-azure-devops-with-docker",level:2},{value:"Azure DevOps Server (On-Premises)",id:"azure-devops-server-on-premises",level:3},{value:"Azure Pipelines YAML Configuration",id:"azure-pipelines-yaml-configuration",level:2},{value:"Basic CI Pipeline",id:"basic-ci-pipeline",level:3},{value:"Multi-Stage Pipeline with Deployment",id:"multi-stage-pipeline-with-deployment",level:3},{value:"Self-Hosted Agent Setup",id:"self-hosted-agent-setup",level:2},{value:"Docker Agent Configuration",id:"docker-agent-configuration",level:3},{value:"Advanced Pipeline Features",id:"advanced-pipeline-features",level:2},{value:"Template Usage",id:"template-usage",level:3},{value:"Conditional Deployments",id:"conditional-deployments",level:3},{value:"Integration with External Tools",id:"integration-with-external-tools",level:2},{value:"Kubernetes Deployment",id:"kubernetes-deployment",level:3},{value:"Helm Deployment",id:"helm-deployment",level:3},{value:"Security and Best Practices",id:"security-and-best-practices",level:2},{value:"Variable Groups and Secrets",id:"variable-groups-and-secrets",level:3},{value:"Service Connections",id:"service-connections",level:3},{value:"Monitoring and Reporting",id:"monitoring-and-reporting",level:2},{value:"Test Results Publishing",id:"test-results-publishing",level:3},{value:"Build Artifacts",id:"build-artifacts",level:3},{value:"Common Use Cases",id:"common-use-cases",level:2}];function d(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"\ufe0f-azure-devops---microsofts-complete-devops-platform",children:"\u2601\ufe0f Azure DevOps - Microsoft's Complete DevOps Platform"})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Azure DevOps"})," is Microsoft's comprehensive cloud-based DevOps platform that provides ",(0,i.jsx)(n.strong,{children:"CI/CD pipelines"}),", ",(0,i.jsx)(n.strong,{children:"Git repositories"}),", ",(0,i.jsx)(n.strong,{children:"project management"}),", and ",(0,i.jsx)(n.strong,{children:"testing tools"})," in one integrated solution."]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"set-up-azure-devops-with-docker",children:"Set Up Azure DevOps with Docker"}),"\n",(0,i.jsx)(n.h3,{id:"azure-devops-server-on-premises",children:"Azure DevOps Server (On-Premises)"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:"Create a file named docker-compose.yml"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:'version: \'3.8\'\n\nservices:\n  azuredevops-server:\n    image: mcr.microsoft.com/azure-devops/server:2022\n    container_name: azuredevops-server\n    restart: unless-stopped\n    ports:\n      - "8080:8080"\n      - "443:443"\n    environment:\n      ACCEPT_EULA: "Y"\n      SQL_SERVER_INSTANCE: "sqlserver"\n      SQL_DATABASE: "AzureDevOps"\n      SQL_USERNAME: "sa"\n      SQL_PASSWORD: "YourStrong@Password"\n    volumes:\n      - azuredevops-data:/azuredevops/data\n      - azuredevops-logs:/azuredevops/logs\n    depends_on:\n      - sqlserver\n\n  sqlserver:\n    image: mcr.microsoft.com/mssql/server:2019-latest\n    container_name: azuredevops-sql\n    environment:\n      SA_PASSWORD: "YourStrong@Password"\n      ACCEPT_EULA: "Y"\n    volumes:\n      - sqlserver-data:/var/opt/mssql\n    ports:\n      - "1433:1433"\n\n  # Self-hosted agent\n  azuredevops-agent:\n    image: mcr.microsoft.com/azure-pipelines/vsts-agent:ubuntu-20.04\n    container_name: azuredevops-agent\n    environment:\n      AZP_URL: "https://dev.azure.com/yourorganization"\n      AZP_TOKEN: "your-personal-access-token"\n      AZP_AGENT_NAME: "docker-agent"\n      AZP_POOL: "Default"\n    volumes:\n      - /var/run/docker.sock:/var/run/docker.sock\n      - agent-work:/azp\n    restart: unless-stopped\n\nvolumes:\n  azuredevops-data:\n  azuredevops-logs:\n  sqlserver-data:\n  agent-work:\n'})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:"Start Azure DevOps:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"docker compose up -d\n"})}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"azure-pipelines-yaml-configuration",children:"Azure Pipelines YAML Configuration"}),"\n",(0,i.jsx)(n.h3,{id:"basic-ci-pipeline",children:"Basic CI Pipeline"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:"Create azure-pipelines.yml:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:"trigger:\n  branches:\n    include:\n      - main\n      - develop\n\npool:\n  vmImage: 'ubuntu-latest'\n\nvariables:\n  buildConfiguration: 'Release'\n  dockerRegistryServiceConnection: 'myDockerRegistry'\n  imageRepository: 'myapp'\n  containerRegistry: 'myregistry.azurecr.io'\n  dockerfilePath: '$(Build.SourcesDirectory)/Dockerfile'\n  tag: '$(Build.BuildId)'\n\nstages:\n- stage: Build\n  displayName: 'Build and Test'\n  jobs:\n  - job: Build\n    displayName: 'Build job'\n    steps:\n    - task: UseDotNet@2\n      displayName: 'Use .NET Core SDK'\n      inputs:\n        packageType: 'sdk'\n        version: '8.x'\n\n    - task: DotNetCoreCLI@2\n      displayName: 'Restore packages'\n      inputs:\n        command: 'restore'\n        projects: '**/*.csproj'\n\n    - task: DotNetCoreCLI@2\n      displayName: 'Build application'\n      inputs:\n        command: 'build'\n        projects: '**/*.csproj'\n        arguments: '--configuration $(buildConfiguration)'\n\n    - task: DotNetCoreCLI@2\n      displayName: 'Run tests'\n      inputs:\n        command: 'test'\n        projects: '**/*Tests.csproj'\n        arguments: '--configuration $(buildConfiguration) --collect \"Code coverage\"'\n\n    - task: Docker@2\n      displayName: 'Build Docker image'\n      inputs:\n        containerRegistry: '$(dockerRegistryServiceConnection)'\n        repository: '$(imageRepository)'\n        command: 'build'\n        Dockerfile: '$(dockerfilePath)'\n        tags: |\n          $(tag)\n          latest\n\n    - task: Docker@2\n      displayName: 'Push Docker image'\n      inputs:\n        containerRegistry: '$(dockerRegistryServiceConnection)'\n        repository: '$(imageRepository)'\n        command: 'push'\n        tags: |\n          $(tag)\n          latest\n\n    - task: PublishBuildArtifacts@1\n      displayName: 'Publish artifacts'\n      inputs:\n        PathtoPublish: '$(Build.ArtifactStagingDirectory)'\n        ArtifactName: 'drop'\n"})}),"\n",(0,i.jsx)(n.h3,{id:"multi-stage-pipeline-with-deployment",children:"Multi-Stage Pipeline with Deployment"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:"trigger:\n  branches:\n    include:\n      - main\n\nvariables:\n  - group: 'production-variables'\n  - name: vmImageName\n    value: 'ubuntu-latest'\n\nstages:\n- stage: Build\n  displayName: 'Build Stage'\n  jobs:\n  - job: Build\n    displayName: 'Build and Test'\n    pool:\n      vmImage: $(vmImageName)\n    steps:\n    - script: |\n        echo \"Building application...\"\n        docker build -t myapp:$(Build.BuildId) .\n      displayName: 'Build Docker Image'\n\n    - script: |\n        echo \"Running tests...\"\n        docker run --rm myapp:$(Build.BuildId) npm test\n      displayName: 'Run Tests'\n\n- stage: Deploy_Dev\n  displayName: 'Deploy to Development'\n  dependsOn: Build\n  condition: succeeded()\n  jobs:\n  - deployment: DeployDev\n    displayName: 'Deploy to Dev Environment'\n    pool:\n      vmImage: $(vmImageName)\n    environment: 'development'\n    strategy:\n      runOnce:\n        deploy:\n          steps:\n          - script: |\n              echo \"Deploying to development...\"\n              kubectl apply -f k8s/dev/\n            displayName: 'Deploy to Kubernetes'\n\n- stage: Deploy_Prod\n  displayName: 'Deploy to Production'\n  dependsOn: Deploy_Dev\n  condition: and(succeeded(), eq(variables['Build.SourceBranch'], 'refs/heads/main'))\n  jobs:\n  - deployment: DeployProd\n    displayName: 'Deploy to Production'\n    pool:\n      vmImage: $(vmImageName)\n    environment: 'production'\n    strategy:\n      runOnce:\n        deploy:\n          steps:\n          - script: |\n              echo \"Deploying to production...\"\n              kubectl apply -f k8s/prod/\n            displayName: 'Deploy to Production Kubernetes'\n"})}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"self-hosted-agent-setup",children:"Self-Hosted Agent Setup"}),"\n",(0,i.jsx)(n.h3,{id:"docker-agent-configuration",children:"Docker Agent Configuration"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:"Create agent-dockerfile:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-dockerfile",children:'FROM mcr.microsoft.com/azure-pipelines/vsts-agent:ubuntu-20.04\n\n# Install additional tools\nRUN apt-get update && apt-get install -y \\\n    curl \\\n    git \\\n    jq \\\n    wget \\\n    unzip \\\n    && rm -rf /var/lib/apt/lists/*\n\n# Install Docker CLI\nRUN curl -fsSL https://get.docker.com -o get-docker.sh && \\\n    sh get-docker.sh && \\\n    rm get-docker.sh\n\n# Install kubectl\nRUN curl -LO "https://dl.k8s.io/release/$(curl -L -s https://dl.k8s.io/release/stable.txt)/bin/linux/amd64/kubectl" && \\\n    install -o root -g root -m 0755 kubectl /usr/local/bin/kubectl\n\n# Install Helm\nRUN curl https://raw.githubusercontent.com/helm/helm/main/scripts/get-helm-3 | bash\n\nUSER vsts\n'})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:"Build and run custom agent:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:'docker build -t custom-azure-agent -f agent-dockerfile .\n\ndocker run -d \\\n  --name azure-agent \\\n  -e AZP_URL="https://dev.azure.com/yourorganization" \\\n  -e AZP_TOKEN="your-personal-access-token" \\\n  -e AZP_AGENT_NAME="custom-docker-agent" \\\n  -e AZP_POOL="Default" \\\n  -v /var/run/docker.sock:/var/run/docker.sock \\\n  custom-azure-agent\n'})}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"advanced-pipeline-features",children:"Advanced Pipeline Features"}),"\n",(0,i.jsx)(n.h3,{id:"template-usage",children:"Template Usage"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:"Create templates/build-template.yml:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:"parameters:\n- name: buildConfiguration\n  type: string\n  default: 'Release'\n- name: projectPath\n  type: string\n\nsteps:\n- task: DotNetCoreCLI@2\n  displayName: 'Restore ${{ parameters.projectPath }}'\n  inputs:\n    command: 'restore'\n    projects: '${{ parameters.projectPath }}'\n\n- task: DotNetCoreCLI@2\n  displayName: 'Build ${{ parameters.projectPath }}'\n  inputs:\n    command: 'build'\n    projects: '${{ parameters.projectPath }}'\n    arguments: '--configuration ${{ parameters.buildConfiguration }}'\n\n- task: DotNetCoreCLI@2\n  displayName: 'Test ${{ parameters.projectPath }}'\n  inputs:\n    command: 'test'\n    projects: '${{ parameters.projectPath }}'\n    arguments: '--configuration ${{ parameters.buildConfiguration }}'\n"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:"Use template in main pipeline:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:"trigger:\n- main\n\npool:\n  vmImage: 'ubuntu-latest'\n\njobs:\n- job: BuildAPI\n  displayName: 'Build API'\n  steps:\n  - template: templates/build-template.yml\n    parameters:\n      buildConfiguration: 'Release'\n      projectPath: 'src/API/*.csproj'\n\n- job: BuildWeb\n  displayName: 'Build Web'\n  steps:\n  - template: templates/build-template.yml\n    parameters:\n      buildConfiguration: 'Release'\n      projectPath: 'src/Web/*.csproj'\n"})}),"\n",(0,i.jsx)(n.h3,{id:"conditional-deployments",children:"Conditional Deployments"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:"stages:\n- stage: Deploy\n  condition: and(succeeded(), eq(variables['Build.SourceBranch'], 'refs/heads/main'))\n  jobs:\n  - deployment: DeployToProduction\n    environment: 'production'\n    strategy:\n      runOnce:\n        deploy:\n          steps:\n          - script: echo \"Deploying to production\"\n            condition: eq(variables['Build.Reason'], 'Manual')\n"})}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"integration-with-external-tools",children:"Integration with External Tools"}),"\n",(0,i.jsx)(n.h3,{id:"kubernetes-deployment",children:"Kubernetes Deployment"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:"- task: KubernetesManifest@0\n  displayName: 'Deploy to Kubernetes'\n  inputs:\n    action: 'deploy'\n    kubernetesServiceConnection: 'k8s-connection'\n    namespace: 'production'\n    manifests: |\n      k8s/deployment.yaml\n      k8s/service.yaml\n    containers: '$(containerRegistry)/$(imageRepository):$(tag)'\n"})}),"\n",(0,i.jsx)(n.h3,{id:"helm-deployment",children:"Helm Deployment"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:"- task: HelmDeploy@0\n  displayName: 'Deploy with Helm'\n  inputs:\n    connectionType: 'Kubernetes Service Connection'\n    kubernetesServiceConnection: 'k8s-connection'\n    namespace: 'production'\n    command: 'upgrade'\n    chartType: 'FilePath'\n    chartPath: 'helm/myapp'\n    releaseName: 'myapp-release'\n    arguments: '--set image.tag=$(tag)'\n"})}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"security-and-best-practices",children:"Security and Best Practices"}),"\n",(0,i.jsx)(n.h3,{id:"variable-groups-and-secrets",children:"Variable Groups and Secrets"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:"variables:\n- group: 'production-secrets'\n- name: 'publicVariable'\n  value: 'public-value'\n\nsteps:\n- script: |\n    echo \"Using secret: $(secret-variable)\"\n    echo \"Public variable: $(publicVariable)\"\n  env:\n    SECRET_VAR: $(secret-variable)\n  displayName: 'Use Variables'\n"})}),"\n",(0,i.jsx)(n.h3,{id:"service-connections",children:"Service Connections"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:"- task: AzureCLI@2\n  displayName: 'Azure CLI Task'\n  inputs:\n    azureSubscription: 'azure-service-connection'\n    scriptType: 'bash'\n    scriptLocation: 'inlineScript'\n    inlineScript: |\n      az group list --output table\n"})}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"monitoring-and-reporting",children:"Monitoring and Reporting"}),"\n",(0,i.jsx)(n.h3,{id:"test-results-publishing",children:"Test Results Publishing"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:"- task: PublishTestResults@2\n  displayName: 'Publish Test Results'\n  inputs:\n    testResultsFormat: 'VSTest'\n    testResultsFiles: '**/*.trx'\n    mergeTestResults: true\n\n- task: PublishCodeCoverageResults@1\n  displayName: 'Publish Code Coverage'\n  inputs:\n    codeCoverageTool: 'Cobertura'\n    summaryFileLocation: '$(Agent.TempDirectory)/**/coverage.cobertura.xml'\n"})}),"\n",(0,i.jsx)(n.h3,{id:"build-artifacts",children:"Build Artifacts"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:"- task: PublishBuildArtifacts@1\n  displayName: 'Publish Build Artifacts'\n  inputs:\n    PathtoPublish: '$(Build.ArtifactStagingDirectory)'\n    ArtifactName: 'drop'\n    publishLocation: 'Container'\n"})}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"common-use-cases",children:"Common Use Cases"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Enterprise Applications"}),": Large-scale .NET, Java, and Node.js applications"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Microservices"}),": Container-based deployments with Kubernetes"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Mobile Development"}),": iOS and Android app CI/CD"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Infrastructure as Code"}),": Terraform and ARM template deployments"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Multi-Cloud Deployments"}),": Azure, AWS, and GCP integrations"]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"\u2705 Azure DevOps is now configured for comprehensive CI/CD workflows!"})]})}function p(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}}}]);