"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[11],{1946:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>o,contentTitle:()=>r,default:()=>h,frontMatter:()=>c,metadata:()=>a,toc:()=>l});const a=JSON.parse('{"id":"Databases/Search-Analytics/elastic-stack","title":"Elastic Stack (ELK)","description":"Elastic Stack (Elasticsearch + Kibana + Logstash) is a powerful search and analytics platform. Learn how to dockerize and run the complete ELK stack.","source":"@site/docs/Databases/Search-Analytics/elastic-stack.md","sourceDirName":"Databases/Search-Analytics","slug":"/SearchAnalytics/ElasticStack","permalink":"/docs/SearchAnalytics/ElasticStack","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/Databases/Search-Analytics/elastic-stack.md","tags":[],"version":"current","sidebarPosition":1,"frontMatter":{"sidebar_position":1,"title":"Elastic Stack (ELK)","description":"Elastic Stack (Elasticsearch + Kibana + Logstash) is a powerful search and analytics platform. Learn how to dockerize and run the complete ELK stack.","slug":"/SearchAnalytics/ElasticStack","keywords":["Elasticsearch","Kibana","Logstash","ELK Stack","Elastic Stack","search engine","log analysis","data visualization","Docker ELK","analytics platform"]},"sidebar":"tutorialSidebar","previous":{"title":"Search-Analytics","permalink":"/docs/category/search-analytics"},"next":{"title":"Apache-Druid","permalink":"/docs/Databases/Search-Analytics/Apache-Druid"}}');var t=s(4848),i=s(8453);const c={sidebar_position:1,title:"Elastic Stack (ELK)",description:"Elastic Stack (Elasticsearch + Kibana + Logstash) is a powerful search and analytics platform. Learn how to dockerize and run the complete ELK stack.",slug:"/SearchAnalytics/ElasticStack",keywords:["Elasticsearch","Kibana","Logstash","ELK Stack","Elastic Stack","search engine","log analysis","data visualization","Docker ELK","analytics platform"]},r="\ud83d\udd0d Dockerizing Elastic Stack (ELK) for Powerful Search and Analytics",o={},l=[{value:"Set Up Elastic Stack with Docker Compose",id:"set-up-elastic-stack-with-docker-compose",level:2},{value:"Test Elasticsearch",id:"test-elasticsearch",level:2},{value:"Basic Elasticsearch Operations",id:"basic-elasticsearch-operations",level:3},{value:"Python Integration",id:"python-integration",level:2},{value:"Access Kibana Dashboard",id:"access-kibana-dashboard",level:2},{value:"Log Processing with Logstash",id:"log-processing-with-logstash",level:2},{value:"Common Use Cases",id:"common-use-cases",level:2}];function d(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,i.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"-dockerizing-elastic-stack-elk-for-powerful-search-and-analytics",children:"\ud83d\udd0d Dockerizing Elastic Stack (ELK) for Powerful Search and Analytics"})}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Elastic Stack"})," (formerly ELK Stack) combines ",(0,t.jsx)(n.strong,{children:"Elasticsearch"}),", ",(0,t.jsx)(n.strong,{children:"Kibana"}),", and ",(0,t.jsx)(n.strong,{children:"Logstash"})," to provide a complete search and analytics platform. Perfect for ",(0,t.jsx)(n.strong,{children:"log analysis"}),", ",(0,t.jsx)(n.strong,{children:"full-text search"}),", ",(0,t.jsx)(n.strong,{children:"data visualization"}),", and ",(0,t.jsx)(n.strong,{children:"real-time monitoring"}),"."]}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"set-up-elastic-stack-with-docker-compose",children:"Set Up Elastic Stack with Docker Compose"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.code,{children:"Create a file named docker-compose.yml"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",children:'version: \'3.8\'\n\nservices:\n  elasticsearch:\n    image: docker.elastic.co/elasticsearch/elasticsearch:8.11.0\n    container_name: elasticsearch\n    restart: unless-stopped\n    ports:\n      - "9200:9200"\n      - "9300:9300"\n    environment:\n      discovery.type: single-node\n      ES_JAVA_OPTS: "-Xms1g -Xmx1g"\n      xpack.security.enabled: false\n      xpack.security.enrollment.enabled: false\n    volumes:\n      - elasticsearch-data:/usr/share/elasticsearch/data\n    healthcheck:\n      test: ["CMD-SHELL", "curl -f http://localhost:9200/_cluster/health || exit 1"]\n      interval: 30s\n      timeout: 10s\n      retries: 3\n\n  kibana:\n    image: docker.elastic.co/kibana/kibana:8.11.0\n    container_name: kibana\n    restart: unless-stopped\n    ports:\n      - "5601:5601"\n    environment:\n      ELASTICSEARCH_HOSTS: http://elasticsearch:9200\n      xpack.security.enabled: false\n    depends_on:\n      elasticsearch:\n        condition: service_healthy\n    healthcheck:\n      test: ["CMD-SHELL", "curl -f http://localhost:5601/api/status || exit 1"]\n      interval: 30s\n      timeout: 10s\n      retries: 3\n\n  logstash:\n    image: docker.elastic.co/logstash/logstash:8.11.0\n    container_name: logstash\n    restart: unless-stopped\n    ports:\n      - "5044:5044"\n      - "9600:9600"\n    environment:\n      LS_JAVA_OPTS: "-Xms512m -Xmx512m"\n    volumes:\n      - ./logstash/config:/usr/share/logstash/config\n      - ./logstash/pipeline:/usr/share/logstash/pipeline\n      - ./logs:/usr/share/logstash/logs\n    depends_on:\n      elasticsearch:\n        condition: service_healthy\n\nvolumes:\n  elasticsearch-data:\n'})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.code,{children:"Create Logstash configuration directory and files:"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"mkdir -p logstash/config logstash/pipeline logs\n"})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.code,{children:"Create logstash/config/logstash.yml:"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",children:'http.host: "0.0.0.0"\nxpack.monitoring.elasticsearch.hosts: ["http://elasticsearch:9200"]\n'})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.code,{children:"Create logstash/pipeline/logstash.conf:"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-ruby",children:'input {\n  beats {\n    port => 5044\n  }\n  file {\n    path => "/usr/share/logstash/logs/*.log"\n    start_position => "beginning"\n  }\n}\n\nfilter {\n  if [message] =~ /^\\d{4}-\\d{2}-\\d{2}/ {\n    grok {\n      match => { "message" => "%{TIMESTAMP_ISO8601:timestamp} %{LOGLEVEL:level} %{GREEDYDATA:content}" }\n    }\n    date {\n      match => [ "timestamp", "yyyy-MM-dd HH:mm:ss" ]\n    }\n  }\n}\n\noutput {\n  elasticsearch {\n    hosts => ["elasticsearch:9200"]\n    index => "logs-%{+YYYY.MM.dd}"\n  }\n  stdout { codec => rubydebug }\n}\n'})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.code,{children:"Start the Elastic Stack:"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"docker compose up -d\n"})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.code,{children:"Check if services are running:"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"docker ps\n"})}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"test-elasticsearch",children:"Test Elasticsearch"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.code,{children:"Test Elasticsearch connection:"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:'curl -X GET "localhost:9200/"\ncurl -X GET "localhost:9200/_cluster/health"\n'})}),"\n",(0,t.jsx)(n.h3,{id:"basic-elasticsearch-operations",children:"Basic Elasticsearch Operations"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.code,{children:"Create an index and add documents:"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:'# Create index\ncurl -X PUT "localhost:9200/products" -H \'Content-Type: application/json\' -d\'\n{\n  "mappings": {\n    "properties": {\n      "name": { "type": "text" },\n      "price": { "type": "float" },\n      "category": { "type": "keyword" },\n      "description": { "type": "text" },\n      "created_at": { "type": "date" }\n    }\n  }\n}\'\n\n# Add documents\ncurl -X POST "localhost:9200/products/_doc/1" -H \'Content-Type: application/json\' -d\'\n{\n  "name": "Laptop",\n  "price": 999.99,\n  "category": "Electronics",\n  "description": "High-performance laptop for work and gaming",\n  "created_at": "2024-01-15T10:00:00"\n}\'\n\ncurl -X POST "localhost:9200/products/_doc/2" -H \'Content-Type: application/json\' -d\'\n{\n  "name": "Wireless Mouse",\n  "price": 29.99,\n  "category": "Electronics",\n  "description": "Ergonomic wireless mouse with long battery life",\n  "created_at": "2024-01-15T11:00:00"\n}\'\n\n# Search documents\ncurl -X GET "localhost:9200/products/_search" -H \'Content-Type: application/json\' -d\'\n{\n  "query": {\n    "match": {\n      "description": "wireless"\n    }\n  }\n}\'\n'})}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"python-integration",children:"Python Integration"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.code,{children:"Install the Elasticsearch client:"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"python3 -m venv venv\nsource venv/bin/activate\npip install elasticsearch\n"})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.code,{children:"Create a file elasticsearch_test.py:"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-python",children:'from elasticsearch import Elasticsearch\nfrom datetime import datetime\nimport json\n\n# Connect to Elasticsearch\nes = Elasticsearch([{\'host\': \'localhost\', \'port\': 9200, \'scheme\': \'http\'}])\n\ntry:\n    # Check connection\n    if es.ping():\n        print("Connected to Elasticsearch")\n    else:\n        print("Could not connect to Elasticsearch")\n        exit()\n    \n    # Create index with mapping\n    index_name = "ecommerce"\n    mapping = {\n        "mappings": {\n            "properties": {\n                "product_name": {"type": "text", "analyzer": "standard"},\n                "price": {"type": "float"},\n                "category": {"type": "keyword"},\n                "brand": {"type": "keyword"},\n                "description": {"type": "text"},\n                "tags": {"type": "keyword"},\n                "in_stock": {"type": "boolean"},\n                "created_at": {"type": "date"}\n            }\n        }\n    }\n    \n    # Delete index if exists\n    if es.indices.exists(index=index_name):\n        es.indices.delete(index=index_name)\n    \n    # Create index\n    es.indices.create(index=index_name, body=mapping)\n    print(f"Created index: {index_name}")\n    \n    # Sample products\n    products = [\n        {\n            "product_name": "MacBook Pro",\n            "price": 1999.99,\n            "category": "Laptops",\n            "brand": "Apple",\n            "description": "Powerful laptop with M2 chip for professionals",\n            "tags": ["laptop", "apple", "professional", "m2"],\n            "in_stock": True,\n            "created_at": datetime.now()\n        },\n        {\n            "product_name": "Gaming Mouse",\n            "price": 79.99,\n            "category": "Accessories",\n            "brand": "Logitech",\n            "description": "High-precision gaming mouse with RGB lighting",\n            "tags": ["mouse", "gaming", "rgb", "precision"],\n            "in_stock": True,\n            "created_at": datetime.now()\n        },\n        {\n            "product_name": "Wireless Headphones",\n            "price": 299.99,\n            "category": "Audio",\n            "brand": "Sony",\n            "description": "Noise-canceling wireless headphones with premium sound",\n            "tags": ["headphones", "wireless", "noise-canceling", "audio"],\n            "in_stock": False,\n            "created_at": datetime.now()\n        }\n    ]\n    \n    # Index documents\n    for i, product in enumerate(products, 1):\n        response = es.index(index=index_name, id=i, body=product)\n        print(f"Indexed product {i}: {response[\'result\']}")\n    \n    # Refresh index to make documents searchable\n    es.indices.refresh(index=index_name)\n    \n    # Search examples\n    print("\\n=== Search Examples ===")\n    \n    # 1. Match query\n    search_body = {\n        "query": {\n            "match": {\n                "description": "gaming"\n            }\n        }\n    }\n    \n    response = es.search(index=index_name, body=search_body)\n    print(f"\\n1. Products matching \'gaming\': {response[\'hits\'][\'total\'][\'value\']} found")\n    for hit in response[\'hits\'][\'hits\']:\n        print(f"   - {hit[\'_source\'][\'product_name\']}: {hit[\'_source\'][\'price\']}")\n    \n    # 2. Filter by category and price range\n    search_body = {\n        "query": {\n            "bool": {\n                "filter": [\n                    {"term": {"category": "Accessories"}},\n                    {"range": {"price": {"gte": 50, "lte": 100}}}\n                ]\n            }\n        }\n    }\n    \n    response = es.search(index=index_name, body=search_body)\n    print(f"\\n2. Accessories $50-$100: {response[\'hits\'][\'total\'][\'value\']} found")\n    for hit in response[\'hits\'][\'hits\']:\n        print(f"   - {hit[\'_source\'][\'product_name\']}: ${hit[\'_source\'][\'price\']}")\n    \n    # 3. Aggregation - average price by category\n    search_body = {\n        "size": 0,\n        "aggs": {\n            "categories": {\n                "terms": {"field": "category"},\n                "aggs": {\n                    "avg_price": {"avg": {"field": "price"}}\n                }\n            }\n        }\n    }\n    \n    response = es.search(index=index_name, body=search_body)\n    print("\\n3. Average price by category:")\n    for bucket in response[\'aggregations\'][\'categories\'][\'buckets\']:\n        print(f"   - {bucket[\'key\']}: ${bucket[\'avg_price\'][\'value\']:.2f}")\n    \n    # 4. Full-text search with highlighting\n    search_body = {\n        "query": {\n            "multi_match": {\n                "query": "wireless professional",\n                "fields": ["product_name^2", "description"]\n            }\n        },\n        "highlight": {\n            "fields": {\n                "product_name": {},\n                "description": {}\n            }\n        }\n    }\n    \n    response = es.search(index=index_name, body=search_body)\n    print(f"\\n4. Full-text search \'wireless professional\': {response[\'hits\'][\'total\'][\'value\']} found")\n    for hit in response[\'hits\'][\'hits\']:\n        print(f"   - {hit[\'_source\'][\'product_name\']} (score: {hit[\'_score\']:.2f})")\n        if \'highlight\' in hit:\n            for field, highlights in hit[\'highlight\'].items():\n                print(f"     Highlight in {field}: {highlights[0]}")\n\nexcept Exception as e:\n    print(f"Error: {e}")\n'})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.code,{children:"Run the script:"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"python elasticsearch_test.py\n"})}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"access-kibana-dashboard",children:"Access Kibana Dashboard"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:["Open your browser and go to ",(0,t.jsx)(n.code,{children:"http://localhost:5601"})]}),"\n",(0,t.jsxs)(n.li,{children:["Go to ",(0,t.jsx)(n.strong,{children:"Management > Stack Management > Data View"})]}),"\n",(0,t.jsxs)(n.li,{children:["Create index pattern for your data (e.g., ",(0,t.jsx)(n.code,{children:"ecommerce*"}),")"]}),"\n",(0,t.jsxs)(n.li,{children:["Go to ",(0,t.jsx)(n.strong,{children:"Analytics > Discover"})," to explore your data"]}),"\n",(0,t.jsxs)(n.li,{children:["Create visualizations in ",(0,t.jsx)(n.strong,{children:"Analytics > Visualize"})]}),"\n",(0,t.jsxs)(n.li,{children:["Build dashboards in ",(0,t.jsx)(n.strong,{children:"Analytics > Dashboard"})]}),"\n"]}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"log-processing-with-logstash",children:"Log Processing with Logstash"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.code,{children:"Create a sample log file:"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:'echo "2024-01-15 10:30:00 INFO User login successful for user@example.com" >> logs/app.log\necho "2024-01-15 10:31:15 ERROR Database connection failed" >> logs/app.log\necho "2024-01-15 10:32:30 WARN High memory usage detected: 85%" >> logs/app.log\n'})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.code,{children:"Check if logs are processed:"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:'curl -X GET "localhost:9200/logs-*/_search" | jq .\n'})}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"common-use-cases",children:"Common Use Cases"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Log Analysis"}),": Application logs, system logs, security logs"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Full-Text Search"}),": Document search, product catalogs, knowledge bases"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Real-time Analytics"}),": User behavior, business metrics, performance monitoring"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Security Analytics"}),": Threat detection, compliance monitoring"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Business Intelligence"}),": Sales analytics, customer insights, operational metrics"]}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"\u2705 Elastic Stack is now running in Docker and ready for your search and analytics needs!## Referen\nces"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"https://docs.trychroma.com",children:"ChromaDB"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"https://www.sbert.net/",children:"SentenceTransformers"})}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(d,{...e})}):d(e)}},8453:(e,n,s)=>{s.d(n,{R:()=>c,x:()=>r});var a=s(6540);const t={},i=a.createContext(t);function c(e){const n=a.useContext(i);return a.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:c(e.components),a.createElement(i.Provider,{value:n},e.children)}}}]);