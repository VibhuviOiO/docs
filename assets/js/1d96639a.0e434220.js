"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[1058],{3559:(n,e,a)=>{a.r(e),a.d(e,{assets:()=>l,contentTitle:()=>o,default:()=>d,frontMatter:()=>i,metadata:()=>s,toc:()=>p});const s=JSON.parse('{"id":"Infrastructure/ansible","title":"Ansible","description":"Ansible is an open-source automation tool for configuration management, application deployment, and task automation. Learn how to use Ansible with Docker for infrastructure automation.","source":"@site/docs/Infrastructure/ansible.md","sourceDirName":"Infrastructure","slug":"/Infrastructure/Ansible","permalink":"/docs/docs/Infrastructure/Ansible","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/Infrastructure/ansible.md","tags":[],"version":"current","sidebarPosition":6,"frontMatter":{"sidebar_position":6,"title":"Ansible","description":"Ansible is an open-source automation tool for configuration management, application deployment, and task automation. Learn how to use Ansible with Docker for infrastructure automation.","slug":"/Infrastructure/Ansible","keywords":["Ansible","configuration management","automation","infrastructure automation","deployment automation","DevOps automation","playbooks","infrastructure as code","server configuration","application deployment"]},"sidebar":"tutorialSidebar","previous":{"title":"Terraform","permalink":"/docs/docs/Infrastructure/Terraform"},"next":{"title":"HashiCorp Packer","permalink":"/docs/docs/Infrastructure/Packer"}}');var t=a(4848),r=a(8453);const i={sidebar_position:6,title:"Ansible",description:"Ansible is an open-source automation tool for configuration management, application deployment, and task automation. Learn how to use Ansible with Docker for infrastructure automation.",slug:"/Infrastructure/Ansible",keywords:["Ansible","configuration management","automation","infrastructure automation","deployment automation","DevOps automation","playbooks","infrastructure as code","server configuration","application deployment"]},o="\ud83e\udd16 Ansible - Simple, Powerful Automation",l={},p=[{value:"Set Up Ansible with Docker",id:"set-up-ansible-with-docker",level:2},{value:"Inventory Configuration",id:"inventory-configuration",level:2},{value:"Static Inventory",id:"static-inventory",level:3},{value:"Dynamic Inventory (AWS)",id:"dynamic-inventory-aws",level:3},{value:"Group Variables",id:"group-variables",level:3},{value:"Playbooks",id:"playbooks",level:2},{value:"Basic Server Setup Playbook",id:"basic-server-setup-playbook",level:3},{value:"Web Server Deployment Playbook",id:"web-server-deployment-playbook",level:3},{value:"Ansible Roles",id:"ansible-roles",level:2},{value:"Nginx Role Structure",id:"nginx-role-structure",level:3},{value:"Advanced Playbooks",id:"advanced-playbooks",level:2},{value:"Rolling Deployment with Health Checks",id:"rolling-deployment-with-health-checks",level:3},{value:"Infrastructure Provisioning",id:"infrastructure-provisioning",level:3},{value:"Ansible Vault for Secrets",id:"ansible-vault-for-secrets",level:2},{value:"Encrypting Sensitive Data",id:"encrypting-sensitive-data",level:3},{value:"CI/CD Integration",id:"cicd-integration",level:2},{value:"Jenkins Pipeline with Ansible",id:"jenkins-pipeline-with-ansible",level:3},{value:"Common Use Cases",id:"common-use-cases",level:2}];function c(n){const e={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.R)(),...n.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(e.header,{children:(0,t.jsx)(e.h1,{id:"-ansible---simple-powerful-automation",children:"\ud83e\udd16 Ansible - Simple, Powerful Automation"})}),"\n",(0,t.jsxs)(e.p,{children:[(0,t.jsx)(e.strong,{children:"Ansible"})," is an open-source automation tool that enables ",(0,t.jsx)(e.strong,{children:"configuration management"}),", ",(0,t.jsx)(e.strong,{children:"application deployment"}),", ",(0,t.jsx)(e.strong,{children:"task automation"}),", and ",(0,t.jsx)(e.strong,{children:"orchestration"}),". It uses simple, human-readable YAML syntax and requires no agents on target systems."]}),"\n",(0,t.jsx)(e.hr,{}),"\n",(0,t.jsx)(e.h2,{id:"set-up-ansible-with-docker",children:"Set Up Ansible with Docker"}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.code,{children:"Create a file named docker-compose.yml"})}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-yaml",children:'version: \'3.8\'\n\nservices:\n  ansible-control:\n    image: quay.io/ansible/ansible-runner:latest\n    container_name: ansible-control\n    working_dir: /ansible\n    volumes:\n      - ./ansible:/ansible\n      - ./inventory:/ansible/inventory\n      - ./playbooks:/ansible/playbooks\n      - ./roles:/ansible/roles\n      - ~/.ssh:/root/.ssh:ro\n    environment:\n      - ANSIBLE_HOST_KEY_CHECKING=False\n      - ANSIBLE_STDOUT_CALLBACK=yaml\n      - ANSIBLE_GATHERING=smart\n    command: ["sleep", "infinity"]\n    networks:\n      - ansible-network\n\n  # Target servers for testing\n  target-server-1:\n    image: ubuntu:20.04\n    container_name: target-server-1\n    command: >\n      bash -c "apt-get update && \n               apt-get install -y openssh-server python3 sudo &&\n               mkdir -p /var/run/sshd &&\n               echo \'root:password\' | chpasswd &&\n               sed -i \'s/#PermitRootLogin prohibit-password/PermitRootLogin yes/\' /etc/ssh/sshd_config &&\n               /usr/sbin/sshd -D"\n    ports:\n      - "2222:22"\n    networks:\n      - ansible-network\n\n  target-server-2:\n    image: ubuntu:20.04\n    container_name: target-server-2\n    command: >\n      bash -c "apt-get update && \n               apt-get install -y openssh-server python3 sudo &&\n               mkdir -p /var/run/sshd &&\n               echo \'root:password\' | chpasswd &&\n               sed -i \'s/#PermitRootLogin prohibit-password/PermitRootLogin yes/\' /etc/ssh/sshd_config &&\n               /usr/sbin/sshd -D"\n    ports:\n      - "2223:22"\n    networks:\n      - ansible-network\n\nnetworks:\n  ansible-network:\n    driver: bridge\n'})}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.code,{children:"Start Ansible environment:"})}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-bash",children:"docker compose up -d\n"})}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.code,{children:"Execute Ansible commands:"})}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-bash",children:"# Access Ansible control node\ndocker compose exec ansible-control bash\n\n# Run ad-hoc commands\nansible all -i inventory/hosts -m ping\nansible all -i inventory/hosts -m setup\n"})}),"\n",(0,t.jsx)(e.hr,{}),"\n",(0,t.jsx)(e.h2,{id:"inventory-configuration",children:"Inventory Configuration"}),"\n",(0,t.jsx)(e.h3,{id:"static-inventory",children:"Static Inventory"}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.code,{children:"Create inventory/hosts:"})}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-ini",children:"[webservers]\nweb1 ansible_host=target-server-1 ansible_port=22 ansible_user=root\nweb2 ansible_host=target-server-2 ansible_port=22 ansible_user=root\n\n[databases]\ndb1 ansible_host=192.168.1.10 ansible_user=ubuntu ansible_ssh_private_key_file=~/.ssh/id_rsa\n\n[loadbalancers]\nlb1 ansible_host=192.168.1.20 ansible_user=centos\n\n[production:children]\nwebservers\ndatabases\nloadbalancers\n\n[production:vars]\nansible_python_interpreter=/usr/bin/python3\nenvironment=production\n"})}),"\n",(0,t.jsx)(e.h3,{id:"dynamic-inventory-aws",children:"Dynamic Inventory (AWS)"}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.code,{children:"Create inventory/aws_ec2.yml:"})}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-yaml",children:"plugin: amazon.aws.aws_ec2\nregions:\n  - us-east-1\n  - us-west-2\nkeyed_groups:\n  - key: tags\n    prefix: tag\n  - key: instance_type\n    prefix: instance_type\n  - key: placement.region\n    prefix: aws_region\nfilters:\n  instance-state-name: running\nhostnames:\n  - dns-name\n  - private-ip-address\ncompose:\n  ansible_host: public_dns_name\n"})}),"\n",(0,t.jsx)(e.h3,{id:"group-variables",children:"Group Variables"}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.code,{children:"Create inventory/group_vars/webservers.yml:"})}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-yaml",children:'# Web server specific variables\nnginx_version: "1.20"\ndocument_root: "/var/www/html"\nssl_enabled: true\nssl_cert_path: "/etc/ssl/certs/server.crt"\nssl_key_path: "/etc/ssl/private/server.key"\n\n# Application configuration\napp_name: "mywebapp"\napp_version: "1.2.3"\napp_port: 8080\napp_user: "webapp"\napp_group: "webapp"\n\n# Database connection\ndb_host: "{{ hostvars[groups[\'databases\'][0]][\'ansible_default_ipv4\'][\'address\'] }}"\ndb_name: "webapp_db"\ndb_user: "webapp_user"\ndb_password: "{{ vault_db_password }}"\n'})}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.code,{children:"Create inventory/group_vars/all.yml:"})}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-yaml",children:'# Global variables\ntimezone: "UTC"\nntp_servers:\n  - "0.pool.ntp.org"\n  - "1.pool.ntp.org"\n\n# Security settings\nssh_port: 22\nallowed_ssh_users:\n  - "admin"\n  - "deploy"\n\n# Monitoring\nmonitoring_enabled: true\nlog_level: "info"\n\n# Package management\npackage_update: true\nsecurity_updates_only: false\n'})}),"\n",(0,t.jsx)(e.hr,{}),"\n",(0,t.jsx)(e.h2,{id:"playbooks",children:"Playbooks"}),"\n",(0,t.jsx)(e.h3,{id:"basic-server-setup-playbook",children:"Basic Server Setup Playbook"}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.code,{children:"Create playbooks/server-setup.yml:"})}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-yaml",children:"---\n- name: Basic Server Setup\n  hosts: all\n  become: yes\n  gather_facts: yes\n  \n  vars:\n    required_packages:\n      - curl\n      - wget\n      - git\n      - htop\n      - vim\n      - unzip\n      - software-properties-common\n    \n  tasks:\n    - name: Update package cache\n      apt:\n        update_cache: yes\n        cache_valid_time: 3600\n      when: ansible_os_family == \"Debian\"\n    \n    - name: Install required packages\n      package:\n        name: \"{{ required_packages }}\"\n        state: present\n    \n    - name: Create admin user\n      user:\n        name: admin\n        groups: sudo\n        shell: /bin/bash\n        create_home: yes\n        state: present\n    \n    - name: Set up SSH key for admin user\n      authorized_key:\n        user: admin\n        key: \"{{ lookup('file', '~/.ssh/id_rsa.pub') }}\"\n        state: present\n    \n    - name: Configure SSH security\n      lineinfile:\n        path: /etc/ssh/sshd_config\n        regexp: \"{{ item.regexp }}\"\n        line: \"{{ item.line }}\"\n        backup: yes\n      loop:\n        - { regexp: '^#?PermitRootLogin', line: 'PermitRootLogin no' }\n        - { regexp: '^#?PasswordAuthentication', line: 'PasswordAuthentication no' }\n        - { regexp: '^#?Port', line: 'Port {{ ssh_port }}' }\n      notify: restart ssh\n    \n    - name: Configure firewall\n      ufw:\n        rule: allow\n        port: \"{{ ssh_port }}\"\n        proto: tcp\n    \n    - name: Enable firewall\n      ufw:\n        state: enabled\n        policy: deny\n        direction: incoming\n    \n    - name: Set timezone\n      timezone:\n        name: \"{{ timezone }}\"\n    \n    - name: Install and configure NTP\n      package:\n        name: ntp\n        state: present\n    \n    - name: Configure NTP servers\n      template:\n        src: ntp.conf.j2\n        dest: /etc/ntp.conf\n        backup: yes\n      notify: restart ntp\n  \n  handlers:\n    - name: restart ssh\n      service:\n        name: ssh\n        state: restarted\n    \n    - name: restart ntp\n      service:\n        name: ntp\n        state: restarted\n"})}),"\n",(0,t.jsx)(e.h3,{id:"web-server-deployment-playbook",children:"Web Server Deployment Playbook"}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.code,{children:"Create playbooks/deploy-webapp.yml:"})}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-yaml",children:'---\n- name: Deploy Web Application\n  hosts: webservers\n  become: yes\n  serial: 1  # Deploy one server at a time\n  \n  vars:\n    app_dir: "/opt/{{ app_name }}"\n    backup_dir: "/opt/backups"\n    \n  pre_tasks:\n    - name: Check if application is running\n      uri:\n        url: "http://{{ ansible_default_ipv4.address }}:{{ app_port }}/health"\n        method: GET\n        status_code: 200\n      register: app_health\n      ignore_errors: yes\n      \n  tasks:\n    - name: Create application user\n      user:\n        name: "{{ app_user }}"\n        group: "{{ app_group }}"\n        system: yes\n        shell: /bin/false\n        home: "{{ app_dir }}"\n        create_home: no\n    \n    - name: Create application directories\n      file:\n        path: "{{ item }}"\n        state: directory\n        owner: "{{ app_user }}"\n        group: "{{ app_group }}"\n        mode: \'0755\'\n      loop:\n        - "{{ app_dir }}"\n        - "{{ app_dir }}/releases"\n        - "{{ app_dir }}/shared"\n        - "{{ backup_dir }}"\n    \n    - name: Create backup of current release\n      archive:\n        path: "{{ app_dir }}/current"\n        dest: "{{ backup_dir }}/{{ app_name }}-{{ ansible_date_time.epoch }}.tar.gz"\n      when: app_health.status == 200\n      ignore_errors: yes\n    \n    - name: Download application artifact\n      get_url:\n        url: "https://releases.example.com/{{ app_name }}/{{ app_version }}/{{ app_name }}-{{ app_version }}.tar.gz"\n        dest: "/tmp/{{ app_name }}-{{ app_version }}.tar.gz"\n        mode: \'0644\'\n    \n    - name: Extract application\n      unarchive:\n        src: "/tmp/{{ app_name }}-{{ app_version }}.tar.gz"\n        dest: "{{ app_dir }}/releases"\n        remote_src: yes\n        owner: "{{ app_user }}"\n        group: "{{ app_group }}"\n        creates: "{{ app_dir }}/releases/{{ app_version }}"\n    \n    - name: Install application dependencies\n      pip:\n        requirements: "{{ app_dir }}/releases/{{ app_version }}/requirements.txt"\n        virtualenv: "{{ app_dir }}/releases/{{ app_version }}/venv"\n        virtualenv_python: python3\n      become_user: "{{ app_user }}"\n    \n    - name: Create application configuration\n      template:\n        src: app_config.j2\n        dest: "{{ app_dir }}/releases/{{ app_version }}/config.py"\n        owner: "{{ app_user }}"\n        group: "{{ app_group }}"\n        mode: \'0640\'\n    \n    - name: Create systemd service file\n      template:\n        src: webapp.service.j2\n        dest: "/etc/systemd/system/{{ app_name }}.service"\n        mode: \'0644\'\n      notify:\n        - reload systemd\n        - restart webapp\n    \n    - name: Update current symlink\n      file:\n        src: "{{ app_dir }}/releases/{{ app_version }}"\n        dest: "{{ app_dir }}/current"\n        state: link\n        owner: "{{ app_user }}"\n        group: "{{ app_group }}"\n      notify: restart webapp\n    \n    - name: Start and enable application service\n      systemd:\n        name: "{{ app_name }}"\n        state: started\n        enabled: yes\n        daemon_reload: yes\n    \n    - name: Wait for application to start\n      uri:\n        url: "http://{{ ansible_default_ipv4.address }}:{{ app_port }}/health"\n        method: GET\n        status_code: 200\n      retries: 30\n      delay: 2\n    \n    - name: Clean up old releases\n      shell: |\n        cd {{ app_dir }}/releases\n        ls -t | tail -n +4 | xargs rm -rf\n      args:\n        executable: /bin/bash\n  \n  handlers:\n    - name: reload systemd\n      systemd:\n        daemon_reload: yes\n    \n    - name: restart webapp\n      systemd:\n        name: "{{ app_name }}"\n        state: restarted\n'})}),"\n",(0,t.jsx)(e.hr,{}),"\n",(0,t.jsx)(e.h2,{id:"ansible-roles",children:"Ansible Roles"}),"\n",(0,t.jsx)(e.h3,{id:"nginx-role-structure",children:"Nginx Role Structure"}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.code,{children:"Create roles/nginx/tasks/main.yml:"})}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-yaml",children:'---\n- name: Install Nginx\n  package:\n    name: nginx\n    state: present\n\n- name: Create Nginx directories\n  file:\n    path: "{{ item }}"\n    state: directory\n    mode: \'0755\'\n  loop:\n    - /etc/nginx/sites-available\n    - /etc/nginx/sites-enabled\n    - /var/log/nginx\n\n- name: Configure Nginx main config\n  template:\n    src: nginx.conf.j2\n    dest: /etc/nginx/nginx.conf\n    backup: yes\n  notify: restart nginx\n\n- name: Configure virtual hosts\n  template:\n    src: vhost.conf.j2\n    dest: "/etc/nginx/sites-available/{{ item.name }}"\n  loop: "{{ nginx_vhosts }}"\n  notify: restart nginx\n\n- name: Enable virtual hosts\n  file:\n    src: "/etc/nginx/sites-available/{{ item.name }}"\n    dest: "/etc/nginx/sites-enabled/{{ item.name }}"\n    state: link\n  loop: "{{ nginx_vhosts }}"\n  notify: restart nginx\n\n- name: Remove default site\n  file:\n    path: /etc/nginx/sites-enabled/default\n    state: absent\n  notify: restart nginx\n\n- name: Start and enable Nginx\n  systemd:\n    name: nginx\n    state: started\n    enabled: yes\n'})}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.code,{children:"Create roles/nginx/handlers/main.yml:"})}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-yaml",children:"---\n- name: restart nginx\n  systemd:\n    name: nginx\n    state: restarted\n\n- name: reload nginx\n  systemd:\n    name: nginx\n    state: reloaded\n"})}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.code,{children:"Create roles/nginx/templates/nginx.conf.j2:"})}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-nginx",children:'user www-data;\nworker_processes auto;\npid /run/nginx.pid;\n\nevents {\n    worker_connections {{ nginx_worker_connections | default(1024) }};\n    use epoll;\n    multi_accept on;\n}\n\nhttp {\n    sendfile on;\n    tcp_nopush on;\n    tcp_nodelay on;\n    keepalive_timeout {{ nginx_keepalive_timeout | default(65) }};\n    types_hash_max_size 2048;\n    server_tokens off;\n\n    include /etc/nginx/mime.types;\n    default_type application/octet-stream;\n\n    # Logging\n    log_format main \'$remote_addr - $remote_user [$time_local] "$request" \'\n                    \'$status $body_bytes_sent "$http_referer" \'\n                    \'"$http_user_agent" "$http_x_forwarded_for"\';\n\n    access_log /var/log/nginx/access.log main;\n    error_log /var/log/nginx/error.log;\n\n    # Gzip compression\n    gzip on;\n    gzip_vary on;\n    gzip_proxied any;\n    gzip_comp_level 6;\n    gzip_types\n        text/plain\n        text/css\n        text/xml\n        text/javascript\n        application/json\n        application/javascript\n        application/xml+rss\n        application/atom+xml\n        image/svg+xml;\n\n    # Include virtual host configs\n    include /etc/nginx/sites-enabled/*;\n}\n'})}),"\n",(0,t.jsx)(e.hr,{}),"\n",(0,t.jsx)(e.h2,{id:"advanced-playbooks",children:"Advanced Playbooks"}),"\n",(0,t.jsx)(e.h3,{id:"rolling-deployment-with-health-checks",children:"Rolling Deployment with Health Checks"}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.code,{children:"Create playbooks/rolling-deployment.yml:"})}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-yaml",children:'---\n- name: Rolling Deployment with Health Checks\n  hosts: webservers\n  become: yes\n  serial: "{{ batch_size | default(\'25%\') }}"\n  max_fail_percentage: 10\n  \n  vars:\n    health_check_url: "http://{{ ansible_default_ipv4.address }}:{{ app_port }}/health"\n    deployment_timeout: 300\n    \n  pre_tasks:\n    - name: Remove server from load balancer\n      uri:\n        url: "http://{{ load_balancer_host }}/api/servers/{{ inventory_hostname }}/disable"\n        method: POST\n        headers:\n          Authorization: "Bearer {{ lb_api_token }}"\n      delegate_to: localhost\n      when: load_balancer_host is defined\n    \n    - name: Wait for connections to drain\n      wait_for:\n        timeout: 30\n      when: load_balancer_host is defined\n  \n  tasks:\n    - name: Stop application service\n      systemd:\n        name: "{{ app_name }}"\n        state: stopped\n    \n    - name: Deploy new version\n      include_tasks: tasks/deploy-app.yml\n    \n    - name: Start application service\n      systemd:\n        name: "{{ app_name }}"\n        state: started\n    \n    - name: Wait for application to be healthy\n      uri:\n        url: "{{ health_check_url }}"\n        method: GET\n        status_code: 200\n      register: health_check\n      retries: "{{ (deployment_timeout / 5) | int }}"\n      delay: 5\n      until: health_check.status == 200\n  \n  post_tasks:\n    - name: Add server back to load balancer\n      uri:\n        url: "http://{{ load_balancer_host }}/api/servers/{{ inventory_hostname }}/enable"\n        method: POST\n        headers:\n          Authorization: "Bearer {{ lb_api_token }}"\n      delegate_to: localhost\n      when: load_balancer_host is defined\n    \n    - name: Verify server is receiving traffic\n      uri:\n        url: "{{ health_check_url }}"\n        method: GET\n        status_code: 200\n      retries: 10\n      delay: 3\n'})}),"\n",(0,t.jsx)(e.h3,{id:"infrastructure-provisioning",children:"Infrastructure Provisioning"}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.code,{children:"Create playbooks/provision-infrastructure.yml:"})}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-yaml",children:'---\n- name: Provision AWS Infrastructure\n  hosts: localhost\n  gather_facts: no\n  \n  vars:\n    aws_region: us-west-2\n    vpc_cidr: "10.0.0.0/16"\n    \n  tasks:\n    - name: Create VPC\n      amazon.aws.ec2_vpc_net:\n        name: "{{ project_name }}-vpc"\n        cidr_block: "{{ vpc_cidr }}"\n        region: "{{ aws_region }}"\n        tags:\n          Environment: "{{ environment }}"\n        state: present\n      register: vpc\n    \n    - name: Create public subnet\n      amazon.aws.ec2_vpc_subnet:\n        vpc_id: "{{ vpc.vpc.id }}"\n        cidr: "10.0.1.0/24"\n        region: "{{ aws_region }}"\n        az: "{{ aws_region }}a"\n        tags:\n          Name: "{{ project_name }}-public-subnet"\n          Type: "Public"\n        state: present\n      register: public_subnet\n    \n    - name: Create security group\n      amazon.aws.ec2_group:\n        name: "{{ project_name }}-web-sg"\n        description: "Security group for web servers"\n        vpc_id: "{{ vpc.vpc.id }}"\n        region: "{{ aws_region }}"\n        rules:\n          - proto: tcp\n            ports:\n              - 80\n              - 443\n            cidr_ip: 0.0.0.0/0\n          - proto: tcp\n            ports:\n              - 22\n            cidr_ip: "{{ admin_cidr }}"\n        tags:\n          Environment: "{{ environment }}"\n      register: security_group\n    \n    - name: Launch EC2 instances\n      amazon.aws.ec2_instance:\n        name: "{{ project_name }}-web-{{ item }}"\n        image_id: "{{ ami_id }}"\n        instance_type: "{{ instance_type }}"\n        key_name: "{{ key_pair_name }}"\n        vpc_subnet_id: "{{ public_subnet.subnet.id }}"\n        security_groups:\n          - "{{ security_group.group_id }}"\n        region: "{{ aws_region }}"\n        tags:\n          Environment: "{{ environment }}"\n          Role: "webserver"\n        state: present\n        wait: yes\n      loop: "{{ range(1, web_server_count + 1) | list }}"\n      register: ec2_instances\n    \n    - name: Add instances to inventory\n      add_host:\n        name: "{{ item.instances[0].public_dns_name }}"\n        groups: webservers\n        ansible_host: "{{ item.instances[0].public_ip_address }}"\n        ansible_user: ubuntu\n        ansible_ssh_private_key_file: "{{ key_file_path }}"\n      loop: "{{ ec2_instances.results }}"\n'})}),"\n",(0,t.jsx)(e.hr,{}),"\n",(0,t.jsx)(e.h2,{id:"ansible-vault-for-secrets",children:"Ansible Vault for Secrets"}),"\n",(0,t.jsx)(e.h3,{id:"encrypting-sensitive-data",children:"Encrypting Sensitive Data"}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.code,{children:"Create encrypted variables:"})}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-bash",children:"# Create encrypted file\nansible-vault create group_vars/production/vault.yml\n\n# Edit encrypted file\nansible-vault edit group_vars/production/vault.yml\n\n# Encrypt existing file\nansible-vault encrypt secrets.yml\n\n# Decrypt file\nansible-vault decrypt secrets.yml\n"})}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.code,{children:"Example vault.yml content:"})}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-yaml",children:'vault_db_password: "super_secret_password"\nvault_api_key: "secret_api_key_here"\nvault_ssl_private_key: |\n  -----BEGIN PRIVATE KEY-----\n  MIIEvQIBADANBgkqhkiG9w0BAQEFAASCBKcwggSjAgEAAoIBAQC...\n  -----END PRIVATE KEY-----\n'})}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.code,{children:"Use vault variables in playbooks:"})}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-yaml",children:"- name: Configure database connection\n  template:\n    src: database.conf.j2\n    dest: /etc/app/database.conf\n    mode: '0600'\n  vars:\n    db_password: \"{{ vault_db_password }}\"\n"})}),"\n",(0,t.jsx)(e.hr,{}),"\n",(0,t.jsx)(e.h2,{id:"cicd-integration",children:"CI/CD Integration"}),"\n",(0,t.jsx)(e.h3,{id:"jenkins-pipeline-with-ansible",children:"Jenkins Pipeline with Ansible"}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.code,{children:"Create Jenkinsfile:"})}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-groovy",children:"pipeline {\n    agent any\n    \n    environment {\n        ANSIBLE_HOST_KEY_CHECKING = 'False'\n        VAULT_PASSWORD_FILE = credentials('ansible-vault-password')\n    }\n    \n    stages {\n        stage('Checkout') {\n            steps {\n                checkout scm\n            }\n        }\n        \n        stage('Lint Playbooks') {\n            steps {\n                sh 'ansible-lint playbooks/'\n            }\n        }\n        \n        stage('Test Syntax') {\n            steps {\n                sh 'ansible-playbook --syntax-check playbooks/deploy-webapp.yml'\n            }\n        }\n        \n        stage('Deploy to Staging') {\n            steps {\n                sh '''\n                    ansible-playbook -i inventory/staging \\\n                        --vault-password-file $VAULT_PASSWORD_FILE \\\n                        playbooks/deploy-webapp.yml \\\n                        --extra-vars \"app_version=${BUILD_NUMBER}\"\n                '''\n            }\n        }\n        \n        stage('Run Tests') {\n            steps {\n                sh 'ansible-playbook -i inventory/staging playbooks/run-tests.yml'\n            }\n        }\n        \n        stage('Deploy to Production') {\n            when {\n                branch 'main'\n            }\n            steps {\n                input message: 'Deploy to production?', ok: 'Deploy'\n                sh '''\n                    ansible-playbook -i inventory/production \\\n                        --vault-password-file $VAULT_PASSWORD_FILE \\\n                        playbooks/rolling-deployment.yml \\\n                        --extra-vars \"app_version=${BUILD_NUMBER}\"\n                '''\n            }\n        }\n    }\n    \n    post {\n        always {\n            archiveArtifacts artifacts: 'logs/*.log', allowEmptyArchive: true\n        }\n        failure {\n            emailext (\n                subject: \"Deployment Failed: ${env.JOB_NAME} - ${env.BUILD_NUMBER}\",\n                body: \"Deployment failed. Check console output for details.\",\n                to: \"${env.CHANGE_AUTHOR_EMAIL}\"\n            )\n        }\n    }\n}\n"})}),"\n",(0,t.jsx)(e.hr,{}),"\n",(0,t.jsx)(e.h2,{id:"common-use-cases",children:"Common Use Cases"}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.strong,{children:"Configuration Management"}),": Server configuration, package management, service configuration"]}),"\n",(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.strong,{children:"Application Deployment"}),": Zero-downtime deployments, rolling updates, blue-green deployments"]}),"\n",(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.strong,{children:"Infrastructure Provisioning"}),": Cloud resource creation, network configuration"]}),"\n",(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.strong,{children:"Security Hardening"}),": System security configuration, compliance enforcement"]}),"\n",(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.strong,{children:"Orchestration"}),": Multi-tier application deployments, complex workflows"]}),"\n"]}),"\n",(0,t.jsx)(e.p,{children:"\u2705 Ansible is now configured for comprehensive automation and configuration management!"})]})}function d(n={}){const{wrapper:e}={...(0,r.R)(),...n.components};return e?(0,t.jsx)(e,{...n,children:(0,t.jsx)(c,{...n})}):c(n)}},8453:(n,e,a)=>{a.d(e,{R:()=>i,x:()=>o});var s=a(6540);const t={},r=s.createContext(t);function i(n){const e=s.useContext(r);return s.useMemo((function(){return"function"==typeof n?n(e):{...e,...n}}),[e,n])}function o(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(t):n.components||t:i(n.components),s.createElement(r.Provider,{value:e},n.children)}}}]);