"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[2477],{2997:(n,e,t)=>{t.r(e),t.d(e,{assets:()=>l,contentTitle:()=>o,default:()=>u,frontMatter:()=>a,metadata:()=>s,toc:()=>d});const s=JSON.parse('{"id":"Testing-Scanning/SAST/bandit","title":"\ud83d\udd12 Bandit - Python Security Linter","description":"Bandit is a tool designed to find common security issues in Python code. It processes each file, builds an AST from it, and runs appropriate plugins against the AST nodes. Once Bandit has finished scanning all the files, it generates a report.","source":"@site/docs/Testing-Scanning/SAST/bandit.md","sourceDirName":"Testing-Scanning/SAST","slug":"/Testing-Scanning/SAST/bandit","permalink":"/docs/Testing-Scanning/SAST/bandit","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/Testing-Scanning/SAST/bandit.md","tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"CodeQL","permalink":"/docs/TestingScanning/CodeQL"},"next":{"title":"SCA (Software Composition Analysis)","permalink":"/docs/category/sca-software-composition-analysis"}}');var i=t(4848),r=t(8453);const a={},o="\ud83d\udd12 Bandit - Python Security Linter",l={},d=[{value:"\ud83d\udccb Prerequisites",id:"-prerequisites",level:2},{value:"\ud83d\udee0\ufe0f Installation",id:"\ufe0f-installation",level:2},{value:"Basic Installation",id:"basic-installation",level:3},{value:"Virtual Environment Setup",id:"virtual-environment-setup",level:3},{value:"\ud83d\ude80 Quick Start",id:"-quick-start",level:2},{value:"Basic Usage",id:"basic-usage",level:3},{value:"Example Vulnerable Code",id:"example-vulnerable-code",level:3},{value:"Run Bandit on Example",id:"run-bandit-on-example",level:3},{value:"\ud83d\udd27 Configuration",id:"-configuration",level:2},{value:"Configuration File (.bandit)",id:"configuration-file-bandit",level:3},{value:"TOML Configuration (pyproject.toml)",id:"toml-configuration-pyprojecttoml",level:3},{value:"YAML Configuration (bandit.yaml)",id:"yaml-configuration-bandityaml",level:3},{value:"\ud83c\udfaf Advanced Usage",id:"-advanced-usage",level:2},{value:"Command Line Options",id:"command-line-options",level:3},{value:"Custom Test Development",id:"custom-test-development",level:3},{value:"Integration with Pre-commit",id:"integration-with-pre-commit",level:3},{value:"\ud83d\udc33 Docker Integration",id:"-docker-integration",level:2},{value:"Dockerfile for Bandit",id:"dockerfile-for-bandit",level:3},{value:"Docker Compose for CI/CD",id:"docker-compose-for-cicd",level:3},{value:"\ud83d\udd04 CI/CD Integration",id:"-cicd-integration",level:2},{value:"GitHub Actions",id:"github-actions",level:3},{value:"Jenkins Pipeline",id:"jenkins-pipeline",level:3},{value:"GitLab CI",id:"gitlab-ci",level:3},{value:"\ud83d\udcca Reporting and Analysis",id:"-reporting-and-analysis",level:2},{value:"Custom Report Generator",id:"custom-report-generator",level:3},{value:"Usage",id:"usage",level:3},{value:"\ud83d\udd27 Custom Plugins",id:"-custom-plugins",level:2},{value:"Creating Custom Bandit Plugin",id:"creating-custom-bandit-plugin",level:3},{value:"Plugin Configuration",id:"plugin-configuration",level:3},{value:"\ud83d\udd0d Troubleshooting",id:"-troubleshooting",level:2},{value:"Common Issues and Solutions",id:"common-issues-and-solutions",level:3},{value:"Debug Mode",id:"debug-mode",level:3},{value:"\ud83d\udcc8 Best Practices",id:"-best-practices",level:2},{value:"Security-First Development",id:"security-first-development",level:3},{value:"Integration Strategy",id:"integration-strategy",level:3},{value:"\ud83d\udcda Additional Resources",id:"-additional-resources",level:2}];function c(n){const e={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.R)(),...n.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(e.header,{children:(0,i.jsx)(e.h1,{id:"-bandit---python-security-linter",children:"\ud83d\udd12 Bandit - Python Security Linter"})}),"\n",(0,i.jsx)(e.p,{children:"Bandit is a tool designed to find common security issues in Python code. It processes each file, builds an AST from it, and runs appropriate plugins against the AST nodes. Once Bandit has finished scanning all the files, it generates a report."}),"\n",(0,i.jsx)(e.h2,{id:"-prerequisites",children:"\ud83d\udccb Prerequisites"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"Python 3.6+"}),"\n",(0,i.jsx)(e.li,{children:"pip package manager"}),"\n",(0,i.jsx)(e.li,{children:"Basic understanding of Python security concepts"}),"\n",(0,i.jsx)(e.li,{children:"Git (for repository scanning)"}),"\n"]}),"\n",(0,i.jsx)(e.h2,{id:"\ufe0f-installation",children:"\ud83d\udee0\ufe0f Installation"}),"\n",(0,i.jsx)(e.h3,{id:"basic-installation",children:"Basic Installation"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-bash",children:"# Install via pip\npip install bandit\n\n# Install with YAML support\npip install bandit[toml]\n\n# Install development version\npip install git+https://github.com/PyCQA/bandit.git\n\n# Verify installation\nbandit --version\n"})}),"\n",(0,i.jsx)(e.h3,{id:"virtual-environment-setup",children:"Virtual Environment Setup"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-bash",children:'# Create virtual environment\npython -m venv bandit-env\nsource bandit-env/bin/activate  # Linux/Mac\n# bandit-env\\Scripts\\activate  # Windows\n\n# Install bandit\npip install bandit\n\n# Create requirements file\necho "bandit>=1.7.5" > requirements-security.txt\npip install -r requirements-security.txt\n'})}),"\n",(0,i.jsx)(e.h2,{id:"-quick-start",children:"\ud83d\ude80 Quick Start"}),"\n",(0,i.jsx)(e.h3,{id:"basic-usage",children:"Basic Usage"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-bash",children:"# Scan a single file\nbandit example.py\n\n# Scan a directory\nbandit -r /path/to/your/code\n\n# Scan current directory\nbandit -r .\n\n# Scan with specific format\nbandit -r . -f json -o bandit-report.json\n"})}),"\n",(0,i.jsx)(e.h3,{id:"example-vulnerable-code",children:"Example Vulnerable Code"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-python",children:'# vulnerable_example.py\nimport os\nimport subprocess\nimport pickle\nimport yaml\n\n# B102: Test for use of exec\ndef dangerous_exec():\n    user_input = input("Enter code: ")\n    exec(user_input)  # Dangerous!\n\n# B601: Test for shell injection\ndef shell_injection():\n    filename = input("Enter filename: ")\n    os.system(f"cat {filename}")  # Dangerous!\n\n# B301: Test for pickle usage\ndef unsafe_pickle():\n    data = input("Enter pickled data: ")\n    pickle.loads(data)  # Dangerous!\n\n# B506: Test for yaml.load usage\ndef unsafe_yaml():\n    with open(\'config.yaml\') as f:\n        config = yaml.load(f)  # Should use safe_load\n\n# B108: Test for hardcoded tmp directory\ndef hardcoded_tmp():\n    temp_file = "/tmp/myfile.txt"  # Potentially dangerous\n    with open(temp_file, \'w\') as f:\n        f.write("data")\n\n# B105: Test for hardcoded password\ndef hardcoded_password():\n    password = "admin123"  # Dangerous!\n    return password\n\n# B324: Test for insecure hash function\nimport hashlib\ndef weak_hash():\n    data = "sensitive data"\n    return hashlib.md5(data.encode()).hexdigest()  # Weak hash\n\n# B113: Test for request without timeout\nimport requests\ndef no_timeout():\n    response = requests.get("http://example.com")  # Missing timeout\n    return response.text\n'})}),"\n",(0,i.jsx)(e.h3,{id:"run-bandit-on-example",children:"Run Bandit on Example"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-bash",children:"# Scan the vulnerable example\nbandit vulnerable_example.py\n\n# Output will show various security issues found\n"})}),"\n",(0,i.jsx)(e.h2,{id:"-configuration",children:"\ud83d\udd27 Configuration"}),"\n",(0,i.jsx)(e.h3,{id:"configuration-file-bandit",children:"Configuration File (.bandit)"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-yaml",children:"# .bandit\ntests: ['B201', 'B301']\nskips: ['B101', 'B601']\n\nexclude_dirs: ['*/tests/*', '*/venv/*']\n\n# Specify which files to scan\ninclude: ['*.py']\nexclude: ['*/migrations/*']\n\n# Confidence levels: LOW, MEDIUM, HIGH\nconfidence: MEDIUM\n\n# Severity levels: LOW, MEDIUM, HIGH  \nseverity: MEDIUM\n"})}),"\n",(0,i.jsx)(e.h3,{id:"toml-configuration-pyprojecttoml",children:"TOML Configuration (pyproject.toml)"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-toml",children:'# pyproject.toml\n[tool.bandit]\nexclude_dirs = ["tests", "venv", ".venv", "build", "dist"]\ntests = ["B201", "B301"]\nskips = ["B101", "B601"]\n\n[tool.bandit.assert_used]\nskips = [\'*_test.py\', \'*/test_*.py\']\n'})}),"\n",(0,i.jsx)(e.h3,{id:"yaml-configuration-bandityaml",children:"YAML Configuration (bandit.yaml)"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-yaml",children:"# bandit.yaml\ntests:\n  - B101  # assert_used\n  - B102  # exec_used\n  - B103  # set_bad_file_permissions\n  - B104  # hardcoded_bind_all_interfaces\n  - B105  # hardcoded_password_string\n  - B106  # hardcoded_password_funcarg\n  - B107  # hardcoded_password_default\n  - B108  # hardcoded_tmp_directory\n  - B110  # try_except_pass\n  - B112  # try_except_continue\n  - B201  # flask_debug_true\n  - B301  # pickle\n  - B302  # marshal\n  - B303  # md5\n  - B304  # des\n  - B305  # cipher\n  - B306  # mktemp_q\n  - B307  # eval\n  - B308  # mark_safe\n  - B309  # httpsconnection\n  - B310  # urllib_urlopen\n  - B311  # random\n  - B312  # telnetlib\n  - B313  # xml_bad_cElementTree\n  - B314  # xml_bad_ElementTree\n  - B315  # xml_bad_expatreader\n  - B316  # xml_bad_expatbuilder\n  - B317  # xml_bad_sax\n  - B318  # xml_bad_minidom\n  - B319  # xml_bad_pulldom\n  - B320  # xml_bad_etree\n  - B321  # ftplib\n  - B322  # input\n  - B323  # unverified_context\n  - B324  # hashlib_new_insecure_functions\n  - B325  # tempnam\n  - B401  # import_telnetlib\n  - B402  # import_ftplib\n  - B403  # import_pickle\n  - B404  # import_subprocess\n  - B405  # import_xml_etree\n  - B406  # import_xml_sax\n  - B407  # import_xml_expat\n  - B408  # import_xml_minidom\n  - B409  # import_xml_pulldom\n  - B410  # import_lxml\n  - B411  # import_xmlrpclib\n  - B412  # import_httpoxy\n  - B413  # import_pycrypto\n  - B501  # request_with_no_cert_validation\n  - B502  # ssl_with_bad_version\n  - B503  # ssl_with_bad_defaults\n  - B504  # ssl_with_no_version\n  - B505  # weak_cryptographic_key\n  - B506  # yaml_load\n  - B507  # ssh_no_host_key_verification\n  - B601  # paramiko_calls\n  - B602  # subprocess_popen_with_shell_equals_true\n  - B603  # subprocess_without_shell_equals_true\n  - B604  # any_other_function_with_shell_equals_true\n  - B605  # start_process_with_a_shell\n  - B606  # start_process_with_no_shell\n  - B607  # start_process_with_partial_path\n  - B608  # hardcoded_sql_expressions\n  - B609  # linux_commands_wildcard_injection\n  - B610  # django_extra_used\n  - B611  # django_rawsql_used\n  - B701  # jinja2_autoescape_false\n  - B702  # use_of_mako_templates\n  - B703  # django_mark_safe\n\nskips: []\n\nexclude_dirs:\n  - '/tests/'\n  - '/test_'\n  - '/venv/'\n  - '/.venv/'\n  - '/build/'\n  - '/dist/'\n"})}),"\n",(0,i.jsx)(e.h2,{id:"-advanced-usage",children:"\ud83c\udfaf Advanced Usage"}),"\n",(0,i.jsx)(e.h3,{id:"command-line-options",children:"Command Line Options"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-bash",children:"# Specify confidence level\nbandit -r . -i  # Show only high confidence issues\nbandit -r . -ii # Show medium and high confidence issues\nbandit -r . -iii # Show all confidence levels\n\n# Specify severity level\nbandit -r . -l  # Show only high severity issues\nbandit -r . -ll # Show medium and high severity issues\nbandit -r . -lll # Show all severity levels\n\n# Skip specific tests\nbandit -r . -s B101,B601\n\n# Run only specific tests\nbandit -r . -t B201,B301\n\n# Exclude directories\nbandit -r . -x tests/,venv/\n\n# Generate different output formats\nbandit -r . -f csv -o report.csv\nbandit -r . -f html -o report.html\nbandit -r . -f xml -o report.xml\nbandit -r . -f txt -o report.txt\n\n# Verbose output\nbandit -r . -v\n\n# Quiet mode (only show issues)\nbandit -r . -q\n"})}),"\n",(0,i.jsx)(e.h3,{id:"custom-test-development",children:"Custom Test Development"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-python",children:'# custom_bandit_test.py\nimport ast\nimport bandit\nfrom bandit.core import test_properties\n\n@test_properties.test_id(\'B999\')\n@test_properties.checks(\'Call\')\ndef check_custom_function(context):\n    """Check for usage of custom dangerous function"""\n    if context.call_function_name_qual == \'dangerous_function\':\n        return bandit.Issue(\n            severity=bandit.HIGH,\n            confidence=bandit.HIGH,\n            text="Use of dangerous_function detected",\n            lineno=context.node.lineno,\n        )\n'})}),"\n",(0,i.jsx)(e.h3,{id:"integration-with-pre-commit",children:"Integration with Pre-commit"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-yaml",children:"# .pre-commit-config.yaml\nrepos:\n  - repo: https://github.com/PyCQA/bandit\n    rev: '1.7.5'\n    hooks:\n      - id: bandit\n        args: ['-c', 'pyproject.toml']\n        additional_dependencies: [\"bandit[toml]\"]\n"})}),"\n",(0,i.jsx)(e.h2,{id:"-docker-integration",children:"\ud83d\udc33 Docker Integration"}),"\n",(0,i.jsx)(e.h3,{id:"dockerfile-for-bandit",children:"Dockerfile for Bandit"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-dockerfile",children:'# Dockerfile.bandit\nFROM python:3.11-slim\n\nWORKDIR /app\n\n# Install bandit\nRUN pip install bandit[toml]\n\n# Copy source code\nCOPY . .\n\n# Run bandit scan\nCMD ["bandit", "-r", ".", "-f", "json", "-o", "/app/bandit-report.json"]\n'})}),"\n",(0,i.jsx)(e.h3,{id:"docker-compose-for-cicd",children:"Docker Compose for CI/CD"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-yaml",children:"# docker-compose.security.yml\nversion: '3.8'\n\nservices:\n  bandit-scan:\n    build:\n      context: .\n      dockerfile: Dockerfile.bandit\n    volumes:\n      - .:/app\n      - ./reports:/app/reports\n    command: >\n      bandit -r /app \n      -f json \n      -o /app/reports/bandit-report.json\n      --exit-zero-on-skipped\n    environment:\n      - PYTHONPATH=/app\n\n  security-report:\n    image: python:3.11-slim\n    depends_on:\n      - bandit-scan\n    volumes:\n      - ./reports:/reports\n    command: >\n      python -c \"\n      import json\n      with open('/reports/bandit-report.json') as f:\n          data = json.load(f)\n          print(f'Security Issues Found: {len(data.get(\\\"results\\\", []))}')\n          for issue in data.get('results', []):\n              print(f'- {issue[\\\"test_name\\\"]}: {issue[\\\"issue_text\\\"]}')\n      \"\n"})}),"\n",(0,i.jsx)(e.h2,{id:"-cicd-integration",children:"\ud83d\udd04 CI/CD Integration"}),"\n",(0,i.jsx)(e.h3,{id:"github-actions",children:"GitHub Actions"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-yaml",children:"# .github/workflows/security.yml\nname: Security Scan\n\non:\n  push:\n    branches: [ main, develop ]\n  pull_request:\n    branches: [ main ]\n\njobs:\n  bandit-security-scan:\n    runs-on: ubuntu-latest\n    \n    steps:\n    - uses: actions/checkout@v4\n    \n    - name: Set up Python\n      uses: actions/setup-python@v4\n      with:\n        python-version: '3.11'\n    \n    - name: Install dependencies\n      run: |\n        python -m pip install --upgrade pip\n        pip install bandit[toml]\n    \n    - name: Run Bandit security scan\n      run: |\n        bandit -r . -f json -o bandit-report.json || true\n    \n    - name: Upload Bandit report\n      uses: actions/upload-artifact@v3\n      with:\n        name: bandit-report\n        path: bandit-report.json\n    \n    - name: Evaluate security issues\n      run: |\n        python -c \"\n        import json\n        import sys\n        \n        with open('bandit-report.json') as f:\n            data = json.load(f)\n        \n        high_issues = [r for r in data.get('results', []) if r['issue_severity'] == 'HIGH']\n        medium_issues = [r for r in data.get('results', []) if r['issue_severity'] == 'MEDIUM']\n        \n        print(f'High severity issues: {len(high_issues)}')\n        print(f'Medium severity issues: {len(medium_issues)}')\n        \n        if high_issues:\n            print('\u274c High severity security issues found!')\n            for issue in high_issues:\n                print(f'  - {issue[\\\"filename\\\"]}:{issue[\\\"line_number\\\"]} - {issue[\\\"issue_text\\\"]}')\n            sys.exit(1)\n        \n        if len(medium_issues) > 5:\n            print('\u26a0\ufe0f Too many medium severity issues found!')\n            sys.exit(1)\n        \n        print('\u2705 Security scan passed!')\n        \"\n    \n    - name: Comment PR with security results\n      if: github.event_name == 'pull_request'\n      uses: actions/github-script@v6\n      with:\n        script: |\n          const fs = require('fs');\n          const report = JSON.parse(fs.readFileSync('bandit-report.json', 'utf8'));\n          \n          const highIssues = report.results.filter(r => r.issue_severity === 'HIGH');\n          const mediumIssues = report.results.filter(r => r.issue_severity === 'MEDIUM');\n          \n          let comment = '## \ud83d\udd12 Bandit Security Scan Results\\n\\n';\n          comment += `- **High Severity**: ${highIssues.length}\\n`;\n          comment += `- **Medium Severity**: ${mediumIssues.length}\\n`;\n          comment += `- **Total Issues**: ${report.results.length}\\n\\n`;\n          \n          if (highIssues.length > 0) {\n            comment += '### \u274c High Severity Issues\\n';\n            highIssues.forEach(issue => {\n              comment += `- \\`${issue.filename}:${issue.line_number}\\` - ${issue.issue_text}\\n`;\n            });\n          }\n          \n          github.rest.issues.createComment({\n            issue_number: context.issue.number,\n            owner: context.repo.owner,\n            repo: context.repo.repo,\n            body: comment\n          });\n"})}),"\n",(0,i.jsx)(e.h3,{id:"jenkins-pipeline",children:"Jenkins Pipeline"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-groovy",children:"// Jenkinsfile\npipeline {\n    agent any\n    \n    environment {\n        PYTHONPATH = \"${WORKSPACE}\"\n    }\n    \n    stages {\n        stage('Checkout') {\n            steps {\n                checkout scm\n            }\n        }\n        \n        stage('Setup Python') {\n            steps {\n                sh '''\n                    python3 -m venv venv\n                    . venv/bin/activate\n                    pip install --upgrade pip\n                    pip install bandit[toml]\n                '''\n            }\n        }\n        \n        stage('Bandit Security Scan') {\n            steps {\n                sh '''\n                    . venv/bin/activate\n                    bandit -r . -f json -o bandit-report.json --exit-zero-on-skipped\n                '''\n            }\n            post {\n                always {\n                    archiveArtifacts artifacts: 'bandit-report.json', fingerprint: true\n                }\n            }\n        }\n        \n        stage('Evaluate Results') {\n            steps {\n                script {\n                    def report = readJSON file: 'bandit-report.json'\n                    def highIssues = report.results.findAll { it.issue_severity == 'HIGH' }\n                    def mediumIssues = report.results.findAll { it.issue_severity == 'MEDIUM' }\n                    \n                    echo \"High severity issues: ${highIssues.size()}\"\n                    echo \"Medium severity issues: ${mediumIssues.size()}\"\n                    \n                    if (highIssues.size() > 0) {\n                        currentBuild.result = 'FAILURE'\n                        error(\"High severity security issues found!\")\n                    }\n                    \n                    if (mediumIssues.size() > 10) {\n                        currentBuild.result = 'UNSTABLE'\n                        echo \"Warning: Many medium severity issues found\"\n                    }\n                }\n            }\n        }\n        \n        stage('Generate HTML Report') {\n            steps {\n                sh '''\n                    . venv/bin/activate\n                    bandit -r . -f html -o bandit-report.html\n                '''\n            }\n            post {\n                always {\n                    publishHTML([\n                        allowMissing: false,\n                        alwaysLinkToLastBuild: true,\n                        keepAll: true,\n                        reportDir: '.',\n                        reportFiles: 'bandit-report.html',\n                        reportName: 'Bandit Security Report'\n                    ])\n                }\n            }\n        }\n    }\n    \n    post {\n        always {\n            cleanWs()\n        }\n        \n        failure {\n            emailext(\n                subject: \"Security Scan Failed: ${env.JOB_NAME} - ${env.BUILD_NUMBER}\",\n                body: \"Security scan failed for ${env.JOB_NAME} build ${env.BUILD_NUMBER}. Check the Bandit report for details.\",\n                to: \"${env.CHANGE_AUTHOR_EMAIL}\"\n            )\n        }\n    }\n}\n"})}),"\n",(0,i.jsx)(e.h3,{id:"gitlab-ci",children:"GitLab CI"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-yaml",children:"# .gitlab-ci.yml\nstages:\n  - security\n\nbandit-sast:\n  stage: security\n  image: python:3.11-slim\n  before_script:\n    - pip install bandit[toml]\n  script:\n    - bandit -r . -f json -o bandit-report.json\n  artifacts:\n    reports:\n      sast: bandit-report.json\n    paths:\n      - bandit-report.json\n    expire_in: 1 week\n  allow_failure: true\n\nsecurity-gate:\n  stage: security\n  image: python:3.11-slim\n  dependencies:\n    - bandit-sast\n  script:\n    - |\n      python3 << EOF\n      import json\n      import sys\n      \n      with open('bandit-report.json') as f:\n          data = json.load(f)\n      \n      high_issues = [r for r in data.get('results', []) if r['issue_severity'] == 'HIGH']\n      \n      if high_issues:\n          print(f\"\u274c {len(high_issues)} high severity security issues found!\")\n          for issue in high_issues:\n              print(f\"  - {issue['filename']}:{issue['line_number']} - {issue['issue_text']}\")\n          sys.exit(1)\n      \n      print(\"\u2705 Security gate passed!\")\n      EOF\n  only:\n    - main\n    - develop\n"})}),"\n",(0,i.jsx)(e.h2,{id:"-reporting-and-analysis",children:"\ud83d\udcca Reporting and Analysis"}),"\n",(0,i.jsx)(e.h3,{id:"custom-report-generator",children:"Custom Report Generator"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-python",children:"#!/usr/bin/env python3\nimport json\nimport argparse\nfrom collections import defaultdict\nimport matplotlib.pyplot as plt\nimport pandas as pd\n\nclass BanditReportAnalyzer:\n    def __init__(self, report_file):\n        with open(report_file, 'r') as f:\n            self.report = json.load(f)\n    \n    def generate_summary(self):\n        \"\"\"Generate summary statistics\"\"\"\n        results = self.report.get('results', [])\n        \n        severity_counts = defaultdict(int)\n        confidence_counts = defaultdict(int)\n        test_counts = defaultdict(int)\n        \n        for result in results:\n            severity_counts[result['issue_severity']] += 1\n            confidence_counts[result['issue_confidence']] += 1\n            test_counts[result['test_name']] += 1\n        \n        print(\"=== Bandit Security Scan Summary ===\")\n        print(f\"Total Issues: {len(results)}\")\n        print(f\"Files Scanned: {len(self.report.get('metrics', {}).get('_totals', {}).get('loc', 0))}\")\n        print()\n        \n        print(\"Severity Breakdown:\")\n        for severity in ['HIGH', 'MEDIUM', 'LOW']:\n            count = severity_counts.get(severity, 0)\n            print(f\"  {severity}: {count}\")\n        print()\n        \n        print(\"Confidence Breakdown:\")\n        for confidence in ['HIGH', 'MEDIUM', 'LOW']:\n            count = confidence_counts.get(confidence, 0)\n            print(f\"  {confidence}: {count}\")\n        print()\n        \n        print(\"Top 10 Most Common Issues:\")\n        sorted_tests = sorted(test_counts.items(), key=lambda x: x[1], reverse=True)\n        for test_name, count in sorted_tests[:10]:\n            print(f\"  {test_name}: {count}\")\n    \n    def generate_detailed_report(self, output_file):\n        \"\"\"Generate detailed CSV report\"\"\"\n        results = self.report.get('results', [])\n        \n        data = []\n        for result in results:\n            data.append({\n                'filename': result['filename'],\n                'line_number': result['line_number'],\n                'test_name': result['test_name'],\n                'test_id': result['test_id'],\n                'issue_severity': result['issue_severity'],\n                'issue_confidence': result['issue_confidence'],\n                'issue_text': result['issue_text'],\n                'line_range': f\"{result['line_range'][0]}-{result['line_range'][1]}\",\n                'code': result['code'].strip()\n            })\n        \n        df = pd.DataFrame(data)\n        df.to_csv(output_file, index=False)\n        print(f\"Detailed report saved to: {output_file}\")\n    \n    def generate_charts(self, output_dir):\n        \"\"\"Generate visualization charts\"\"\"\n        results = self.report.get('results', [])\n        \n        # Severity distribution\n        severity_counts = defaultdict(int)\n        for result in results:\n            severity_counts[result['issue_severity']] += 1\n        \n        plt.figure(figsize=(10, 6))\n        plt.subplot(1, 2, 1)\n        plt.pie(severity_counts.values(), labels=severity_counts.keys(), autopct='%1.1f%%')\n        plt.title('Issues by Severity')\n        \n        # Top issues\n        test_counts = defaultdict(int)\n        for result in results:\n            test_counts[result['test_name']] += 1\n        \n        top_tests = dict(sorted(test_counts.items(), key=lambda x: x[1], reverse=True)[:10])\n        \n        plt.subplot(1, 2, 2)\n        plt.barh(list(top_tests.keys()), list(top_tests.values()))\n        plt.title('Top 10 Most Common Issues')\n        plt.xlabel('Count')\n        \n        plt.tight_layout()\n        plt.savefig(f'{output_dir}/bandit_analysis.png', dpi=300, bbox_inches='tight')\n        print(f\"Charts saved to: {output_dir}/bandit_analysis.png\")\n\ndef main():\n    parser = argparse.ArgumentParser(description='Analyze Bandit security scan results')\n    parser.add_argument('report_file', help='Path to Bandit JSON report file')\n    parser.add_argument('--csv-output', help='Output CSV file for detailed report')\n    parser.add_argument('--chart-dir', help='Directory to save charts')\n    \n    args = parser.parse_args()\n    \n    analyzer = BanditReportAnalyzer(args.report_file)\n    analyzer.generate_summary()\n    \n    if args.csv_output:\n        analyzer.generate_detailed_report(args.csv_output)\n    \n    if args.chart_dir:\n        analyzer.generate_charts(args.chart_dir)\n\nif __name__ == \"__main__\":\n    main()\n"})}),"\n",(0,i.jsx)(e.h3,{id:"usage",children:"Usage"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-bash",children:"# Generate comprehensive analysis\npython bandit_analyzer.py bandit-report.json \\\n  --csv-output detailed_report.csv \\\n  --chart-dir ./charts\n"})}),"\n",(0,i.jsx)(e.h2,{id:"-custom-plugins",children:"\ud83d\udd27 Custom Plugins"}),"\n",(0,i.jsx)(e.h3,{id:"creating-custom-bandit-plugin",children:"Creating Custom Bandit Plugin"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-python",children:"# bandit_custom_plugin.py\nimport ast\nimport bandit\nfrom bandit.core import test_properties\n\n@test_properties.test_id('B999')\n@test_properties.checks('Call')\ndef check_deprecated_crypto(context):\n    \"\"\"Check for usage of deprecated cryptographic functions\"\"\"\n    deprecated_functions = [\n        'Crypto.Cipher.DES.new',\n        'Crypto.Cipher.ARC2.new',\n        'Crypto.Hash.MD2.new',\n        'Crypto.Hash.MD4.new',\n    ]\n    \n    if context.call_function_name_qual in deprecated_functions:\n        return bandit.Issue(\n            severity=bandit.HIGH,\n            confidence=bandit.HIGH,\n            text=f\"Use of deprecated cryptographic function: {context.call_function_name_qual}\",\n            lineno=context.node.lineno,\n        )\n\n@test_properties.test_id('B998')\n@test_properties.checks('Str')\ndef check_hardcoded_secrets(context):\n    \"\"\"Check for potential hardcoded secrets in strings\"\"\"\n    import re\n    \n    # Patterns for common secret formats\n    secret_patterns = [\n        r'sk_live_[0-9a-zA-Z]{24}',  # Stripe secret key\n        r'sk_test_[0-9a-zA-Z]{24}',  # Stripe test key\n        r'AKIA[0-9A-Z]{16}',         # AWS Access Key\n        r'ghp_[0-9a-zA-Z]{36}',      # GitHub Personal Access Token\n    ]\n    \n    if isinstance(context.node, ast.Str):\n        for pattern in secret_patterns:\n            if re.search(pattern, context.node.s):\n                return bandit.Issue(\n                    severity=bandit.HIGH,\n                    confidence=bandit.MEDIUM,\n                    text=f\"Potential hardcoded secret detected: {pattern}\",\n                    lineno=context.node.lineno,\n                )\n"})}),"\n",(0,i.jsx)(e.h3,{id:"plugin-configuration",children:"Plugin Configuration"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-yaml",children:"# bandit_plugins.yaml\nplugins:\n  - bandit_custom_plugin\n\ntests:\n  - B998  # Custom hardcoded secrets check\n  - B999  # Custom deprecated crypto check\n"})}),"\n",(0,i.jsx)(e.h2,{id:"-troubleshooting",children:"\ud83d\udd0d Troubleshooting"}),"\n",(0,i.jsx)(e.h3,{id:"common-issues-and-solutions",children:"Common Issues and Solutions"}),"\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsx)(e.li,{children:(0,i.jsx)(e.strong,{children:"False Positives"})}),"\n"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-python",children:'# Use # nosec comment to suppress specific issues\npassword = "default_password"  # nosec B105\n\n# Use # nosec with specific test ID\nexec(user_input)  # nosec B102\n\n# Suppress multiple tests\ndangerous_function()  # nosec B101,B102\n'})}),"\n",(0,i.jsxs)(e.ol,{start:"2",children:["\n",(0,i.jsx)(e.li,{children:(0,i.jsx)(e.strong,{children:"Configuration Not Loading"})}),"\n"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-bash",children:"# Verify configuration file location\nbandit -r . --config-file bandit.yaml -v\n\n# Check configuration syntax\npython -c \"import yaml; yaml.safe_load(open('bandit.yaml'))\"\n"})}),"\n",(0,i.jsxs)(e.ol,{start:"3",children:["\n",(0,i.jsx)(e.li,{children:(0,i.jsx)(e.strong,{children:"Performance Issues"})}),"\n"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-bash",children:'# Exclude large directories\nbandit -r . -x venv/,node_modules/,.git/\n\n# Use specific file patterns\nbandit -r . --include "*.py"\n\n# Limit recursion depth\nfind . -name "*.py" -not -path "./venv/*" | head -100 | xargs bandit\n'})}),"\n",(0,i.jsx)(e.h3,{id:"debug-mode",children:"Debug Mode"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-bash",children:"# Enable debug output\nbandit -r . -v --debug\n\n# Show skipped files\nbandit -r . -v | grep -i skip\n"})}),"\n",(0,i.jsx)(e.h2,{id:"-best-practices",children:"\ud83d\udcc8 Best Practices"}),"\n",(0,i.jsx)(e.h3,{id:"security-first-development",children:"Security-First Development"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-python",children:"# Good practices to avoid Bandit warnings\n\n# 1. Use secure random generation\nimport secrets\ntoken = secrets.token_hex(16)  # Instead of random\n\n# 2. Use safe YAML loading\nimport yaml\nwith open('config.yaml') as f:\n    config = yaml.safe_load(f)  # Instead of yaml.load\n\n# 3. Use secure hash functions\nimport hashlib\ndata_hash = hashlib.sha256(data.encode()).hexdigest()  # Instead of MD5\n\n# 4. Validate shell commands\nimport subprocess\nimport shlex\ndef safe_shell_command(user_input):\n    # Validate and sanitize input\n    if not user_input.isalnum():\n        raise ValueError(\"Invalid input\")\n    \n    # Use list form instead of shell=True\n    subprocess.run(['ls', '-l', user_input], check=True)\n\n# 5. Use environment variables for secrets\nimport os\napi_key = os.environ.get('API_KEY')  # Instead of hardcoding\n\n# 6. Implement proper error handling\ntry:\n    risky_operation()\nexcept Exception as e:\n    logger.error(f\"Operation failed: {e}\")\n    # Don't use bare except or pass\n"})}),"\n",(0,i.jsx)(e.h3,{id:"integration-strategy",children:"Integration Strategy"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-bash",children:"# 1. Start with baseline scan\nbandit -r . -f json -o baseline.json\n\n# 2. Implement gradually\nbandit -r . -ll  # Start with high/medium severity only\n\n# 3. Use in development workflow\n# Add to pre-commit hooks\n# Integrate with IDE\n# Run in CI/CD pipeline\n\n# 4. Regular security reviews\n# Weekly scans on main branch\n# Security-focused code reviews\n# Developer security training\n"})}),"\n",(0,i.jsx)(e.h2,{id:"-additional-resources",children:"\ud83d\udcda Additional Resources"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:(0,i.jsx)(e.a,{href:"https://bandit.readthedocs.io/",children:"Bandit Documentation"})}),"\n",(0,i.jsx)(e.li,{children:(0,i.jsx)(e.a,{href:"https://owasp.org/www-project-python-security/",children:"OWASP Python Security"})}),"\n",(0,i.jsx)(e.li,{children:(0,i.jsx)(e.a,{href:"https://python-security.readthedocs.io/",children:"Python Security Best Practices"})}),"\n",(0,i.jsx)(e.li,{children:(0,i.jsx)(e.a,{href:"https://github.com/PyCQA/bandit",children:"Bandit GitHub Repository"})}),"\n",(0,i.jsx)(e.li,{children:(0,i.jsx)(e.a,{href:"https://owasp.org/www-project-code-review-guide/",children:"Security Code Review Guide"})}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:"Bandit provides essential security analysis for Python applications, helping developers identify and fix security vulnerabilities early in the development process."})]})}function u(n={}){const{wrapper:e}={...(0,r.R)(),...n.components};return e?(0,i.jsx)(e,{...n,children:(0,i.jsx)(c,{...n})}):c(n)}},8453:(n,e,t)=>{t.d(e,{R:()=>a,x:()=>o});var s=t(6540);const i={},r=s.createContext(i);function a(n){const e=s.useContext(r);return s.useMemo((function(){return"function"==typeof n?n(e):{...e,...n}}),[e,n])}function o(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(i):n.components||i:a(n.components),s.createElement(r.Provider,{value:e},n.children)}}}]);