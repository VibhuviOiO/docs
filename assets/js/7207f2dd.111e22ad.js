"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[3063],{3867:(n,e,i)=>{i.r(e),i.d(e,{assets:()=>a,contentTitle:()=>o,default:()=>u,frontMatter:()=>l,metadata:()=>s,toc:()=>c});const s=JSON.parse('{"id":"CI-CD/CI/cloud-build","title":"Google Cloud Build","description":"Google Cloud Build is a serverless CI/CD platform that executes builds on Google Cloud Platform infrastructure with advanced build automation and deployment capabilities.","source":"@site/docs/CI-CD/CI/cloud-build.md","sourceDirName":"CI-CD/CI","slug":"/CI-CD/CloudBuild","permalink":"/docs/docs/CI-CD/CloudBuild","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/CI-CD/CI/cloud-build.md","tags":[],"version":"current","sidebarPosition":8,"frontMatter":{"sidebar_position":8,"title":"Google Cloud Build","description":"Google Cloud Build is a serverless CI/CD platform that executes builds on Google Cloud Platform infrastructure with advanced build automation and deployment capabilities.","slug":"/CI-CD/CloudBuild","keywords":["Google Cloud Build","GCP CI/CD","cloud native CI/CD","container builds","serverless CI/CD","Google Cloud Platform","build automation","deployment pipeline","cloud builds","GCP DevOps"]},"sidebar":"tutorialSidebar","previous":{"title":"GoCD","permalink":"/docs/docs/CI-CD/GoCD"},"next":{"title":"AWS CodeBuild","permalink":"/docs/docs/CI-CD/AWSCodeBuild"}}');var t=i(4848),r=i(8453);const l={sidebar_position:8,title:"Google Cloud Build",description:"Google Cloud Build is a serverless CI/CD platform that executes builds on Google Cloud Platform infrastructure with advanced build automation and deployment capabilities.",slug:"/CI-CD/CloudBuild",keywords:["Google Cloud Build","GCP CI/CD","cloud native CI/CD","container builds","serverless CI/CD","Google Cloud Platform","build automation","deployment pipeline","cloud builds","GCP DevOps"]},o="\u2601\ufe0f Serverless CI/CD with Google Cloud Build",a={},c=[{value:"Key Features",id:"key-features",level:2},{value:"Use Cases",id:"use-cases",level:2},{value:"\ud83e\uddf0 Prerequisites",id:"-prerequisites",level:2},{value:"\ud83d\udd27 Step 1: Setup Google Cloud Build",id:"-step-1-setup-google-cloud-build",level:2},{value:"Enable Required APIs and Setup",id:"enable-required-apis-and-setup",level:3},{value:"\ud83c\udfd7\ufe0f Step 2: Comprehensive Build Configuration",id:"\ufe0f-step-2-comprehensive-build-configuration",level:2},{value:"\u25b6\ufe0f Step 3: Advanced Build Patterns",id:"\ufe0f-step-3-advanced-build-patterns",level:2},{value:"Muld",id:"muld",level:3},{value:"34s)ly (8mul successfompleted All steps cLD SUCCESS:",id:"34sly-8mul-successfompleted-all-steps-cld-success",level:2},{value:"You&#39;ll  What \ud83d\udd0d--",id:"youll--what---",level:3}];function d(n){const e={a:"a",br:"br",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.R)(),...n.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(e.header,{children:(0,t.jsx)(e.h1,{id:"\ufe0f-serverless-cicd-with-google-cloud-build",children:"\u2601\ufe0f Serverless CI/CD with Google Cloud Build"})}),"\n",(0,t.jsxs)(e.p,{children:[(0,t.jsx)(e.strong,{children:"Google Cloud Build"})," is a ",(0,t.jsx)(e.strong,{children:"serverless CI/CD platform"})," that executes builds on ",(0,t.jsx)(e.strong,{children:"Google Cloud Platform infrastructure"})," with ",(0,t.jsx)(e.strong,{children:"automatic scaling"}),", ",(0,t.jsx)(e.strong,{children:"parallel execution"}),", and ",(0,t.jsx)(e.strong,{children:"deep GCP integration"}),". Perfect for ",(0,t.jsx)(e.strong,{children:"container builds"}),", ",(0,t.jsx)(e.strong,{children:"multi-language applications"}),", and ",(0,t.jsx)(e.strong,{children:"cloud-native deployments"}),"."]}),"\n",(0,t.jsx)(e.h2,{id:"key-features",children:"Key Features"}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.strong,{children:"Serverless Architecture"}),": No infrastructure management required"]}),"\n",(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.strong,{children:"Parallel Execution"}),": Run build steps concurrently for faster builds"]}),"\n",(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.strong,{children:"Deep GCP Integration"}),": Native integration with GCP services"]}),"\n",(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.strong,{children:"Custom Build Steps"}),": Extensible with custom builders and Docker images"]}),"\n",(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.strong,{children:"Security"}),": Built-in vulnerability scanning and secret management"]}),"\n"]}),"\n",(0,t.jsx)(e.h2,{id:"use-cases",children:"Use Cases"}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.strong,{children:"Container Applications"}),": Build and deploy to GKE, Cloud Run, and Anthos"]}),"\n",(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.strong,{children:"Serverless Functions"}),": Build and deploy Cloud Functions and Cloud Run functions"]}),"\n",(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.strong,{children:"Multi-Language Projects"}),": Support for Node.js, Python, Java, Go, and more"]}),"\n",(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.strong,{children:"Infrastructure as Code"}),": Terraform and deployment automation"]}),"\n"]}),"\n",(0,t.jsx)(e.hr,{}),"\n",(0,t.jsx)(e.h2,{id:"-prerequisites",children:"\ud83e\uddf0 Prerequisites"}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.strong,{children:"Google Cloud Project"})," with billing enabled"]}),"\n",(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.strong,{children:"gcloud CLI"})," installed and configured"]}),"\n",(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.strong,{children:"Docker"})," for local testing (optional)"]}),"\n",(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.strong,{children:"Git repository"})," connected to Cloud Build"]}),"\n",(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.strong,{children:"Required APIs"})," enabled (Cloud Build, Container Registry, etc.)"]}),"\n"]}),"\n",(0,t.jsx)(e.hr,{}),"\n",(0,t.jsx)(e.h2,{id:"-step-1-setup-google-cloud-build",children:"\ud83d\udd27 Step 1: Setup Google Cloud Build"}),"\n",(0,t.jsx)(e.h3,{id:"enable-required-apis-and-setup",children:"Enable Required APIs and Setup"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-bash",children:'# Set your project ID\nexport PROJECT_ID="your-project-id"\ngcloud config set project $PROJECT_ID\n\n# Enable required APIs\ngcloud services enable cloudbuild.googleapis.com\ngcloud services enable containerregistry.googleapis.com\ngcloud services enable run.googleapis.com\ngcloud services enable container.googleapis.com\ngcloud services enable secretmanager.googleapis.com\ngcloud services enable artifactregistry.googleapis.com\n\n# Create Artifact Registry repository\ngcloud artifacts repositories create myapp-repo \\\n    --repository-format=docker \\\n    --location=us-central1 \\\n    --description="Docker repository for myapp"\n\n# Grant Cloud Build service account necessary permissions\nPROJECT_NUMBER=$(gcloud projects describe $PROJECT_ID --format="value(projectNumber)")\ngcloud projects add-iam-policy-binding $PROJECT_ID \\\n    --member="serviceAccount:$PROJECT_NUMBER@cloudbuild.gserviceaccount.com" \\\n    --role="roles/container.developer"\n\ngcloud projects add-iam-policy-binding $PROJECT_ID \\\n    --member="serviceAccount:$PROJECT_NUMBER@cloudbuild.gserviceaccount.com" \\\n    --role="roles/run.admin"\n\ngcloud projects add-iam-policy-binding $PROJECT_ID \\\n    --member="serviceAccount:$PROJECT_NUMBER@cloudbuild.gserviceaccount.com" \\\n    --role="roles/iam.serviceAccountUser"\n'})}),"\n",(0,t.jsx)(e.hr,{}),"\n",(0,t.jsx)(e.h2,{id:"\ufe0f-step-2-comprehensive-build-configuration",children:"\ud83c\udfd7\ufe0f Step 2: Comprehensive Build Configuration"}),"\n",(0,t.jsxs)(e.p,{children:["Create a comprehensive ",(0,t.jsx)(e.code,{children:"cloudbuild.yaml"}),":"]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-yaml",children:"# Google Cloud Build Configuration\n# This file defines a complete CI/CD pipeline with multiple stages\n\n# Substitutions for dynamic values\nsubstitutions:\n  _SERVICE_NAME: myapp\n  _REGION: us-central1\n  _CLUSTER_NAME: production-cluster\n  _CLUSTER_ZONE: us-central1-a\n  _DEPLOY_ENV: staging\n\n# Build steps\nsteps:\n  # Step 1: Restore dependencies cache\n  - name: 'gcr.io/cloud-builders/gsutil'\n    id: 'restore-cache'\n    entrypoint: 'bash'\n    args:\n      - '-c'\n      - |\n        gsutil -m cp -r gs://${PROJECT_ID}-build-cache/node_modules . || echo \"No cache found\"\n    waitFor: ['-']\n\n  # Step 2: Install dependencies\n  - name: 'node:18-alpine'\n    id: 'install-deps'\n    entrypoint: 'npm'\n    args: ['ci']\n    env:\n      - 'NODE_ENV=development'\n    waitFor: ['restore-cache']\n\n  # Step 3: Save dependencies cache\n  - name: 'gcr.io/cloud-builders/gsutil'\n    id: 'save-cache'\n    entrypoint: 'bash'\n    args:\n      - '-c'\n      - |\n        gsutil -m cp -r node_modules gs://${PROJECT_ID}-build-cache/\n    waitFor: ['install-deps']\n\n  # Step 4: Run linting\n  - name: 'node:18-alpine'\n    id: 'lint'\n    entrypoint: 'npm'\n    args: ['run', 'lint']\n    waitFor: ['install-deps']\n\n  # Step 5: Run unit tests\n  - name: 'node:18-alpine'\n    id: 'test-unit'\n    entrypoint: 'npm'\n    args: ['run', 'test:coverage']\n    env:\n      - 'CI=true'\n      - 'NODE_=test'\n    waitFor: ['install-dep\n\n  # Step 6: Run it\n  - name: 'node:1ne'\n    id: 'securitit'\n    entrypoint: 'npm'\n    args: ['audit', '--audit-l']\n\n\n  # Step 7: Build application\n  - name: 'node:18-alpine'\n    id: 'build-app'\n   pm'\n\n   env:\nion'\n    waitFor: ['lint',t']\n\n  # Step 8: Build Docker image\nker'\n    id: 'build-image'\n    args:\n      - 'build'\n'-t'\n      - 'us-central1-docke\n      - '-t'\n      - ''\n      - '--caom'\n      - 'u\n      - 'uild-arg'\n      - \n'.'\n    waitFor: ['build-app'\n\n  # Step 9: Push Dr image\n  - name: 'gcr\n    id: 'push-image'\n    args:\nh'\n      - '--all-tags'\n      - 'us-centra}'\n\n\n  #y\n\n    id: 'security-scan'\n    args:\n      '\n      - '--exit-code'\n      - '1'\n      - '--severity'\n      - 'HIGH,CRITICAL'\n      - 't'\n     - 'json'\n      - '--output'\n\n      -A}'\n    waitFor: ['push-image']\n\n\n  - name: 'gcr.io/cloud-builoud'\nging'\n    args:\n      - 'run'\n      - 'deploy'\ntaging'\n      - '--image'\n      - 'u_SHA}'\n      - '-on'\n      - ION}'\n      -\naged'\n      - '--allow-unauthe\n      - '--set-env-vars'\n      - 'NODE_ENV=staging,VERSION=${COMMIT_SHA}'\n\n      - '512Mi'\n      - '--cpu'\n- '1'\n      - '--max-instances'\n   0'\n\n      - '80'\n    wai-scan']\n\n  # Ststs\n\n    id: 'integration-tests'\n\n    args:\n      - '-c'\n      - |\n\n        SERVICE_URL)\n        \n        # Wait for service to be ready\n}; do\n          if curl -f \"$SERVICE_URL/health\"; then\n   \"\n\n   fi\n\"\n          sleep 10\ne\n        \n\n        curl -f \"$SERVICE_URL/api/test\" || \n       \"\n    waitFor: ['deploy-staging\n\n  #nch\n  - nam\n    id: 'deploy-production'\n    args:\n      - 'run'\n/'\n     A}'\n      - '--clu\n      - '--location=${_CLUZONE}'\n    n'\n    waitFoon-tests']\n\n  # tion\n  - name: 'gcr.il'\n    id: 'smoke-tests'\n    args:\n      - 'run'\n    \n      - '--image=curlimages/cu\n      - '--rm'\n    \n      - '--'\n      - 'curl'\n      - '-f'\n      - 'http://${_SERVICE_NAME}.prolth'\n    env:\n   ER_ZONE}'\nNAME}'\n    waitFor: ['deploy-pro\n\n  # Step 15: Notify Slack on succe\n  - nal'\n    id: 'notify-success'\n    entrypoint: 'bash'\n    args:\n  \n      - |\n        curl -X POSson' \\\n        --data \"{\\\"\"}\" \\\n        $$\n    secretEnv: ['SLACK_\n    w\n\n# o store\nartifacts:\n  jects:\n    location: 'gs:/s'\n    paths:\n      - 'trivy-report.json'\n   '\n  \n\n#\n\n  - 'us-central1-docker.pkg.dev/${PROJECT_ISHA}'\n  - 'us-central1-docker.pkg.dev/${\n\n# anager\navailableS\n  secretManager:\n    - versionName: \n      env: 'SLACK_'\n    - versionName: projest\n     \n\n# \noptions:\n  \n  diskSizeGb: 100\n  substitution_option: 'ALL\n  l_ONLY\n N\n  d true\n\n# Te build\n'\n"})}),"\n",(0,t.jsx)(e.hr,{}),"\n",(0,t.jsx)(e.h2,{id:"\ufe0f-step-3-advanced-build-patterns",children:"\u25b6\ufe0f Step 3: Advanced Build Patterns"}),"\n",(0,t.jsx)(e.h3,{id:"muld",children:"Muld"}),"\n",(0,t.jsxs)(e.p,{children:["Create ",(0,t.jsx)(e.code,{children:"cloudbuild-monorepo.yaml"}),":"]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-yaml",children:"steps:\n  # Detect changed services\n  - name: 'gcr.io/clou/git'\n    id: ''\n    entrypoi\n    args:\n      - '-c'\n      - |\n        # Get list of changed files\n        git diff --name-only HEAD~1 \n        \n        # Detect \n        echo \"fr\n        echo \"backend=false\" >> build_flags.env\n        echo \"api=false\" >> bus.env\n    \nn\n          echo \"fv\n\n        \n        i\n          echo \"backenv\n        fi\n        \n        if txt; then\nenv\n        fi\n        \n        cat build_flags.env\n\n  # nal)\n  - name: 'node:18-alpine'\n    id: 'build-frontend'\n    entrypoint: 'bash'\n    args:\n      - '-c'\n    - |\n        source build_flags.env\n        if [ \"$fren\n          cd frontend\n          npm ci\n          npm run build\n          npm run test\n        else\n     d\"\n    \n    waitFor: ['detect-chans']\n\nal)\n  - name: 'python:3.11-slim'\n    id: 'build-backend'\n    entrypoint: 'bash'\n    gs:\n      - '-c'\n      - |\n        source build_flags.env\n        if [ \"$backend\" = \"\n         d\n     .txt\n    test\n          python -m flak\n        else\n\n        fi\n    waitFor: ['detect-changes']\n\n  # Build API (conditional)\n  -lpine'\n\n   \n    args:\n      - '-c'\n     - |\n        source build_flags.env\n        if [ \"$api\" = \"true\" ]; then\n          cd api\n          go mod download\n          go test ./...\ni .\n        else          echo \"API unchanged, skipping build\"   fi    waissystemon notificatid nitoring angrated moe  \n\u2705 Inteelinpipthe to nce inlia companning andty scilt securi Buows  \n\u2705yment workfl and deploriggersautomated tished \n\u2705 Establtasks  ized ecialrs for sptom buildeted cuson  \n\u2705 Crealel executiith paralrns wpatteced build dvanmplemented anes  \n\u2705 Iipeli/CD prless CIve servemprehensiup co\n\u2705 Set ved:** Achie You've.\n\n**Whatplicationstive ap-narn cloudt for modeecd Build perf Clouakeses muruild feat bvanced, and adonP integratieep GC dre,architectuless on of server combinatiment\n\nTheecret manageing and sin scann with built-chapproay-first** **Securitxecution\n-  parallel end scaling a automaticds** with buil**Scalablegistry\n- ifact Rertd Ad Run, anlouGKE, Cices like  serv withgration** inteeep GCP*Dagement\n- *tructure mant infras withous CI/CD**erverles\n- **Seed:\nu nild when yoose Cloud BuChoform. atloud Plon Google C* I/CD*native Cor **cloud-l choice** f**idea the isuild le Cloud Bon\n\nGoogsi\n\n## Conclus\n\n---guration confipts andconce-specific GCPCurve**: **Learning  builds\n- olumee for high-vxpensiv**: Can be ens\n- **Costtiohosted solulf-ible than se*: Less flexization*tomLimited Cus\n- **rmud Platfooogle Clo Tied to G Lock-in**:**GCP Cons\n- ent\n\n### \u274ccret managem and sety scanningcurin selt-ie**: BuiSecurvices\n- **h GCP serwitration : Deep integegrated** **Intabilities\n- capnd cachingxecution aallel e**: Parst **Fauild load\n-d on bg base scalintomaticlable**: Aucad\n- **Snt require managemeructurestinfraess**: No *Serverl- *### \u2705 Pros\n& Cons\n\nos --\n\n## Pr0 days)\n\n-last 3ds**: 12 (led Buil- **Faients/day\nploym de*: 3.2t Frequency* **Deploymen*: 6m 42s\n-ime*ld Tverage Buiays)\n- **A30 d(last 6.8% ate**: 9ld Success Rrd\n- **Buioatrics Dashbd Me# Buil\n"})}),"\n",(0,t.jsx)(e.h2,{id:"34sly-8mul-successfompleted-all-steps-cld-success",children:"34s)ly (8mul successfompleted All steps cLD SUCCESS:"}),"\n",(0,t.jsxs)(e.p,{children:["BUIrun.appng-xyz-uc.a.p-stagiapmy//tps",":ice",' URL: ht": Servoy-staging11 - "depl\nStep #eployed been d01-abc] hasaging-000p-stsion [myapeviing] ragp-st[myap Service y-staging":- "deplo #11  Done.\nStepw service...ploying neg": \u2713 Deploy-stagin"de  #11 -g]\nStepginp-stavice [myap Run serClouder to g containDeployin-staging": 1 - "deployStep #1"\nagingploy-stde1 - " #1ng StepStarti',":a1b2c3d"]}),"\n",(0,t.jsx)(e.p,{children:'po/myappct/myapp-remyprojeg.dev/docker.pkentral1-ged us-cully taguccessfage": S"build-im- tep #8 def456\nSilt abc123ssfully bucce Suage":-im- "buildtep #8\nS 156.7MBker daemon ocontext to Ding build cge": Sendma"build-iep #8 - -image"\nSt "build #8 -ting Stepes'}),"\n",(0,t.jsxs)(e.p,{children:['Star91.8% branchnts, % statemeerage: 94.2": Cov-unittest5 - "tal\nStep # tosed, 127 passts: 127": Teitun "test-p #5 -otal\nSte5 t 1 15 passed,Suites',":t",'": Test "test-uniep #5 - est.tsx\nStts/App.tencomponSS src/": PAst-unitep #5 - "teerage\nStcovt:1.0.0 tesmyapp@t-unit": >  "tes#5 -"\nStep it - "test-unting Step #5g!']}),"\n",(0,t.jsxs)(e.p,{children:['Starlintines pass  fil": \u2728 All#4 - "lint,.tsx\nStep .tsxt .js,.jsx,. --e > eslint  - "lint"',":p"," #4t\nSte ",(0,t.jsx)(e.a,{href:"mailto:linyapp@1.0.0nt",children:"linyapp@1.0.0nt"}),'": > m"li #4 -\nStep"intep #4 - "l\nStarting Sts in 23s\nkage pac47ded 18: adll-deps"nstap #2 - "i\nSteed.tions disabl protecdedRecommenng --force  WARN usipml-deps": n- "instal\nStep #2 deps"- "install-ng Step #2 Starti MiB.']}),"\n",(0,t.jsxs)(e.p,{children:['cts/45.61.2k objeeted over ration compl Ope-cache"',":restore",' " -ep #1les...\nStmodu-cache/node_-buildprojectmyg gs://": Copyinhecace-restortep #1 - "cache"\nSestore-ep #1 - "rng Sttarti```bash\nSe Output\nConsold Build  ClouSee']}),"\n",(0,t.jsx)(e.h3,{id:"youll--what---",children:"You'll  What \ud83d\udd0d--"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-bash",children:'\n-\n}\n``d_network.id.builpute_networkogle_com go    =  work et n1"\n ntral "us-ce   =n     "\n  regio0.0/2410.0.range = "_cidr_ipbnet"\n  = "build-sue          amet" {\n  n_subn"buildwork" e_subnetle_computoogurce "gresoe\n}\n\nalss = ftworkeate_subneo_crrk"\n  autetwo"build-n =            me         nak" {\n orild_netw" "bu_networkutempgle_co "gooourcees}\n}\n\nr  id\network.ork.build_nte_netwogle_compugotwork = ed_ne   peerig {\n work_conf \n  netalse\n  }\n nal_ip = fter  no_ex4"\n  d--standar  = "e2e hine_typmac   \n   = 100_gb ze   disk_siig {\n er_confrk"\n  \n  woal1"us-centrn = atio"\n  locer-pool-work "private     =\n  nameol" {"private_por_pool" orkeild_wudbugle_clo "goosourcee builds\nre privatol for worker po Buildud\n\n# Clo\n}\n  } = "true"  LEASE "\n    _REductionV = "proEPLOY_EN {\n    _Dtitutions =  subs  \nse.yaml"\nlea-redbuildoue = "clenam \n  fil  }\n     }\nv.*"\nag = "^  th {\n    "\n    pusyappname  = "mg"\n    r = "myor\n    owneub {\n  gith"\n  loymentsase depreleor  fgerrigiption = "Tr"\n  descrtriggease-"rele   = name     e" {\n  "releaser" dbuild_trigg"google_clou\nresource   }\n}\n\nging"= "staNV    _DEPLOY_E\n  {tutions =\n  substiyaml"\n  oudbuild-pr. "clfilename =\n  }\n  \n   }$"\n   inh = "^ma   branc {\n   _requestll   pu"myapp"\n   name  = "\n  g"myor= r   ownethub {\n  \n  \n  giidation"est valqur pull re"Trigger fo= description \n  pr-trigger"   = "  name     " {\nuesteq" "pull_rriggerudbuild_t"google_cloesource }\n}\n\nr = true\n  al_requiredprov\n    aponfig {  approval_c\n  \n"_WITH_STATUSOGSBUILD_LNCLUDE_gs = "Iild_loude_bu incl  \n \n  }\nal1-a""us-centrZONE   =  _CLUSTER_ster"\n   on-cluroducti   = "p_NAME   _CLUSTER1"\n ral-cent   = "usON      \n    _REGIapp"E   = "my_NAM_SERVICEon"\n    ducti     = "pro_ENVEPLOY= {\n    _Dtions substitu\n  \n  ld.yaml"udbuie = "clofilenam\n  \n  }\n  "\n    }n$ = "^mai   branch\n     push {app"\n  e  = "my  nam"\n   "myorg  owner =ithub {\n    \n  gs"\nch buildran b main"Trigger for = scription"\n  dech-trigger"main-bran      =   name  branch" {\n" "main_gerild_trigloudbule_curce "goog```hcl\nreso:\n\nf`d.tuilorm/cloud-berrafte `t\n\nCreaersiggfor Build Trfiguration  Conorm### Terraf\n'})}),"\n",(0,t.jsxs)(e.p,{children:['oyment"elease deplption="R--descri" ',(0,t.jsx)(e.br,{}),"\n",'.yamlseleauild-reig="cloudb--build-conf   " ',(0,t.jsx)(e.br,{}),"\n",'v.*ern="^ag-patt--t    ',(0,t.jsx)(e.br,{}),"\n",'yorg"o-owner="m-rep\n-" \\myapprepo-name="  --ub ',(0,t.jsx)(e.br,{}),"\n","create giths triggerds\ngcloud builesor releas trigger fte tag"]}),"\n",(0,t.jsx)(e.h1,{id:"creaation",children:'Creaation"'}),"\n",(0,t.jsxs)(e.p,{children:['idequest val"Pull r=escription\n--dr.yaml" \\udbuild-pconfig="cloild-\n--bu" \\ain$attern="^ml-request-ppul',(0,t.jsx)(e.br,{}),"\n",'--" rgmyoer="  --repo-own',(0,t.jsx)(e.br,{}),"\n",'yapp" ="mo-name --repb ',(0,t.jsx)(e.br,{}),"\n","ate githurs cres trigged buildger\ngclou PR trig"]}),"\n",(0,t.jsx)(e.h1,{id:"createt",children:'Createt"'}),"\n",(0,t.jsxs)(e.p,{children:['h deploymen"Main brancon=ripti\n--desc \\uild.yaml"ig="cloudbconf   --build-" ',(0,t.jsx)(e.br,{}),"\n",'n$rn="^maianch-pattebr',(0,t.jsx)(e.br,{}),"\n",'--" r="myorgwneepo-o\n--ryapp" \\me="m   --repo-na\n\\ub threate gi triggers c buildsy\ngcloudrepositoritHub']}),"\n",(0,t.jsx)(e.h1,{id:"connect-g",children:"Connect G"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-bash",metastring:"Triggers",children:'Advanced with ntegration I### GitHubmation\n\nutoand Ars geBuild TrigStep 4: ---\n\n## \ud83d\udcca \n\n``in()\n`ma:\n    __"= "__main_name__ =d")\n\nif _mpleten cocaecurity s print("\u2705 S       \nimage)\nage(    sign_ims:\n    _resultyped granivy_results \n    if trpasss f scange i # Sign ima\n     \n  , indent=2)s, fltn.dump(resu  jso:\n       as f\', \'w\')ults.jsonn-resscarity-h open(\'secuwit   \n        }\n om\nm\': sb     \'sbo  sults,\n pe_re\': grype \'gry\n       ults,: trivy_restrivy\'    \'\n     image,   \'image\':= {\n     lts \n    resu results # Save    \n   e)\ne_sbom(imaggenerat\n    sbom = rate SBOM # Gene \n   mage)\n   grype_scan(its = run_ulres  grype_mage)\n  scan(iy_rivn_t = ruesultsvy_r\n    triy scansvulnerabilit\n    # Run e}")\n    agr {im scan fotyecurie snsivg compreheintartrint(f"\ud83d\ude80 S   p\n    \n ys.argv[1]age = s\n    im\n    1)sys.exit(\n        >")geima-scan.py <: securitysage print("U     \n  gv) != 2:ys.arlen(s   if \n ef main():\n\ndturn False     re")\n   : {e}ng failedsigniage "\u274c Imprint(fe:\n         as cessErrordProrocess.Callept subpue\n    exceturn Tr    relly")\n    successfuigned e} s {imagImageprint(f"\u2705 \n        ck=True)run(cmd, che subprocess.    :\n   ry t\n    \n   age]imIVATE_KEY\', _PRenv://COSIGN-key\', \' \'sign\', \'-[\'cosign\',\n    cmd = ionduct in proey setup proper kreuld requi   # This wo")\n    \n e {image}imaging \ufe0f Signint(f"\u270d""\n    prsign"ith Coge wner imaaiSign cont """):\n   image sign_image(None\n\ndefeturn   r  ")\n    }erriled: {e.stdn fatiogenera\u274c SBOM    print(f"\n     r as e:cessErro.CalledProocessexcept subpr)\n    lt.stdouts(resun.load  return jso     \n ue)k=TrTrue, checue, text=Trt=apture_outpuun(cmd, c.ressbprocult = su      res   try:\n  \n    \n -o\', \'json\']\', image, \'cmd = [\'syft    \n\n    ge}")for {ima SBOM nerating"\ud83d\udccb Ge   print(f""\n erials" of MatBillware Softate "Gener   ""age):\n sbom(imgenerate_None\n\ndef n       retur\n  err}")tdailed: {e.sype scan fGrnt(f"\u274c pri     as e:\n   r essErro.CalledProcbprocess   except su)\n outs(result.std json.load return\n       =True)ue, checktext=Trutput=True,  capture_on(cmd,ss.ruroceubp= s     result  try:\n   \n   \n    json\']\', \'mage, \'-ope\', i cmd = [\'gry  \n   e}")\n  imagn on {caing Grype sf"\ud83d\udd0d Runn   print(\n "y scan""ilitabnervulun Grype  """R:\n   image)_scan(run_grype\ndef eturn None\n\n        rr}") {e.stderiled:n fa Trivy scaprint(f"\u274ce:\n         as rocessErroralledPocess.Ct subpr)\n    exceplt.stdoutresuds(rn json.loaetu       rTrue)\n k=e, checru=Tue, textut=Trapture_outpn(cmd, css.ruproceesult = sub  r         try:\n\n    \n mage\n    ]\n        iCRITICAL\',\'HIGH,y\', --severit  \'\'1\',\n      it-code\',  \'--ex     json\',\n  t\', \'   \'--forma,\n     \'image\'trivy\',       \'[\n     cmd =  \n ")\n    on {image}ivy scannning TrRuint(f"\ud83d\udd0d \n    pr scan"""erabilityrivy vulnun T    """Ran(image):\nn_trivy_scos\n\ndef ru\nimport mport syson\nis\nimport js subproces\nimportpython3sr/bin/env #!/uython\n\n```pscan.py`:\nsecurity-ty-scanner/curi/seilders\nCreate `bu"]\n'})}),"\n",(0,t.jsx)(e.p,{children:'y-scan.pyecurital/bin/sloc"/usr/NTRYPOINT [scan.py'}),"\n",(0,t.jsx)(e.p,{children:"Eity-/securlocal/binr/od +x /usUN chml/bin/\nRusr/locapy /an.rity-sccu ser\nCOPYscanneurity ustom secall cgn"}),"\n",(0,t.jsx)(e.h1,{id:"instsibincolocalmod-x-usr",children:"Instsibin/co/local/mod +x /usr"}),"\n",(0,t.jsxs)(e.p,{children:["chosign && /local/bin/c /usrnux-amd64osign-li  mv c && ",(0,t.jsx)(e.br,{}),"\n",'inux-amd64"n-l/cosigoad/downlestat/lign/releasessigstore/costhub.com/ttps://gi-O -L "hn\nRUN curl  Cosig']}),"\n",(0,t.jsx)(e.h1,{id:"install",children:"Install"}),"\n",(0,t.jsx)(e.p,{children:"inl/bca-b /usr/lo | sh -s -- install.shain/hore/syft/ment.com/ancrcontuseubgith/raw.https:/ -sSfL t\nRUN curlyfll S"}),"\n",(0,t.jsx)(e.h1,{id:"instaalbinusrloc---b---h--s--sallshmaininstypemanchoregrntentcohubusercorawgit-ssfl-httpsrl-e",children:"Instaal/bin/usr/loc- -b  -h -s | sall.shmain/instype/m/anchore/grntent.cohubusercoraw.git://-sSfL httpsrl e"}),"\n",(0,t.jsx)(e.p,{children:"RUN cul Gryp"}),"\n",(0,t.jsx)(e.h1,{id:"installocalbins-----b-usrsh--allsh--ontribinstivymaincuritytruaseccomaqntbusercontegithutpsrawcurl--sfl-htivy",children:"Instal/local/bins -- -b /usrsh -all.sh | ontrib/instivy/main/curity/truaseccom/aqnt.buserconte.githutps://rawcurl -sfL htivy"}),"\n",(0,t.jsx)(e.p,{children:"RUN Install Try3-pip"}),"\n",(0,t.jsx)(e.h1,{id:"pn3-",children:"pn3 \\"}),"\n",(0,t.jsxs)(e.p,{children:["pytho      git ",(0,t.jsx)(e.br,{}),"\n","jq \\"]}),"\n",(0,t.jsxs)(e.p,{children:["ash \\l ",(0,t.jsx)(e.br,{}),"\n","b  curcache ",(0,t.jsx)(e.br,{}),"\n","--no-d RUN apk ady tools\nsecurit"]}),"\n",(0,t.jsx)(e.h1,{id:"install-1",children:"Install"}),"\n",(0,t.jsxs)(e.p,{children:["lpine",":latestFROM"," ae\nerfil"]}),"\n",(0,t.jsxs)(e.p,{children:["```dockockerfile",(0,t.jsx)(e.code,{children:":ner/Dscanecurity-ilders/ste "}),"bueaCring"]}),"\n",(0,t.jsx)(e.p,{children:"ity Scannvanced Securlder for Adui### Custom B`"}),"\n",(0,t.jsx)(e.p,{children:"']\n``ild-apickend', 'bu-ba', 'build-frontend: ['buildaitFor    w    fi\nT_SHA\napi:$COMMIECT_ID/o/$PROJ push gcr.i    dockerpi/\nMMIT_SHA aID/api:$CO$PROJECT_o/gcr.iild -t er buck      do then\n]; = \"true\" \"$api\"    if ["}),"\n",(0,t.jsxs)(e.p,{children:["fiT_SHA$COMMInd:_ID/backeo/$PROJECTush gcr.i  docker p    nd/\n",(0,t.jsxs)(e.em,{children:['SHA backeMMITkend:$COD/bac_Iio/$PROJECT -t gcr. build  docker    then\n" ];" = "truend$backe  if [ "',(0,t.jsx)(e.br,{}),"\n","fi\nA\nSH:$COMMIT"]}),'/frontend/$PROJECT_IDr.ior push gc     docke  d/\nHA frontenIT_Snd:$COMMonteROJECT_ID/frio/$Pild -t gcr.   docker bu       n\n" ]; the" = "truend "$fronte      if [',(0,t.jsx)(e.br,{}),"\n","v\ngs.ene build_fla    sourc    - |\nc'"]}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsx)(e.li,{children:"'-       args:"}),"\n"]}),"\n",(0,t.jsx)(e.p,{children:"t: 'bash'ntrypoin\nemages'd-iid: 'buil   '\nckerdod-builders/cr.io/clou- name: 'gnal)\nonditioimages (cild Docker  # Bu"}),"\n",(0,t.jsx)(e.p,{children:"nges']ct-cha['detetFor:"})]})}function u(n={}){const{wrapper:e}={...(0,r.R)(),...n.components};return e?(0,t.jsx)(e,{...n,children:(0,t.jsx)(d,{...n})}):d(n)}},8453:(n,e,i)=>{i.d(e,{R:()=>l,x:()=>o});var s=i(6540);const t={},r=s.createContext(t);function l(n){const e=s.useContext(r);return s.useMemo((function(){return"function"==typeof n?n(e):{...e,...n}}),[e,n])}function o(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(t):n.components||t:l(n.components),s.createElement(r.Provider,{value:e},n.children)}}}]);