"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[9013],{8453:(e,n,t)=>{t.d(n,{R:()=>i,x:()=>l});var a=t(6540);const s={},r=a.createContext(s);function i(e){const n=a.useContext(r);return a.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:i(e.components),a.createElement(r.Provider,{value:n},e.children)}},8709:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>o,contentTitle:()=>l,default:()=>u,frontMatter:()=>i,metadata:()=>a,toc:()=>c});const a=JSON.parse('{"id":"Security/vault","title":"HashiCorp Vault","description":"HashiCorp Vault is a comprehensive secrets management platform for storing, accessing, and managing sensitive data with advanced security features and enterprise capabilities.","source":"@site/docs/Security/vault.md","sourceDirName":"Security","slug":"/Security/Vault","permalink":"/docs/Security/Vault","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/Security/vault.md","tags":[],"version":"current","sidebarPosition":1,"frontMatter":{"sidebar_position":1,"title":"HashiCorp Vault","description":"HashiCorp Vault is a comprehensive secrets management platform for storing, accessing, and managing sensitive data with advanced security features and enterprise capabilities.","slug":"/Security/Vault","keywords":["HashiCorp Vault","secrets management","security","encryption","authentication","authorization","enterprise security","secrets rotation"]},"sidebar":"tutorialSidebar","previous":{"title":"Security","permalink":"/docs/category/security"},"next":{"title":"vault-comprehensive","permalink":"/docs/Security/vault-comprehensive"}}');var s=t(4848),r=t(8453);const i={sidebar_position:1,title:"HashiCorp Vault",description:"HashiCorp Vault is a comprehensive secrets management platform for storing, accessing, and managing sensitive data with advanced security features and enterprise capabilities.",slug:"/Security/Vault",keywords:["HashiCorp Vault","secrets management","security","encryption","authentication","authorization","enterprise security","secrets rotation"]},l="\ud83d\udd10 Enterprise Secrets Management with HashiCorp Vault",o={},c=[{value:"Key Features",id:"key-features",level:2},{value:"Use Cases",id:"use-cases",level:2},{value:"\ud83e\uddf0 Prerequisites",id:"-prerequisites",level:2},{value:"\ud83d\udd27 Step 1: Production Vault Setup",id:"-step-1-production-vault-setup",level:2},{value:"Comprehensive Docker Compose Configuration",id:"comprehensive-docker-compose-configuration",level:3},{value:"Production Configuration Files",id:"production-configuration-files",level:3},{value:"\ud83c\udfd7\ufe0f Step 2: Advanced Vault Configuration",id:"\ufe0f-step-2-advanced-vault-configuration",level:2},{value:"Initialize and Configure Vault",id:"initialize-and-configure-vault",level:3},{value:"Enable Authentication Methods",id:"enable-authentication-methods",level:3},{value:"Create Advanced Policies",id:"create-advanced-policies",level:3},{value:"\u25b6\ufe0f Step 3: Dynamic Secrets and Engines",id:"\ufe0f-step-3-dynamic-secrets-and-engines",level:2},{value:"Database Secrets Engine",id:"database-secrets-engine",level:3},{value:"PKI Secrets Engine",id:"pki-secrets-engine",level:3},{value:"AWS Secrets Engine",id:"aws-secrets-engine",level:3},{value:"\ud83d\udcca Step 4: Application Integration",id:"-step-4-application-integration",level:2},{value:"Python Application with Vault Integration",id:"python-application-with-vault-integration",level:3},{value:"\ud83d\udd0d What You&#39;ll See",id:"-what-youll-see",level:2},{value:"Vault Initialization Output",id:"vault-initialization-output",level:3},{value:"Dynamic Database Credentials",id:"dynamic-database-credentials",level:3},{value:"Application Integration Results",id:"application-integration-results",level:3},{value:"Pros &amp; Cons",id:"pros--cons",level:2},{value:"\u2705 Pros",id:"-pros",level:3},{value:"\u274c Cons",id:"-cons",level:3},{value:"Conclusion",id:"conclusion",level:2}];function d(e){const n={br:"br",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"-enterprise-secrets-management-with-hashicorp-vault",children:"\ud83d\udd10 Enterprise Secrets Management with HashiCorp Vault"})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"HashiCorp Vault"})," is a ",(0,s.jsx)(n.strong,{children:"comprehensive secrets management platform"})," for securely ",(0,s.jsx)(n.strong,{children:"storing"}),", ",(0,s.jsx)(n.strong,{children:"accessing"}),", and ",(0,s.jsx)(n.strong,{children:"managing"})," sensitive data with ",(0,s.jsx)(n.strong,{children:"advanced encryption"}),", ",(0,s.jsx)(n.strong,{children:"dynamic secrets"}),", ",(0,s.jsx)(n.strong,{children:"access control"}),", and ",(0,s.jsx)(n.strong,{children:"audit capabilities"}),". Perfect for ",(0,s.jsx)(n.strong,{children:"enterprise security"}),", ",(0,s.jsx)(n.strong,{children:"compliance"}),", and ",(0,s.jsx)(n.strong,{children:"zero-trust"})," architectures."]}),"\n",(0,s.jsx)(n.h2,{id:"key-features",children:"Key Features"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Dynamic Secrets"}),": Generate secrets on-demand with automatic expiration"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Encryption as a Service"}),": Encrypt/decrypt data without storing it"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Identity-Based Access"}),": Fine-grained access control with policies"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Secrets Rotation"}),": Automatic rotation of database credentials and API keys"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Audit Logging"}),": Comprehensive audit trails for compliance"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"use-cases",children:"Use Cases"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Application Secrets"}),": Secure storage of API keys, passwords, and certificates"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Database Credentials"}),": Dynamic database credentials with automatic rotation"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"PKI Management"}),": Certificate authority and certificate lifecycle management"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Cloud Secrets"}),": Integration with AWS, Azure, GCP secret services"]}),"\n"]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"-prerequisites",children:"\ud83e\uddf0 Prerequisites"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Docker & Docker Compose"})," for containerized setup"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"HashiCorp Vault CLI"})," installed locally"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"SSL certificates"})," for production deployment"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Database"})," (PostgreSQL, MySQL) for production storage backend"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Load balancer"})," for high availability setup"]}),"\n"]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"-step-1-production-vault-setup",children:"\ud83d\udd27 Step 1: Production Vault Setup"}),"\n",(0,s.jsx)(n.h3,{id:"comprehensive-docker-compose-configuration",children:"Comprehensive Docker Compose Configuration"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:'version: \'3.8\'\n\nservices:\n  # PostgreSQL backend for Vault\n  vault-postgres:\n    image: postgres:15\n    container_name: vault-postgres\n    restart: unless-stopped\n    environment:\n      POSTGRES_DB: vault\n      POSTGRES_USER: vault\n      POSTGRES_PASSWORD: vault_password\n    volumes:\n      - vault-postgres-data:/var/lib/postgresql/data\n    ports:\n      - "5432:5432"\n    healthcheck:\n      test: ["CMD-SHELL", "pg_isready -U vault"]\n      interval: 30s\n      timeout: 10s\n      retries: 3\n\n  # Vault server\n  vault-server:\n    image: vault:1.15.2\n    container_name: vault-server\n    restart: unless-stopped\n    ports:\n      - "8200:8200"\n    environment:\n      VAULT_ADDR: http://0.0.0.0:8200\n      VAULT_API_ADDR: http://0.0.0.0:8200\n      VAULT_LOCAL_CONFIG: |\n        {\n          "backend": {\n            "postgresql": {\n              "connection_url": "postgres://vault:vault_password@vault-postgres:5432/vault?sslmode=disable"\n            }\n          },\n          "listener": {\n            "tcp": {\n              "address": "0.0.0.0:8200",\n              "tls_disable": true\n            }\n          },\n          "ui": true,\n          "log_level": "INFO",\n          "default_lease_ttl": "168h",\n          "max_lease_ttl": "720h"\n        }\n    cap_add:\n      - IPC_LOCK\n    volumes:\n      - vault-data:/vault/data\n      - vault-logs:/vault/logs\n      - ./vault-config:/vault/config\n    depends_on:\n      vault-postgres:\n        condition: service_healthy\n    command: ["vault", "server", "-config=/vault/config"]\n\n  # Vault agent for auto-auth\n  vault-agent:\n    image: vault:1.15.2\n    container_name: vault-agent\n    restart: unless-stopped\n    environment:\n      VAULT_ADDR: http://vault-server:8200\n    volumes:\n      - ./vault-agent-config:/vault/config\n      - vault-agent-data:/vault/data\n    depends_on:\n      - vault-server\n    command: ["vault", "agent", "-config=/vault/config/agent.hcl"]\n\n  # Consul for service discovery (optional)\n  consul:\n    image: consul:1.16\n    container_name: vault-consul\n    restart: unless-stopped\n    ports:\n      - "8500:8500"\n    environment:\n      CONSUL_BIND_INTERFACE: eth0\n    volumes:\n      - consul-data:/consul/data\n    command: ["consul", "agent", "-server", "-bootstrap", "-ui", "-client=0.0.0.0"]\n\nvolumes:\n  vault-postgres-data:\n  vault-data:\n  vault-logs:\n  vault-agent-data:\n  consul-data:\n'})}),"\n",(0,s.jsx)(n.h3,{id:"production-configuration-files",children:"Production Configuration Files"}),"\n",(0,s.jsxs)(n.p,{children:["Create ",(0,s.jsx)(n.code,{children:"vault-config/vault.hcl"}),":"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-hcl",children:'# Vault production configuration\nstorage "postgresql" {\n  connection_url = "postgres://vault:vault_password@vault-postgres:5432/vault?sslmode=disable"\n  table          = "vault_kv_store"\n  max_parallel   = 128\n}\n\nlistener "tcp" {\n  address       = "0.0.0.0:8200"\n  tls_cert_file = "/vault/config/tls/vault.crt"\n  tls_key_file  = "/vault/config/tls/vault.key"\n  tls_min_version = "tls12"\n}\n\n# High availability configuration\nha_storage "consul" {\n  address = "consul:8500"\n  path    = "vault/"\n}\n\n# Seal configuration (auto-unseal with cloud KMS)\nseal "awskms" {\n  region     = "us-west-2"\n  kms_key_id = "alias/vault-unseal-key"\n}\n\n# UI and API configuration\nui = true\napi_addr = "https://vault.example.com:8200"\ncluster_addr = "https://vault.example.com:8201"\n\n# Logging\nlog_level = "INFO"\nlog_format = "json"\n\n# Performance tuning\ndefault_lease_ttl = "168h"\nmax_lease_ttl = "720h"\ndisable_mlock = false\n\n# Telemetry\ntelemetry {\n  prometheus_retention_time = "30s"\n  disable_hostname = true\n}\n'})}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"\ufe0f-step-2-advanced-vault-configuration",children:"\ud83c\udfd7\ufe0f Step 2: Advanced Vault Configuration"}),"\n",(0,s.jsx)(n.h3,{id:"initialize-and-configure-vault",children:"Initialize and Configure Vault"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"# Start Vault services\ndocker-compose up -d\n\n# Initialize Vault (first time only)\nexport VAULT_ADDR='http://localhost:8200'\nvault operator init -key-shares=5 -key-threshold=3 > vault-keys.txt\n\n# Unseal Vault (requires 3 keys)\nvault operator unseal <key1>\nvault operator unseal <key2>\nvault operator unseal <key3>\n\n# Login with root token\nexport VAULT_TOKEN=$(grep 'Initial Root Token:' vault-keys.txt | awk '{print $NF}')\nvault auth $VAULT_TOKEN\n\n# Enable audit logging\nvault audit enable file file_path=/vault/logs/audit.log\n\n# Check Vault status\nvault status\n"})}),"\n",(0,s.jsx)(n.h3,{id:"enable-authentication-methods",children:"Enable Authentication Methods"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:'# Enable multiple auth methods\nvault auth enable userpass\nvault auth enable ldap\nvault auth enable kubernetes\nvault auth enable aws\nvault auth enable github\n\n# Configure userpass authentication\nvault write auth/userpass/users/admin \\\n    password=admin123 \\\n    policies=admin-policy\n\nvault write auth/userpass/users/developer \\\n    password=dev123 \\\n    policies=developer-policy\n\n# Configure LDAP authentication\nvault write auth/ldap/config \\\n    url="ldap://ldap.example.com" \\\n    userdn="ou=Users,dc=example,dc=com" \\\n    userattr=uid \\\n    groupdn="ou=Groups,dc=example,dc=com" \\\n    groupfilter="(&(objectClass=group)(member={{.UserDN}}))" \\\n    groupattr=cn \\\n    binddn="cn=vault,ou=Users,dc=example,dc=com" \\\n    bindpass=password\n\n# Configure Kubernetes authentication\nvault write auth/kubernetes/config \\\n    token_reviewer_jwt="$(cat /var/run/secrets/kubernetes.io/serviceaccount/token)" \\\n    kubernetes_host="https://kubernetes.default.svc:443" \\\n    kubernetes_ca_cert=@/var/run/secrets/kubernetes.io/serviceaccount/ca.crt\n'})}),"\n",(0,s.jsx)(n.h3,{id:"create-advanced-policies",children:"Create Advanced Policies"}),"\n",(0,s.jsxs)(n.p,{children:["Create ",(0,s.jsx)(n.code,{children:"policies/admin-policy.hcl"}),":"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-hcl",children:'# Admin policy - full access\npath "*" {\n  capabilities = ["create", "read", "update", "delete", "list", "sudo"]\n}\n\n# System paths\npath "sys/*" {\n  capabilities = ["create", "read", "update", "delete", "list", "sudo"]\n}\n\n# Auth methods\npath "auth/*" {\n  capabilities = ["create", "read", "update", "delete", "list", "sudo"]\n}\n'})}),"\n",(0,s.jsxs)(n.p,{children:["Create ",(0,s.jsx)(n.code,{children:"policies/developer-policy.hcl"}),":"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-hcl",children:'# Developer policy - limited access\npath "secret/data/{{identity.entity.name}}/*" {\n  capabilities = ["create", "read", "update", "delete", "list"]\n}\n\npath "secret/data/shared/*" {\n  capabilities = ["read", "list"]\n}\n\npath "database/creds/readonly" {\n  capabilities = ["read"]\n}\n\npath "pki/issue/developer" {\n  capabilities = ["create", "update"]\n}\n\n# Allow token self-renewal\npath "auth/token/renew-self" {\n  capabilities = ["update"]\n}\n\n# Allow looking up own token\npath "auth/token/lookup-self" {\n  capabilities = ["read"]\n}\n'})}),"\n",(0,s.jsx)(n.p,{children:"Apply policies:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"vault policy write admin-policy policies/admin-policy.hcl\nvault policy write developer-policy policies/developer-policy.hcl\n"})}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"\ufe0f-step-3-dynamic-secrets-and-engines",children:"\u25b6\ufe0f Step 3: Dynamic Secrets and Engines"}),"\n",(0,s.jsx)(n.h3,{id:"database-secrets-engine",children:"Database Secrets Engine"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:'# Enable database secrets engine\nvault secrets enable database\n\n# Configure PostgreSQL connection\nvault write database/config/postgresql \\\n    plugin_name=postgresql-database-plugin \\\n    connection_url="postgresql://{{username}}:{{password}}@postgres:5432/myapp?sslmode=disable" \\\n    allowed_roles="readonly,readwrite" \\\n    username="vault" \\\n    password="vault_password"\n\n# Create database roles\nvault write database/roles/readonly \\\n    db_name=postgresql \\\n    creation_statements="CREATE ROLE \\"{{name}}\\" WITH LOGIN PASSWORD \'{{password}}\' VALID UNTIL \'{{expiration}}\'; \\\n        GRANT SELECT ON ALL TABLES IN SCHEMA public TO \\"{{name}}\\";" \\\n    default_ttl="1h" \\\n    max_ttl="24h"\n\nvault write database/roles/readwrite \\\n    db_name=postgresql \\\n    creation_statements="CREATE ROLE \\"{{name}}\\" WITH LOGIN PASSWORD \'{{password}}\' VALID UNTIL \'{{expiration}}\'; \\\n        GRANT SELECT, INSERT, UPDATE, DELETE ON ALL TABLES IN SCHEMA public TO \\"{{name}}\\";" \\\n    default_ttl="1h" \\\n    max_ttl="24h"\n\n# Generate dynamic database credentials\nvault read database/creds/readonly\nvault read database/creds/readwrite\n'})}),"\n",(0,s.jsx)(n.h3,{id:"pki-secrets-engine",children:"PKI Secrets Engine"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:'# Enable PKI secrets engine\nvault secrets enable pki\nvault secrets tune -max-lease-ttl=87600h pki\n\n# Generate root CA\nvault write -field=certificate pki/root/generate/internal \\\n    common_name="Example.com Root CA" \\\n    ttl=87600h > CA_cert.crt\n\n# Configure CA and CRL URLs\nvault write pki/config/urls \\\n    issuing_certificates="http://vault.example.com:8200/v1/pki/ca" \\\n    crl_distribution_points="http://vault.example.com:8200/v1/pki/crl"\n\n# Create intermediate CA\nvault secrets enable -path=pki_int pki\nvault secrets tune -max-lease-ttl=43800h pki_int\n\nvault write -format=json pki_int/intermediate/generate/internal \\\n    common_name="Example.com Intermediate Authority" \\\n    | jq -r \'.data.csr\' > pki_intermediate.csr\n\nvault write -format=json pki/root/sign-intermediate csr=@pki_intermediate.csr \\\n    format=pem_bundle ttl="43800h" \\\n    | jq -r \'.data.certificate\' > intermediate.cert.pem\n\nvault write pki_int/intermediate/set-signed certificate=@intermediate.cert.pem\n\n# Create certificate role\nvault write pki_int/roles/developer \\\n    allowed_domains="example.com" \\\n    allow_subdomains=true \\\n    max_ttl="720h"\n\n# Issue certificate\nvault write pki_int/issue/developer common_name="app.example.com" ttl="24h"\n'})}),"\n",(0,s.jsx)(n.h3,{id:"aws-secrets-engine",children:"AWS Secrets Engine"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:'# Enable AWS secrets engine\nvault secrets enable aws\n\n# Configure AWS credentials\nvault write aws/config/root \\\n    access_key=AKIAIOSFODNN7EXAMPLE \\\n    secret_key=wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMPLEKEY \\\n    region=us-west-2\n\n# Create AWS role\nvault write aws/roles/s3-readonly \\\n    credential_type=iam_user \\\n    policy_document=-<<EOF\n{\n  "Version": "2012-10-17",\n  "Statement": [\n    {\n      "Effect": "Allow",\n      "Action": "s3:GetObject",\n      "Resource": "arn:aws:s3:::my-bucket/*"\n    }\n  ]\n}\nEOF\n\n# Generate AWS credentials\nvault read aws/creds/s3-readonly\n'})}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"-step-4-application-integration",children:"\ud83d\udcca Step 4: Application Integration"}),"\n",(0,s.jsx)(n.h3,{id:"python-application-with-vault-integration",children:"Python Application with Vault Integration"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:"# vault_app.py\nimport hvac\nimport os\nimport time\nimport logging\nfrom contextlib import contextmanager\nfrom functools import wraps\nimport psycopg2\nfrom psycopg2.extras import RealDictCursor\n\nclass VaultClient:\n    \"\"\"Production Vault client with advanced features\"\"\"\n    \n    def __init__(self, vault_url=None, auth_method='token', **auth_kwargs):\n        self.vault_url = vault_url or os.getenv('VAULT_ADDR', 'http://localhost:8200')\n        self.client = hvac.Client(url=self.vault_url)\n        self.auth_method = auth_method\n        self.logger = logging.getLogger(__name__)\n        \n        # Authenticate\n        self._authenticate(**auth_kwargs)\n        \n        # Setup token renewal\n        self._setup_token_renewal()\n    \n    def _authenticate(self, **kwargs):\n        \"\"\"Authenticate with Vault using specified method\"\"\"\n        if self.auth_method == 'token':\n            token = kwargs.get('token') or os.getenv('VAULT_TOKEN')\n            self.client.token = token\n            \n        elif self.auth_method == 'userpass':\n            username = kwargs.get('username') or os.getenv('VAULT_USERNAME')\n            password = kwargs.get('password') or os.getenv('VAULT_PASSWORD')\n            \n            auth_response = self.client.auth.userpass.login(\n                username=username,\n                password=password\n            )\n            self.client.token = auth_response['auth']['client_token']\n            \n        elif self.auth_method == 'kubernetes':\n            jwt_path = kwargs.get('jwt_path', '/var/run/secrets/kubernetes.io/serviceaccount/token')\n            role = kwargs.get('role') or os.getenv('VAULT_ROLE')\n            \n            with open(jwt_path, 'r') as f:\n                jwt = f.read()\n            \n            auth_response = self.client.auth.kubernetes.login(\n                role=role,\n                jwt=jwt\n            )\n            self.client.token = auth_response['auth']['client_token']\n        \n        # Verify authentication\n        if not self.client.is_authenticated():\n            raise Exception(\"Failed to authenticate with Vault\")\n        \n        self.logger.info(f\"Successfully authenticated with Vault using {self.auth_method}\")\n    \n    def _setup_token_renewal(self):\n        \"\"\"Setup automatic token renewal\"\"\"\n        try:\n            token_info = self.client.auth.token.lookup_self()\n            ttl = token_info['data'].get('ttl', 0)\n            \n            if ttl > 0:\n                # Renew token when 75% of TTL has passed\n                renewal_time = ttl * 0.75\n                self.logger.info(f\"Token will be renewed in {renewal_time} seconds\")\n                \n                # In production, you'd want to use a background thread or scheduler\n                # threading.Timer(renewal_time, self._renew_token).start()\n        except Exception as e:\n            self.logger.warning(f\"Could not setup token renewal: {e}\")\n    \n    def _renew_token(self):\n        \"\"\"Renew the current token\"\"\"\n        try:\n            self.client.auth.token.renew_self()\n            self.logger.info(\"Token renewed successfully\")\n            self._setup_token_renewal()  # Setup next renewal\n        except Exception as e:\n            self.logger.error(f\"Failed to renew token: {e}\")\n    \n    def get_secret(self, path, version=None):\n        \"\"\"Get secret from KV store\"\"\"\n        try:\n            if version:\n                response = self.client.secrets.kv.v2.read_secret_version(\n                    path=path, version=version\n                )\n            else:\n                response = self.client.secrets.kv.v2.read_secret_version(path=path)\n            \n            return response['data']['data']\n        except Exception as e:\n            self.logger.error(f\"Failed to get secret {path}: {e}\")\n            raise\n    \n    def put_secret(self, path, secret_dict):\n        \"\"\"Store secret in KV store\"\"\"\n        try:\n            self.client.secrets.kv.v2.create_or_update_secret(\n                path=path,\n                secret=secret_dict\n            )\n            self.logger.info(f\"Secret stored at {path}\")\n        except Exception as e:\n            self.logger.error(f\"Failed to store secret {path}: {e}\")\n            raise\n    \n    def get_database_credentials(self, role):\n        \"\"\"Get dynamic database credentials\"\"\"\n        try:\n            response = self.client.read(f'database/creds/{role}')\n            return {\n                'username': response['data']['username'],\n                'password': response['data']['password'],\n                'lease_id': response['lease_id'],\n                'lease_duration': response['lease_duration']\n            }\n        except Exception as e:\n            self.logger.error(f\"Failed to get database credentials for role {role}: {e}\")\n            raise\n    \n    def revoke_lease(self, lease_id):\n        \"\"\"Revoke a lease\"\"\"\n        try:\n            self.client.sys.revoke_lease(lease_id)\n            self.logger.info(f\"Lease {lease_id} revoked\")\n        except Exception as e:\n            self.logger.error(f\"Failed to revoke lease {lease_id}: {e}\")\n            raise\n    \n    def encrypt_data(self, plaintext, key_name='default'):\n        \"\"\"Encrypt data using Vault's transit engine\"\"\"\n        try:\n            response = self.client.secrets.transit.encrypt_data(\n                name=key_name,\n                plaintext=plaintext\n            )\n            return response['data']['ciphertext']\n        except Exception as e:\n            self.logger.error(f\"Failed to encrypt data: {e}\")\n            raise\n    \n    def decrypt_data(self, ciphertext, key_name='default'):\n        \"\"\"Decrypt data using Vault's transit engine\"\"\"\n        try:\n            response = self.client.secrets.transit.decrypt_data(\n                name=key_name,\n                ciphertext=ciphertext\n            )\n            return response['data']['plaintext']\n        except Exception as e:\n            self.logger.error(f\"Failed to decrypt data: {e}\")\n            raise\n\nclass DatabaseManager:\n    \"\"\"Database manager with Vault integration\"\"\"\n    \n    def __init__(self, vault_client, db_role='readonly'):\n        self.vault_client = vault_client\n        self.db_role = db_role\n        self.current_creds = None\n        self.connection = None\n        self.logger = logging.getLogger(__name__)\n    \n    @contextmanager\n    def get_connection(self):\n        \"\"\"Get database connection with dynamic credentials\"\"\"\n        try:\n            # Get fresh credentials\n            creds = self.vault_client.get_database_credentials(self.db_role)\n            \n            # Create connection\n            conn = psycopg2.connect(\n                host='localhost',\n                port=5432,\n                database='myapp',\n                user=creds['username'],\n                password=creds['password'],\n                cursor_factory=RealDictCursor\n            )\n            \n            self.logger.info(f\"Connected to database with user {creds['username']}\")\n            \n            try:\n                yield conn\n            finally:\n                conn.close()\n                # Revoke credentials when done\n                self.vault_client.revoke_lease(creds['lease_id'])\n                self.logger.info(\"Database credentials revoked\")\n                \n        except Exception as e:\n            self.logger.error(f\"Database connection failed: {e}\")\n            raise\n\ndef vault_secret(path, key=None):\n    \"\"\"Decorator to inject Vault secrets into function\"\"\"\n    def decorator(func):\n        @wraps(func)\n        def wrapper(*args, **kwargs):\n            vault_client = VaultClient()\n            secret_data = vault_client.get_secret(path)\n            \n            if key:\n                kwargs[key] = secret_data\n            else:\n                kwargs.update(secret_data)\n            \n            return func(*args, **kwargs)\n        return wrapper\n    return decorator\n\n# Example usage\n@vault_secret('secret/myapp', key='app_config')\ndef start_application(app_config):\n    \"\"\"Start application with secrets from Vault\"\"\"\n    print(f\"Starting app with config: {app_config}\")\n    \n    # Use database manager\n    vault_client = VaultClient(auth_method='userpass', \n                              username='developer', \n                              password='dev123')\n    \n    db_manager = DatabaseManager(vault_client, db_role='readonly')\n    \n    with db_manager.get_connection() as conn:\n        cursor = conn.cursor()\n        cursor.execute(\"SELECT version();\")\n        result = cursor.fetchone()\n        print(f\"Database version: {result['version']}\")\n\nif __name__ == \"__main__\":\n    logging.basicConfig(level=logging.INFO)\n    \n    # Initialize Vault client\n    vault_client = VaultClient(\n        auth_method='userpass',\n        username='developer',\n        password='dev123'\n    )\n    \n    # Store application secrets\n    app_secrets = {\n        'api_key': 'secret-api-key-12345',\n        'database_url': 'postgresql://localhost:5432/myapp',\n        'redis_url': 'redis://localhost:6379/0'\n    }\n    \n    vault_client.put_secret('secret/myapp', app_secrets)\n    \n    # Start application\n    start_application()\n"})}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"-what-youll-see",children:"\ud83d\udd0d What You'll See"}),"\n",(0,s.jsx)(n.h3,{id:"vault-initialization-output",children:"Vault Initialization Output"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"$ vault operator init -key-shares=5 -key-threshold=3\nUnseal Key 1: AbCdEfGhIjKlMnOpQrStUvWxYz1234567890\nUnseal Key 2: BcDeFgHiJkLmNoPqRsTuVwXyZ1234567890\nUnseal Key 3: CdEfGhIjKlMnOpQrStUvWxYzA1234567890\nUnseal Key 4: DeFgHiJkLmNoPqRsTuVwXyZaB1234567890\nUnseal Key 5: EfGhIjKlMnOpQrStUvWxYzAbC1234567890\n\nInitial Root Token: hvs.CAESIJ1234567890abcdefghijklmnop\n\nVault initialized with 5 key shares and a key threshold of 3.\n"})}),"\n",(0,s.jsx)(n.h3,{id:"dynamic-database-credentials",children:"Dynamic Database Credentials"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"$ vault read database/creds/readonly\nKey                Value\n---                -----\nlease_id           database/creds/readonly/abc123def456\nlease_duration     1h\nlease_renewable    true\npassword           A1a-B2b3C4c5D6d7E8e9\nusername           v-userpass-readonly-abc123def456-1640995200\n"})}),"\n",(0,s.jsx)(n.h3,{id:"application-integration-results",children:"Application Integration Results"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"INFO:__main__:Successfully authenticated with Vault using userpass\nINFO:__main__:Secret stored at secret/myapp\nINFO:__main__:Connected to database with user v-userpass-readonly-xyz789\nDatabase version: PostgreSQL 15.1 on x86_64-pc-linux-gnu\nINFO:__main__:Database credentials revoked\n"})}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"pros--cons",children:"Pros & Cons"}),"\n",(0,s.jsx)(n.h3,{id:"-pros",children:"\u2705 Pros"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Enterprise Security"}),": Advanced encryption and access controls"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Dynamic Secrets"}),": Automatic credential generation and rotation"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Compliance"}),": Comprehensive audit logging and policy enforcement"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Scalability"}),": High availability and multi-datacenter support"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Integration"}),": Extensive API and tool ecosystem"]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"-cons",children:"\u274c Cons"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Complexity"}),": Steep learning curve and operational overhead"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Single Point of Failure"}),": Requires careful HA setup"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Performance"}),": Network latency for secret retrieval"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Cost"}),": Enterprise features require paid licenses"]}),"\n"]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"conclusion",children:"Conclusion"}),"\n",(0,s.jsxs)(n.p,{children:["HashiCorp Vault is the ",(0,s.jsx)(n.strong,{children:"enterprise-grade solution"})," for ",(0,s.jsx)(n.strong,{children:"comprehensive secrets management"}),". Choose Vault when you need:"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Advanced security"})," with dynamic secrets and encryption services"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Compliance"})," with audit logging and policy enforcement"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Enterprise features"})," like high availability and multi-tenancy"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Extensive integrations"})," with cloud providers and tools"]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"The combination of security, scalability, and enterprise features makes Vault ideal for organizations with strict security and compliance requirements."}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"What You've Achieved:"}),"\n\u2705 Set up production-ready Vault with HA configuration",(0,s.jsx)(n.br,{}),"\n","\u2705 Implemented dynamic secrets for databases and cloud providers",(0,s.jsx)(n.br,{}),"\n","\u2705 Created comprehensive authentication and authorization policies",(0,s.jsx)(n.br,{}),"\n","\u2705 Built application integration with automatic credential management",(0,s.jsx)(n.br,{}),"\n","\u2705 Established PKI infrastructure for certificate management",(0,s.jsx)(n.br,{}),"\n","\u2705 Configured audit logging and compliance monitoring"]})]})}function u(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}}}]);