"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[995],{2583:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>a,contentTitle:()=>o,default:()=>g,frontMatter:()=>l,metadata:()=>i,toc:()=>c});const i=JSON.parse('{"id":"Infrastructure/ingress-nginx","title":"Ingress NGINX Controller","description":"Learn how to install and configure NGINX Ingress Controller for Kubernetes to manage external access to services with load balancing, SSL termination, and routing.","source":"@site/docs/Infrastructure/ingress-nginx.md","sourceDirName":"Infrastructure","slug":"/Infrastructure/IngressNginx","permalink":"/docs/docs/Infrastructure/IngressNginx","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/Infrastructure/ingress-nginx.md","tags":[],"version":"current","sidebarPosition":1,"frontMatter":{"sidebar_position":1,"title":"Ingress NGINX Controller","description":"Learn how to install and configure NGINX Ingress Controller for Kubernetes to manage external access to services with load balancing, SSL termination, and routing.","slug":"/Infrastructure/IngressNginx","keywords":["ingress nginx","kubernetes ingress","nginx controller","load balancer","SSL termination","kubernetes networking","helm installation"]},"sidebar":"tutorialSidebar","previous":{"title":"Infrastructure & Kubernetes","permalink":"/docs/docs/category/infrastructure--kubernetes"},"next":{"title":"Kubernetes Cluster Setup","permalink":"/docs/docs/Infrastructure/KubernetesCluster"}}');var r=s(4848),t=s(8453);const l={sidebar_position:1,title:"Ingress NGINX Controller",description:"Learn how to install and configure NGINX Ingress Controller for Kubernetes to manage external access to services with load balancing, SSL termination, and routing.",slug:"/Infrastructure/IngressNginx",keywords:["ingress nginx","kubernetes ingress","nginx controller","load balancer","SSL termination","kubernetes networking","helm installation"]},o="\ud83c\udf10 NGINX Ingress Controller for Kubernetes",a={},c=[{value:"\ud83d\udd0d Version Compatibility Check",id:"-version-compatibility-check",level:2},{value:"Check Kubernetes Version",id:"check-kubernetes-version",level:3},{value:"Find Compatible Ingress-NGINX Version",id:"find-compatible-ingress-nginx-version",level:3},{value:"\ud83d\udd27 Installation Methods",id:"-installation-methods",level:2},{value:"Option 1: Direct Helm Installation",id:"option-1-direct-helm-installation",level:3},{value:"Option 2: Production Template Method (Recommended)",id:"option-2-production-template-method-recommended",level:3},{value:"\ud83d\udd0d Verification and Monitoring",id:"-verification-and-monitoring",level:2},{value:"Check Installation Status",id:"check-installation-status",level:3},{value:"View Logs",id:"view-logs",level:3},{value:"\ud83c\udf10 Basic Ingress Configuration",id:"-basic-ingress-configuration",level:2},{value:"Simple HTTP Ingress",id:"simple-http-ingress",level:3},{value:"HTTPS Ingress with TLS",id:"https-ingress-with-tls",level:3},{value:"\u2699\ufe0f Advanced Configuration",id:"\ufe0f-advanced-configuration",level:2},{value:"Custom Annotations",id:"custom-annotations",level:3},{value:"Path-Based Routing",id:"path-based-routing",level:3},{value:"\ud83d\udd27 Troubleshooting",id:"-troubleshooting",level:2},{value:"Common Issues",id:"common-issues",level:3},{value:"Debug Mode",id:"debug-mode",level:3},{value:"\ud83d\udcca Monitoring and Metrics",id:"-monitoring-and-metrics",level:2},{value:"Built-in Metrics",id:"built-in-metrics",level:3},{value:"Health Checks",id:"health-checks",level:3},{value:"\ud83d\udd12 Security Best Practices",id:"-security-best-practices",level:2},{value:"\ud83d\udcda Example Ingress Templates",id:"-example-ingress-templates",level:2}];function d(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,t.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"-nginx-ingress-controller-for-kubernetes",children:"\ud83c\udf10 NGINX Ingress Controller for Kubernetes"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"NGINX Ingress Controller"})," manages external access to ",(0,r.jsx)(n.strong,{children:"Kubernetes services"})," with ",(0,r.jsx)(n.strong,{children:"load balancing"}),", ",(0,r.jsx)(n.strong,{children:"SSL termination"}),", and ",(0,r.jsx)(n.strong,{children:"name-based virtual hosting"}),"."]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"-version-compatibility-check",children:"\ud83d\udd0d Version Compatibility Check"}),"\n",(0,r.jsx)(n.h3,{id:"check-kubernetes-version",children:"Check Kubernetes Version"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.code,{children:"Check your Kubernetes version:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"kubectl version\n\n# Example Output:\n# Client Version: v1.30.3\n# Kustomize Version: v5.0.4-0.20230601165947-6ce0bf390ce3\n# Server Version: v1.30.3+k3s1\n"})}),"\n",(0,r.jsx)(n.h3,{id:"find-compatible-ingress-nginx-version",children:"Find Compatible Ingress-NGINX Version"}),"\n",(0,r.jsxs)(n.p,{children:["Check the version compatibility matrix from the ",(0,r.jsx)(n.a,{href:"https://github.com/kubernetes/ingress-nginx",children:"official repository"})]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"For Kubernetes v1.30.x:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"ingress-nginx: v1.10.1 - v1.11.2"}),"\n",(0,r.jsx)(n.li,{children:"NGINX version: 1.25.3 - 1.25.5"}),"\n",(0,r.jsx)(n.li,{children:"Helm chart version: 4.10.0 - 4.11.2"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.code,{children:"Search for available helm versions:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"helm repo add ingress-nginx https://kubernetes.github.io/ingress-nginx\nhelm repo update\nhelm search repo ingress-nginx --versions\n"})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"-installation-methods",children:"\ud83d\udd27 Installation Methods"}),"\n",(0,r.jsx)(n.h3,{id:"option-1-direct-helm-installation",children:"Option 1: Direct Helm Installation"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.code,{children:"Install with specific versions:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"helm install ingress-nginx ingress-nginx/ingress-nginx \\\n  --namespace ingress-nginx --create-namespace \\\n  --version 4.11.2 \\\n  --set controller.image.tag=v1.11.2 \\\n  --set controller.nginx.image.tag=1.25.5\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Installation Output:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"NAME: ingress-nginx\nLAST DEPLOYED: Tue Sep 24 03:34:59 2024\nNAMESPACE: ingress-nginx\nSTATUS: deployed\nREVISION: 1\nTEST SUITE: None\nNOTES:\nThe ingress-nginx controller has been installed.\nIt may take a few minutes for the load balancer IP to be available.\nYou can watch the status by running 'kubectl get service --namespace ingress-nginx ingress-nginx-controller --output wide --watch'\n"})}),"\n",(0,r.jsx)(n.h3,{id:"option-2-production-template-method-recommended",children:"Option 2: Production Template Method (Recommended)"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.code,{children:"Generate template for production deployment:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"helm template ingress-nginx ingress-nginx/ingress-nginx \\\n  --namespace ingress-nginx --create-namespace \\\n  --version 4.11.2 \\\n  --set controller.image.tag=v1.11.2 \\\n  --set controller.nginx.image.tag=1.25.5 \\\n  > ./ingress-nginx-1.25.5.yml\n\nkubectl create namespace ingress-nginx \nkubectl apply -f ingress-nginx-1.25.5.yml -n ingress-nginx\n"})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"-verification-and-monitoring",children:"\ud83d\udd0d Verification and Monitoring"}),"\n",(0,r.jsx)(n.h3,{id:"check-installation-status",children:"Check Installation Status"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.code,{children:"Verify ingress controller is running:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"kubectl get pods -n ingress-nginx\nkubectl get services -n ingress-nginx\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.code,{children:"Watch the load balancer service:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"kubectl get service --namespace ingress-nginx ingress-nginx-controller --output wide --watch\n"})}),"\n",(0,r.jsx)(n.h3,{id:"view-logs",children:"View Logs"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.code,{children:"Check ingress controller logs:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"kubectl logs -n ingress-nginx deployment/ingress-nginx-controller\n"})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"-basic-ingress-configuration",children:"\ud83c\udf10 Basic Ingress Configuration"}),"\n",(0,r.jsx)(n.h3,{id:"simple-http-ingress",children:"Simple HTTP Ingress"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.code,{children:"Create basic ingress resource:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:"apiVersion: networking.k8s.io/v1\nkind: Ingress\nmetadata:\n  name: example-ingress\n  namespace: default\n  annotations:\n    nginx.ingress.kubernetes.io/rewrite-target: /\nspec:\n  ingressClassName: nginx\n  rules:\n  - host: www.example.com\n    http:\n      paths:\n      - pathType: Prefix\n        path: /\n        backend:\n          service:\n            name: example-service\n            port:\n              number: 80\n"})}),"\n",(0,r.jsx)(n.h3,{id:"https-ingress-with-tls",children:"HTTPS Ingress with TLS"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.code,{children:"Create HTTPS ingress with TLS certificate:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:'apiVersion: networking.k8s.io/v1\nkind: Ingress\nmetadata:\n  name: secure-ingress\n  namespace: default\n  annotations:\n    cert-manager.io/cluster-issuer: "letsencrypt-prod"\n    nginx.ingress.kubernetes.io/ssl-redirect: "true"\nspec:\n  ingressClassName: nginx\n  tls:\n  - hosts:\n    - secure.example.com\n    secretName: example-tls\n  rules:\n  - host: secure.example.com\n    http:\n      paths:\n      - pathType: Prefix\n        path: /\n        backend:\n          service:\n            name: secure-service\n            port:\n              number: 80\n'})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"\ufe0f-advanced-configuration",children:"\u2699\ufe0f Advanced Configuration"}),"\n",(0,r.jsx)(n.h3,{id:"custom-annotations",children:"Custom Annotations"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.code,{children:"Common NGINX ingress annotations:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:'metadata:\n  annotations:\n    # SSL and Security\n    nginx.ingress.kubernetes.io/ssl-redirect: "true"\n    nginx.ingress.kubernetes.io/force-ssl-redirect: "true"\n    \n    # Rate Limiting\n    nginx.ingress.kubernetes.io/rate-limit: "100"\n    nginx.ingress.kubernetes.io/rate-limit-window: "1m"\n    \n    # CORS Configuration\n    nginx.ingress.kubernetes.io/enable-cors: "true"\n    nginx.ingress.kubernetes.io/cors-allow-origin: "https://example.com"\n    nginx.ingress.kubernetes.io/cors-allow-methods: "GET, POST, OPTIONS"\n    \n    # Authentication\n    nginx.ingress.kubernetes.io/auth-type: basic\n    nginx.ingress.kubernetes.io/auth-secret: basic-auth\n    nginx.ingress.kubernetes.io/auth-realm: "Authentication Required"\n    \n    # Custom Headers\n    nginx.ingress.kubernetes.io/configuration-snippet: |\n      more_set_headers "X-Frame-Options: DENY";\n      more_set_headers "X-Content-Type-Options: nosniff";\n      more_set_headers "X-XSS-Protection: 1; mode=block";\n    \n    # Proxy Settings\n    nginx.ingress.kubernetes.io/proxy-connect-timeout: "600"\n    nginx.ingress.kubernetes.io/proxy-send-timeout: "600"\n    nginx.ingress.kubernetes.io/proxy-read-timeout: "600"\n    nginx.ingress.kubernetes.io/proxy-body-size: "50m"\n'})}),"\n",(0,r.jsx)(n.h3,{id:"path-based-routing",children:"Path-Based Routing"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.code,{children:"Multiple services on same domain:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:"apiVersion: networking.k8s.io/v1\nkind: Ingress\nmetadata:\n  name: path-based-ingress\nspec:\n  ingressClassName: nginx\n  rules:\n  - host: api.example.com\n    http:\n      paths:\n      - path: /api/v1\n        pathType: Prefix\n        backend:\n          service:\n            name: api-v1-service\n            port:\n              number: 8080\n      - path: /api/v2\n        pathType: Prefix\n        backend:\n          service:\n            name: api-v2-service\n            port:\n              number: 8080\n      - path: /\n        pathType: Prefix\n        backend:\n          service:\n            name: frontend-service\n            port:\n              number: 80\n"})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"-troubleshooting",children:"\ud83d\udd27 Troubleshooting"}),"\n",(0,r.jsx)(n.h3,{id:"common-issues",children:"Common Issues"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.code,{children:"Check ingress resources:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"kubectl get ingress -A\nkubectl describe ingress <ingress-name> -n <namespace>\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.code,{children:"Validate ingress controller:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"kubectl get pods -n ingress-nginx\nkubectl logs -n ingress-nginx deployment/ingress-nginx-controller --tail=100\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.code,{children:"Test connectivity:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:'# Test from within cluster\nkubectl run test-pod --image=curlimages/curl -it --rm -- /bin/sh\ncurl -H "Host: example.com" http://ingress-nginx-controller.ingress-nginx.svc.cluster.local\n'})}),"\n",(0,r.jsx)(n.h3,{id:"debug-mode",children:"Debug Mode"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.code,{children:"Enable debug logging:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:'kubectl patch deployment ingress-nginx-controller -n ingress-nginx -p \'{"spec":{"template":{"spec":{"containers":[{"name":"controller","args":["--v=2"]}]}}}}\'\n'})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"-monitoring-and-metrics",children:"\ud83d\udcca Monitoring and Metrics"}),"\n",(0,r.jsx)(n.h3,{id:"built-in-metrics",children:"Built-in Metrics"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.code,{children:"Access NGINX metrics:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"kubectl port-forward -n ingress-nginx service/ingress-nginx-controller-metrics 10254:10254\ncurl http://localhost:10254/metrics\n"})}),"\n",(0,r.jsx)(n.h3,{id:"health-checks",children:"Health Checks"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.code,{children:"Check controller health:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"kubectl get pods -n ingress-nginx\nkubectl describe pod <controller-pod-name> -n ingress-nginx\n"})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"-security-best-practices",children:"\ud83d\udd12 Security Best Practices"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Always use TLS/SSL for production traffic"}),"\n",(0,r.jsx)(n.li,{children:"Implement rate limiting to prevent abuse"}),"\n",(0,r.jsx)(n.li,{children:"Use authentication for sensitive endpoints"}),"\n",(0,r.jsx)(n.li,{children:"Configure proper CORS policies"}),"\n",(0,r.jsx)(n.li,{children:"Set security headers via configuration snippets"}),"\n",(0,r.jsx)(n.li,{children:"Regularly update ingress controller versions"}),"\n",(0,r.jsx)(n.li,{children:"Monitor access logs for suspicious activity"}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"-example-ingress-templates",children:"\ud83d\udcda Example Ingress Templates"}),"\n",(0,r.jsx)(n.p,{children:"The ingress controller supports various configuration patterns:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Basic HTTP routing"}),"\n",(0,r.jsx)(n.li,{children:"HTTPS with automatic certificate management"}),"\n",(0,r.jsx)(n.li,{children:"Path-based routing for microservices"}),"\n",(0,r.jsx)(n.li,{children:"Host-based routing for multi-tenant applications"}),"\n",(0,r.jsx)(n.li,{children:"WebSocket support"}),"\n",(0,r.jsx)(n.li,{children:"gRPC load balancing"}),"\n",(0,r.jsx)(n.li,{children:"Custom error pages"}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Reference:"})," ",(0,r.jsx)(n.a,{href:"https://kubernetes.github.io/ingress-nginx/",children:"NGINX Ingress Documentation"})]}),"\n",(0,r.jsx)(n.p,{children:"\u2705 NGINX Ingress Controller is now configured for managing external access to your Kubernetes services!"})]})}function g(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}},8453:(e,n,s)=>{s.d(n,{R:()=>l,x:()=>o});var i=s(6540);const r={},t=i.createContext(r);function l(e){const n=i.useContext(t);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:l(e.components),i.createElement(t.Provider,{value:n},e.children)}}}]);